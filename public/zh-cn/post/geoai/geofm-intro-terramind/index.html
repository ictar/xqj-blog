

<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>ç©è½¬ TerraMindï¼šä»ç†è§£åˆ°å¾®è°ƒ - </title>

  <meta name="description" content="TerraMind æ˜¯é¦–ä¸ªé’ˆå¯¹åœ°çƒè§‚æµ‹ (EO) é¢†åŸŸæå‡ºçš„å¤§è§„æ¨¡ã€ä»»æ„åˆ°ä»»æ„ï¼ˆany-to-anyï¼‰ç”Ÿæˆå¼å¤šæ¨¡æ€åŸºç¡€æ¨¡å‹ï¼Œå®ƒé€šè¿‡ç»“åˆä»¤ç‰Œçº§åˆ«å’Œåƒç´ çº§åˆ«çš„åŒå°ºåº¦è¡¨ç¤ºè¿›è¡Œé¢„è®­ç»ƒï¼Œä»¥å­¦ä¹ é«˜å±‚ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œç²¾ç»†çš„ç©ºé—´ç»†èŠ‚ã€‚è¯¥æ¨¡å‹æ—¨åœ¨ä¿ƒè¿›å¤šæ¨¡æ€æ•°æ®æ•´åˆã€æä¾›å¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›å¹¶æ”¯æŒé›¶æ ·æœ¬å’Œå°‘æ ·æœ¬åº”ç”¨ï¼ŒåŒæ—¶åœ¨åœ°çƒè§‚æµ‹åŸºå‡†æµ‹è¯•ä¸­è¶…è¶Šç°æœ‰æ¨¡å‹ï¼Œå¹¶é€šè¿‡å¼•å…¥â€œæ¨¡æ€æ€ç»´â€ï¼ˆTiMï¼‰è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚">
  <meta name="author" content="Qiongjie.X"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "ç¼å‘€",
    
    "url": "https:\/\/www.xuqiongjie.com\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/www.xuqiongjie.com\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/www.xuqiongjie.com\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/www.xuqiongjie.com\/zh-cn\/post\/geoai\/geofm-intro-terramind\/",
          "name": "ç©è½¬ terra mindï¼šä»ç†è§£åˆ°å¾®è°ƒ"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Qiongjie.X"
  },
  "headline": "ç©è½¬ TerraMindï¼šä»ç†è§£åˆ°å¾®è°ƒ",
  "description" : "TerraMind æ˜¯é¦–ä¸ªé’ˆå¯¹åœ°çƒè§‚æµ‹ (EO) é¢†åŸŸæå‡ºçš„å¤§è§„æ¨¡ã€ä»»æ„åˆ°ä»»æ„ï¼ˆany-to-anyï¼‰ç”Ÿæˆå¼å¤šæ¨¡æ€åŸºç¡€æ¨¡å‹ï¼Œå®ƒé€šè¿‡ç»“åˆä»¤ç‰Œçº§åˆ«å’Œåƒç´ çº§åˆ«çš„åŒå°ºåº¦è¡¨ç¤ºè¿›è¡Œé¢„è®­ç»ƒï¼Œä»¥å­¦ä¹ é«˜å±‚ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œç²¾ç»†çš„ç©ºé—´ç»†èŠ‚ã€‚è¯¥æ¨¡å‹æ—¨åœ¨ä¿ƒè¿›å¤šæ¨¡æ€æ•°æ®æ•´åˆã€æä¾›å¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›å¹¶æ”¯æŒé›¶æ ·æœ¬å’Œå°‘æ ·æœ¬åº”ç”¨ï¼ŒåŒæ—¶åœ¨åœ°çƒè§‚æµ‹åŸºå‡†æµ‹è¯•ä¸­è¶…è¶Šç°æœ‰æ¨¡å‹ï¼Œå¹¶é€šè¿‡å¼•å…¥â€œæ¨¡æ€æ€ç»´â€ï¼ˆTiMï¼‰è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚",
  "inLanguage" : "zh-cn",
  "wordCount":  826 ,
  "datePublished" : "2025-09-10T00:00:00\u002b00:00",
  "dateModified" : "2025-09-10T00:00:00\u002b00:00",
  "image" : "https:\/\/www.xuqiongjie.com\/img\/avatar-icon.png",
  "keywords" : [ "GeoFM, terramind, é¥æ„Ÿ, AI, å¤§æ¨¡å‹, EO" ],
  "mainEntityOfPage" : "https:\/\/www.xuqiongjie.com\/zh-cn\/post\/geoai\/geofm-intro-terramind\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/www.xuqiongjie.com\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/www.xuqiongjie.com\/img\/avatar-icon.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="ç©è½¬ TerraMindï¼šä»ç†è§£åˆ°å¾®è°ƒ" />
<meta property="og:description" content="TerraMind æ˜¯é¦–ä¸ªé’ˆå¯¹åœ°çƒè§‚æµ‹ (EO) é¢†åŸŸæå‡ºçš„å¤§è§„æ¨¡ã€ä»»æ„åˆ°ä»»æ„ï¼ˆany-to-anyï¼‰ç”Ÿæˆå¼å¤šæ¨¡æ€åŸºç¡€æ¨¡å‹ï¼Œå®ƒé€šè¿‡ç»“åˆä»¤ç‰Œçº§åˆ«å’Œåƒç´ çº§åˆ«çš„åŒå°ºåº¦è¡¨ç¤ºè¿›è¡Œé¢„è®­ç»ƒï¼Œä»¥å­¦ä¹ é«˜å±‚ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œç²¾ç»†çš„ç©ºé—´ç»†èŠ‚ã€‚è¯¥æ¨¡å‹æ—¨åœ¨ä¿ƒè¿›å¤šæ¨¡æ€æ•°æ®æ•´åˆã€æä¾›å¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›å¹¶æ”¯æŒé›¶æ ·æœ¬å’Œå°‘æ ·æœ¬åº”ç”¨ï¼ŒåŒæ—¶åœ¨åœ°çƒè§‚æµ‹åŸºå‡†æµ‹è¯•ä¸­è¶…è¶Šç°æœ‰æ¨¡å‹ï¼Œå¹¶é€šè¿‡å¼•å…¥â€œæ¨¡æ€æ€ç»´â€ï¼ˆTiMï¼‰è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚">
<meta property="og:image" content="https://www.xuqiongjie.com/img/avatar-icon.png" />
<meta property="og:url" content="https://www.xuqiongjie.com/zh-cn/post/geoai/geofm-intro-terramind/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="ç¼å‘€" />

  <meta name="twitter:title" content="ç©è½¬ TerraMindï¼šä»ç†è§£åˆ°å¾®è°ƒ" />
  <meta name="twitter:description" content="TerraMind æ˜¯é¦–ä¸ªé’ˆå¯¹åœ°çƒè§‚æµ‹ (EO) é¢†åŸŸæå‡ºçš„å¤§è§„æ¨¡ã€ä»»æ„åˆ°ä»»æ„ï¼ˆany-to-anyï¼‰ç”Ÿæˆå¼å¤šæ¨¡æ€åŸºç¡€æ¨¡å‹ï¼Œå®ƒé€šè¿‡ç»“åˆä»¤ç‰Œçº§åˆ«å’Œåƒç´ çº§åˆ«çš„åŒå°ºåº¦è¡¨ç¤ºè¿›è¡Œé¢„è®­ç»ƒï¼Œä»¥å­¦ä¹ é«˜å±‚ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œç²¾ç»†çš„ç©ºé—´ç»†èŠ‚ã€‚è¯¥æ¨¡å‹æ—¨åœ¨ä¿ƒè¿›å¤šæ¨¡æ€æ•°æ®æ•´åˆã€æä¾›å¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›å¹¶æ”¯æŒé›¶æ ·æœ¬å’Œå°‘æ ·æœ¬åº”ç”¨ï¼ŒåŒæ—¶åœ¨åœ°çƒè§‚æµ‹åŸºå‡†æµ‹è¯•ä¸­è¶…è¶Šç°æœ‰æ¨¡å‹ï¼Œå¹¶é€šè¿‡å¼•å…¥â€œæ¨¡æ€æ€ç»´â€ï¼ˆTiMï¼‰è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚">
  <meta name="twitter:image" content="https://www.xuqiongjie.com/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <link href='https://www.xuqiongjie.com/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.147.4">
  <link rel="alternate" href="https://www.xuqiongjie.com/zh-cn/index.xml" type="application/rss+xml" title="ç¼å‘€"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css" integrity="sha384-h/hnnw1Bi4nbpD6kE7nYfCXzovi622sY5WBxww8ARKwpdLj5kUWjRuyiXaD1U2JT" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="https://www.xuqiongjie.com/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://www.xuqiongjie.com/css/syntax.css" /><link rel="stylesheet" href="https://www.xuqiongjie.com/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  crossorigin="anonymous"
/>
<link rel="stylesheet" href="https://www.xuqiongjie.com/css/custom.css">

<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  crossorigin="anonymous"
></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
  onload="renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false}
    ]
  });"></script>


<link rel="icon" type="image/png" href="https://www.xuqiongjie.com/img/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="https://www.xuqiongjie.com/img/favicon.svg" />
<link rel="apple-touch-icon" sizes="180x180" href="https://www.xuqiongjie.com/img/apple-touch-icon.png" />
<link rel="manifest" href="https://www.xuqiongjie.com/img/site.webmanifest" />

  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">åˆ‡æ¢å¯¼èˆª</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.xuqiongjie.com/zh-cn/">ç¼å‘€</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" role="button" tabindex="0">æ–‡ç« </a>
              <div class="navlinks-children">
                
                  <a href="/zh-cn/post/python-geodata">ç”¨ Python ç©è½¬é¥æ„Ÿæ•°æ®</a>
                
                  <a href="/zh-cn/post/mcmc-statics">è’™ç‰¹å¡æ´›-é©¬å°”å¯å¤«é“¾ç»Ÿè®¡æ–¹æ³•</a>
                
                  <a href="/zh-cn/post/ai-fundamentals">AI åŸºç¡€ç³»åˆ—</a>
                
                  <a href="/zh-cn/post/geoai">GeoAI ç³»åˆ—</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="é¡¹ç›®" href="/zh-cn/">é¡¹ç›®</a>
            </li>
          
        
          
            <li>
              <a title="ç¬”è®°" href="/zh-cn/notes">ç¬”è®°</a>
            </li>
          
        
          
            <li>
              <a title="æ ‡ç­¾" href="/zh-cn/tags">æ ‡ç­¾</a>
            </li>
          
        
          
            <li>
              <a title="å…³äºæˆ‘" href="/zh-cn/page/about/">å…³äºæˆ‘</a>
            </li>
          
        

        
          
            <li>
              
            </li>
          
        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="ç¼å‘€" href="https://www.xuqiongjie.com/zh-cn/">
            <img class="avatar-img" src="https://www.xuqiongjie.com/img/avatar-icon.png" alt="ç¼å‘€" />
           
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>ç©è½¬ TerraMindï¼šä»ç†è§£åˆ°å¾®è°ƒ</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;å‘è¡¨äº September 10, 2025
  
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;826&nbsp;ä¸ªå­—
  
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        
  <aside class="toc">
    <h2>ç›®å½•</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ä¸ºä»€ä¹ˆè¦æœ‰-terramind">ä¸ºä»€ä¹ˆè¦æœ‰ TerraMindï¼Ÿ</a></li>
    <li><a href="#terramind-ä»ä½•è€Œæ¥">TerraMind ä»ä½•è€Œæ¥ï¼Ÿ</a>
      <ul>
        <li><a href="#è¾“å…¥terramesh-æ•°æ®é›†">è¾“å…¥ï¼šTerraMesh æ•°æ®é›†</a></li>
        <li><a href="#åŒå°ºåº¦é¢„è®­ç»ƒdual-scale-pretraining">åŒå°ºåº¦é¢„è®­ç»ƒï¼ˆDual-Scale Pretrainingï¼‰</a></li>
        <li><a href="#ä¸¤é˜¶æ®µé¢„è®­ç»ƒ">ä¸¤é˜¶æ®µé¢„è®­ç»ƒ</a></li>
      </ul>
    </li>
    <li><a href="#terramind-èƒ½åšä»€ä¹ˆ">TerraMind èƒ½åšä»€ä¹ˆï¼Ÿ</a></li>
    <li><a href="#ç¼–ç ä¸é‡å»ºtokenizer">ç¼–ç ä¸é‡å»ºï¼ˆTokenizerï¼‰</a></li>
    <li><a href="#è·¨æ¨¡æ€ç”Ÿæˆgeneration">è·¨æ¨¡æ€ç”Ÿæˆï¼ˆGenerationï¼‰</a>
      <ul>
        <li><a href="#å•-patch-ç¤ºä¾‹">å• patch ç¤ºä¾‹</a></li>
        <li><a href="#åˆ†å—æ¨ç†tiled-inference">åˆ†å—æ¨ç†ï¼ˆTiled Inferenceï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#å¾®è°ƒä»»åŠ¡fine-tuning-with-terratorch">å¾®è°ƒä»»åŠ¡ï¼ˆFine-tuning with TerraTorchï¼‰</a>
      <ul>
        <li><a href="#åœ¨å¾®è°ƒä¸­ä½¿ç”¨tim">åœ¨å¾®è°ƒä¸­ä½¿ç”¨TiM</a></li>
      </ul>
    </li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
    <li><a href="#äº†è§£æ›´å¤š">äº†è§£æ›´å¤š</a></li>
  </ul>
</nav>
  </aside>

<p>è¿‡å»å‡ å¹´ï¼Œåœ°çƒè§‚æµ‹ï¼ˆEarth Observation, EOï¼‰æ­£åœ¨è¿›å…¥ä¸€ä¸ªâ€œæ¨¡å‹ä¸ºç‹â€çš„æ—¶ä»£ã€‚å«æ˜Ÿå½±åƒçš„æ•°æ®é‡è¶Šæ¥è¶Šå¤§ï¼Œæ¨¡æ€è¶Šæ¥è¶Šå¤šï¼ˆå…‰å­¦ã€é›·è¾¾ã€æ°”å€™æŒ‡æ•°ã€åœ°ç†æ–‡æœ¬æè¿°â€¦â€¦ï¼‰ï¼Œä½†å¦‚ä½•çœŸæ­£æŠŠè¿™äº›ä¿¡æ¯ç”¨èµ·æ¥ï¼Œå´å§‹ç»ˆæ˜¯ä¸ªæŒ‘æˆ˜ã€‚</p>
<p>è¿™æ—¶ï¼Œ<strong>TerraMind</strong> å‡ºç°äº†ã€‚å®ƒæ˜¯<strong>ç¬¬ä¸€ä¸ªç«¯åˆ°ç«¯ç”Ÿæˆå¼ã€å¤šæ¨¡æ€åœ°çƒè§‚æµ‹åŸºç¡€æ¨¡å‹</strong>ï¼Œç”± IBM Researchã€ETH Zurichã€Forschungszentrum JÃ¼lich å’Œ ESA Î¦-Lab è”åˆå¼€å‘ã€‚å®ƒä¸ä»…èƒ½æ•´åˆä¸åŒæ¨¡æ€çš„æ•°æ®ï¼Œè¿˜å…·å¤‡ç”Ÿæˆèƒ½åŠ›å’Œå‡ºè‰²çš„æ³›åŒ–èƒ½åŠ›ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒè¯•å›¾æ‰®æ¼”â€œå¤§ä¸€ç»Ÿæ¨¡å‹â€çš„è§’è‰²ï¼Œä¸ºå„ç§ä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¦‚åœŸåœ°è¦†ç›–åˆ†ç±»ã€ç¾å®³ç›‘æµ‹ã€æ°”å€™ç ”ç©¶ç­‰ï¼‰æä¾›ä¸€ä¸ªå¼ºå¤§çš„â€œèµ·ç‚¹â€ã€‚</p>
<h1 id="ä¸ºä»€ä¹ˆè¦æœ‰-terramind">ä¸ºä»€ä¹ˆè¦æœ‰ TerraMindï¼Ÿ</h1>
<p>TerraMind çš„æå‡ºä¸»è¦æ˜¯ä¸ºäº†<strong>è§£å†³ EO é¢†åŸŸä¸­å¤šæ¨¡æ€æ•°æ®é›†æˆã€ç”Ÿæˆä»¥åŠç°æœ‰æ¨¡å‹æ³›åŒ–èƒ½åŠ›ä¸è¶³ç­‰é—®é¢˜</strong>ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œå®ƒé’ˆå¯¹ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹ï¼š</p>
<ul>
<li>
<p><strong>å¤šæ¨¡æ€æ•°æ®åˆ©ç”¨ä¸è¶³</strong>
ä¼ ç»Ÿæ¨¡å‹å¾€å¾€åªé’ˆå¯¹æŸäº›ç‰¹å®šæ¨¡æ€ï¼ˆæ¯”å¦‚åªç”¨å…‰å­¦å½±åƒï¼‰ï¼Œæˆ–åªæœåŠ¡äºæŸä¸ªä»»åŠ¡ï¼ˆæ¯”å¦‚åˆ†å‰²ï¼‰ã€‚TerraMind åˆ™é€šè¿‡æ•´åˆé›·è¾¾ã€å…‰å­¦ã€åœŸåœ°è¦†ç›–å›¾ã€NDVIã€DEMã€åæ ‡å…ƒæ•°æ®ç”šè‡³è‡ªç„¶è¯­è¨€æè¿°ï¼Œæ‰“é€šäº†â€œæ¨¡æ€å£å’â€ã€‚</p>
</li>
<li>
<p><strong>ç¼ºä¹ç”Ÿæˆå¼å¤šæ¨¡æ€èƒ½åŠ›</strong>
è¿™æ˜¯ TerraMind çš„æ€æ‰‹é”ã€‚å®ƒæ˜¯é¦–ä¸ªâ€œå¤§è§„æ¨¡ã€ä»»æ„åˆ°ä»»æ„ï¼ˆany-to-anyï¼‰â€çš„ç”Ÿæˆå¼å¤šæ¨¡æ€ EO æ¨¡å‹ã€‚å®ƒä¸ä»…èƒ½å®Œæˆä¼ ç»Ÿåˆ†æä»»åŠ¡ï¼Œè¿˜èƒ½ç”Ÿæˆæ–°çš„æ•°æ®ï¼Œæ”¯æŒé›¶æ ·æœ¬ã€å°‘æ ·æœ¬å­¦ä¹ ï¼Œé™ä½æ ‡æ³¨æˆæœ¬ã€‚</p>
</li>
<li>
<p><strong>æ³›åŒ–ä¸æ•°æ®æ•ˆç‡æŒ‘æˆ˜</strong>
è¿‡å»çš„ EO æ¨¡å‹å¾ˆå®¹æ˜“â€œè¿‡æ‹Ÿåˆâ€åˆ°æŸä¸ªåŒºåŸŸæˆ–æŸä¸ªä»»åŠ¡ï¼Œéš¾ä»¥è¿ç§»ã€‚TerraMind é€šè¿‡åœ¨æµ·é‡æ— æ ‡æ³¨æ•°æ®ä¸Šçš„è‡ªç›‘ç£é¢„è®­ç»ƒï¼ŒåŠ ä¸Šå°è§„æ¨¡çš„æœ‰æ ‡æ³¨å¾®è°ƒï¼Œå®ç°äº†æ›´å¼ºçš„ç©ºé—´ã€æ—¶é—´æ³›åŒ–ã€‚</p>
</li>
<li>
<p><strong>ç°æœ‰åœ°ç†ç©ºé—´åŸºç¡€æ¨¡å‹çš„å±€é™</strong>
å¾ˆå¤š GFMï¼ˆGeo-Foundation Modelï¼‰å…¶å®æ˜¯æŠŠè®¡ç®—æœºè§†è§‰çš„å¥—è·¯ç¡¬å¥—è¿‡æ¥ï¼Œæ²¡è€ƒè™‘é¥æ„Ÿæ•°æ®çš„ç‰¹æ®Šæ€§ã€‚TerraMind åœ¨æ¶æ„ä¸Šä¸“é—¨åšäº†ä¼˜åŒ–ï¼Œä¾‹å¦‚ <strong>åŒå°ºåº¦é¢„è®­ç»ƒ</strong>ï¼ˆtoken-level + pixel-level è¡¨ç¤ºï¼‰ï¼Œæ—¢èƒ½æŠ“å…¨å±€è¯­ä¹‰ï¼Œåˆä¿ç•™å±€éƒ¨ç©ºé—´ç»†èŠ‚ã€‚</p>
</li>
<li>
<p><strong>åŠ é€Ÿæ°”å€™ä¸å¯æŒç»­æ€§åº”ç”¨</strong>
å®ƒä¸ä»…æ˜¯ä¸ªæ¨¡å‹ï¼Œè¿˜é…å¥—äº†åˆ†å¸ƒå¼æ•°æ®å¤„ç†å’Œé‡‡æ ·æ¡†æ¶ï¼Œèƒ½ç›´æ¥è¿æ¥å«æ˜Ÿæ•°æ®æºï¼Œè®©å¼€å‘è€…åœ¨æ°”å€™å’Œå¯æŒç»­æ€§åœºæ™¯ä¸­æ›´å¿«è½åœ°åº”ç”¨ã€‚</p>
</li>
</ul>
<p>ç®€è€Œè¨€ä¹‹ï¼ŒTerraMind çš„ç›®æ ‡æ˜¯ï¼š<strong>åšä¸€ä¸ªé€šç”¨ã€å¼ºå¤§ã€èƒ½æ•´åˆå¤šæ¨¡æ€çš„åŸºç¡€æ¨¡å‹ï¼Œä¸º EO ç ”ç©¶å’Œåº”ç”¨æä¾›æ›´é«˜æ•ˆçš„â€œèµ·ç‚¹â€ã€‚</strong></p>
<h1 id="terramind-ä»ä½•è€Œæ¥">TerraMind ä»ä½•è€Œæ¥ï¼Ÿ</h1>
<p><img src="https://huggingface.co/ibm-esa-geospatial/TerraMind-1.0-base/resolve/main/assets%2Fterramind_architecture.png" alt=""></p>
<h2 id="è¾“å…¥terramesh-æ•°æ®é›†">è¾“å…¥ï¼šTerraMesh æ•°æ®é›†</h2>
<p>TerraMind åœ¨å®šåˆ¶çš„å…¨çƒå¤§è§„æ¨¡åœ°ç†ç©ºé—´æ•°æ®é›† <strong>TerraMesh</strong> ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼ŒåŒ…å« <strong>900 ä¸‡ä¸ªæ ·æœ¬å’Œä¹ç§åœ°ç†ç©ºé—´æ¨¡æ€</strong>ï¼š</p>
<ul>
<li>å…‰å­¦å«æ˜Ÿå›¾åƒï¼šCopernicus Sentinel-2 L1C å’Œ L2A (RGB)ã€‚</li>
<li>é›·è¾¾å«æ˜Ÿå›¾åƒï¼šCopernicus Sentinel-1 GRD å’Œ RTCã€‚</li>
<li>ä»»åŠ¡ç‰¹å®šæ¨¡æ€ï¼šåœŸåœ°åˆ©ç”¨/åœŸåœ°è¦†ç›– (LULC) å’Œå½’ä¸€åŒ–æ¤è¢«æŒ‡æ•° (NDVI) å›¾ã€‚</li>
<li>å…ƒæ•°æ®ï¼šæ•°å­—é«˜ç¨‹æ¨¡å‹ (DEM) å’Œåœ°ç†åæ ‡ï¼ˆç¦»æ•£åŒ–ä¸ºå­—ç¬¦ä¸²ï¼‰ã€‚</li>
<li>è‡ªç„¶è¯­è¨€ï¼šé€šè¿‡ LLaVA-Next ä» Sentinel-2 RGB å›¾åƒåˆæˆçš„å›¾åƒæè¿° (captions)ã€‚</li>
</ul>
<h2 id="åŒå°ºåº¦é¢„è®­ç»ƒdual-scale-pretraining">åŒå°ºåº¦é¢„è®­ç»ƒï¼ˆDual-Scale Pretrainingï¼‰</h2>
<p>TerraMind åœ¨åƒç´ çº§åˆ«å’Œ token çº§åˆ«ä¸Šç»“åˆæ•°æ®ï¼Œæ˜¯å…¶æ ¸å¿ƒåˆ›æ–°ã€‚</p>
<ul>
<li><strong>Token çº§åˆ«</strong>ï¼šç¼–ç é«˜å±‚ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå­¦ä¹ è·¨æ¨¡æ€å…³ç³»ï¼Œå¹¶å®ç°æ‰©å±•æ€§ã€‚</li>
<li><strong>åƒç´ çº§åˆ«</strong>ï¼šåˆ©ç”¨ç»†ç²’åº¦è¡¨ç¤ºï¼Œæ•æ‰å…³é”®çš„ç©ºé—´ç»†å¾®ä¹‹å¤„ã€‚</li>
</ul>
<p>è¿™ç§åŒå°ºåº¦æ—©æœŸèåˆæ–¹æ³•ä¼˜äºå…¶ä»–èåˆæ–¹æ³•ï¼Œèƒ½å¤Ÿå®ç°äººå·¥æ•°æ®ç”Ÿæˆã€é›¶æ ·æœ¬å’Œå°‘æ ·æœ¬åº”ç”¨ã€‚</p>
<h2 id="ä¸¤é˜¶æ®µé¢„è®­ç»ƒ">ä¸¤é˜¶æ®µé¢„è®­ç»ƒ</h2>
<ol>
<li><strong>å•æ¨¡æ€åˆ†è¯å™¨ï¼ˆTokenizerï¼‰é¢„è®­ç»ƒ</strong>ï¼šä¸ºæ¯ç§æ¨¡æ€å¼€å‘ç‰¹å®šçš„åˆ†è¯å™¨ï¼Œå°†æ•°æ®ç¼–ç ä¸ºç¦»æ•£ token åºåˆ—ï¼Œæˆ–ä» token åºåˆ—è§£ç å›åŸå§‹å½¢å¼ã€‚å›¾åƒç±»æ¨¡æ€ï¼ˆS-1, S-2, LULC, NDVI, DEMï¼‰ä½¿ç”¨<strong>åŸºäºè‡ªç¼–ç å™¨å’Œæœ‰é™æ ‡é‡é‡åŒ– (FSQ) çš„æ¶æ„</strong>ã€‚åºåˆ—ç±»æ¨¡æ€ï¼ˆæè¿°ã€åœ°ç†ä½ç½®ï¼‰ä½¿ç”¨åŸºäº WordPiece çš„æ–‡æœ¬åˆ†è¯å™¨ã€‚</li>
<li><strong>TerraMind ç¼–ç å™¨-è§£ç å™¨é¢„è®­ç»ƒ</strong>ï¼šä½¿ç”¨å¯¹ç§° Transformer æ¶æ„å¤„ç†å¤šæ¨¡æ€ token åºåˆ—ï¼Œå¹¶æ¥å—åƒç´ çº§åˆ«çš„è·¨æ¨¡æ€è¾“å…¥ã€‚é¢„è®­ç»ƒç›®æ ‡æ˜¯è·¨æ¨¡æ€è¡¥ä¸åˆ†ç±»é—®é¢˜ï¼Œé€šè¿‡äº¤å‰ç†µæŸå¤±æ¥é‡å»ºè¢«é®è”½çš„ç›®æ ‡ tokenã€‚</li>
</ol>
<h1 id="terramind-èƒ½åšä»€ä¹ˆ">TerraMind èƒ½åšä»€ä¹ˆï¼Ÿ</h1>
<p>å®ƒçš„å¼ºé¡¹å¯ä»¥å½’ç»“ä¸ºä¸‰ç‚¹ï¼š</p>
<ol>
<li><strong>æ•´åˆï¼ˆIntegrationï¼‰</strong>ï¼šæŠŠé›·è¾¾ã€å…‰å­¦ã€DEMã€LULC ç­‰å¤šæ¨¡æ€æ”¾åˆ°ä¸€ä¸ªç»Ÿä¸€è¡¨ç¤ºé‡Œã€‚</li>
<li><strong>ç”Ÿæˆï¼ˆGenerationï¼‰</strong>ï¼šä»»æ„æ¨¡æ€ä¹‹é—´çš„ç”Ÿæˆä»»åŠ¡ï¼ˆä¾‹å¦‚ä»é›·è¾¾åˆæˆå…‰å­¦å½±åƒï¼Œæˆ–ä» DEM é¢„æµ‹ NDVIï¼‰ã€‚
<ul>
<li>ä» Sentinel-2 L2A å…‰å­¦æ•°æ®å¼€å§‹ï¼ŒTerraMind èƒ½é«˜è´¨é‡åœ°ç”Ÿæˆé›·è¾¾æ•°æ®ã€åœŸåœ°åˆ©ç”¨å›¾å’Œæ•°å­—é«˜ç¨‹å›¾ã€‚</li>
<li>å³ä½¿ä»ä½ä¿¡æ¯é‡çš„åœ°ç†ä½ç½®ä¿¡æ¯å¼€å§‹ï¼Œæ¨¡å‹ä¹Ÿèƒ½ç”Ÿæˆä¸ä¸Šä¸‹æ–‡ç›¸å…³çš„å…‰å­¦å›¾åƒï¼ˆä¾‹å¦‚ï¼Œä»ä¸­ä¸œçš„åœ°ç†ä½ç½®ç”Ÿæˆæ²™æ¼ å›¾åƒï¼‰ï¼Œå°½ç®¡ç»“æ„ä¸Šå¯èƒ½ä¸çœŸå®å€¼ä¸åŒã€‚</li>
</ul>
</li>
<li><strong>æ³›åŒ–ï¼ˆGeneralizationï¼‰</strong>ï¼šä¸‹æ¸¸ä»»åŠ¡åªéœ€å°‘é‡æ ‡æ³¨ï¼Œå°±èƒ½å¿«é€Ÿé€‚é…ï¼Œæ¯”å¦‚åœŸåœ°è¦†ç›–åˆ†ç±»ã€ç¾å®³ç›‘æµ‹ç­‰ã€‚
<ul>
<li><strong>é›¶æ ·æœ¬å­¦ä¹ </strong>
<ul>
<li><strong>æ°´ä½“æµ‹ç»˜</strong>ï¼šTerraMindv1-B åœ¨é›¶æ ·æœ¬è®¾ç½®ä¸‹ IoU è¾¾åˆ° 45.4%ï¼Œè‹¥ä½¿ç”¨ DynamicWorld LULC æ•°æ®è¿›è¡Œ ablation å®éªŒï¼Œå¯æå‡è‡³ 69.8%ï¼Œæ¥è¿‘å¾®è°ƒ SOTA æ€§èƒ½ï¼ˆ84.4%ï¼‰ã€‚</li>
<li>åœ°ç†å®šä½ï¼šèƒ½å¤Ÿå‡†ç¡®é¢„æµ‹ç‰¹å®šæ•°æ®å®ä¾‹çš„åœ°ç†ä½ç½®ï¼Œä¾‹å¦‚é¢„æµ‹â€œè£¸åœ°â€ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå¹¶è¯†åˆ«å‡ºæ’’å“ˆæ‹‰ã€ä¸­ä¸œç­‰åŒºåŸŸã€‚</li>
</ul>
</li>
<li><strong>å°‘æ ·æœ¬å­¦ä¹ </strong>ï¼šåœ¨ EuroSAT å’Œ METER-ML æ•°æ®é›†ä¸Šçš„ 1-shot 5-way åˆ†ç±»ä»»åŠ¡ä¸­ï¼ŒTerraMind çš„å¹³å‡å‡†ç¡®åº¦è‡³å°‘æ¯”å…¶ä»–åŸºå‡†é«˜å‡º 10ppï¼Œè¡¨æ˜å…¶æ½œåœ¨ç©ºé—´ç»“æ„è‰¯å¥½ã€‚</li>
</ul>
</li>
</ol>
<p>æ­¤å¤–ï¼ŒTerraMind è¿˜å¼•å…¥äº† <strong>â€œå¤šæ¨¡æ€æ€ç»´â€ (Thinking in Modalities, TiM)</strong> çš„åˆ›æ–°æ¦‚å¿µï¼Œç±»ä¼¼äºå¤§å‹è¯­è¨€æ¨¡å‹ä¸­çš„â€œæ€ç»´é“¾ (chain-of-thought)â€ã€‚é€šè¿‡åœ¨å¾®è°ƒå’Œæ¨ç†è¿‡ç¨‹ä¸­æ³¨å…¥ç”Ÿæˆçš„äººå·¥æ•°æ®ï¼Œæ¨¡å‹è¾“å‡ºæ€§èƒ½å¾—ä»¥æå‡ã€‚ä¾‹å¦‚ï¼Œåœ¨æ°´ä½“æµ‹ç»˜ä»»åŠ¡ä¸­ï¼Œé€šè¿‡ç”Ÿæˆé¢å¤–çš„ LULC æ•°æ®ï¼ŒTiM å¾®è°ƒæ¯”æ ‡å‡†å¾®è°ƒçš„ mIoU æå‡äº† 2ppã€‚</p>
<p><img src="https://research.ibm.com/_next/image?url=https%3A%2F%2Fresearch-website-prod-cms-uploads.s3.us.cloud-object-storage.appdomain.cloud%2FScreenshot_2025_10_20_at_3_49_35_PM_9f03a58e80.png&amp;w=1920&amp;q=85" alt=""></p>
<h1 id="ç¼–ç ä¸é‡å»ºtokenizer">ç¼–ç ä¸é‡å»ºï¼ˆTokenizerï¼‰</h1>
<p>é¦–å…ˆè¦ç†è§£ TerraMind çš„ <strong>Tokenizer</strong>ã€‚å®ƒçš„å·¥ä½œåŸç†ç±»ä¼¼â€œå‹ç¼©â€”è§£å‹â€ï¼š</p>
<ul>
<li>è¾“å…¥å½±åƒ â†’ è½¬æ¢æˆ token è¡¨ç¤º</li>
<li>token æ•æ‰ç©ºé—´ç»†èŠ‚å’Œä¸Šä¸‹æ–‡ä¿¡æ¯</li>
<li>å†é€šè¿‡è§£ç å™¨é‡å»ºå½±åƒ â†’ æ£€éªŒæ¨¡å‹æ˜¯å¦â€œç†è§£â€äº†è¾“å…¥</li>
</ul>
<p>è¿™éƒ¨åˆ†ä¸»è¦æ˜¯ <strong>éªŒè¯æ¨¡å‹çš„ä¿¡æ¯ä¿ç•™èƒ½åŠ›</strong>ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€æ®µå®é™…çš„ Python è„šæœ¬ï¼ˆåŸºäº Sentinel-2 L2A æ•°æ®ï¼‰ï¼Œå‚è€ƒ<a href="https://github.com/IBM/terramind/blob/main/notebooks/terramind_tokenizer_reconstruction.ipynb">IBM/terramind/notebooks/terramind_tokenizer_reconstruction.ipynb</a>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ„å»º tokenizer æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> FULL_MODEL_REGISTRY<span style="color:#f92672">.</span>build(<span style="color:#e6db74">&#39;terramind_v1_tokenizer_s2l2a&#39;</span>, pretrained<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ è½½ç¤ºä¾‹å½±åƒå¹¶æ„é€ æˆå¼ é‡</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Load an example Sentinel-2 image</span>
</span></span><span style="display:flex;"><span>examples <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;../examples/S2L2A/38D_378R_2_3.tif&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;../examples/S2L2A/282D_485L_3_3.tif&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;../examples/S2L2A/433D_629L_3_1.tif&#39;</span>,
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> rxr<span style="color:#f92672">.</span>open_rasterio(examples[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert to [B, C, 224, 224]</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>Tensor(data<span style="color:#f92672">.</span>values, device<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;cpu&#39;</span>)<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å½’ä¸€åŒ–ï¼ˆæ ‡å‡†åŒ–ï¼‰</span>
</span></span><span style="display:flex;"><span>mean <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>Tensor(v1_pretraining_mean[<span style="color:#e6db74">&#39;untok_sen2l2a@224&#39;</span>])
</span></span><span style="display:flex;"><span>std <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>Tensor(v1_pretraining_std[<span style="color:#e6db74">&#39;untok_sen2l2a@224&#39;</span>])
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> (data <span style="color:#f92672">-</span> mean[<span style="color:#66d9ef">None</span>, :, <span style="color:#66d9ef">None</span>, <span style="color:#66d9ef">None</span>]) <span style="color:#f92672">/</span> std[<span style="color:#66d9ef">None</span>, :, <span style="color:#66d9ef">None</span>, <span style="color:#66d9ef">None</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¿è¡Œæ¨¡å‹ï¼ˆç¼–ç â†’è§£ç ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> torch<span style="color:#f92672">.</span>no_grad():
</span></span><span style="display:flex;"><span>    reconstruction <span style="color:#f92672">=</span> model(input, timesteps<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åæ ‡å‡†åŒ–ï¼ˆæ¢å¤åˆ°åŸå§‹æ•°é‡çº§ï¼‰</span>
</span></span><span style="display:flex;"><span>reconstruction <span style="color:#f92672">=</span> reconstruction<span style="color:#f92672">.</span>cpu()
</span></span><span style="display:flex;"><span>reconstruction <span style="color:#f92672">=</span> (reconstruction <span style="color:#f92672">*</span> std[<span style="color:#66d9ef">None</span>, :, <span style="color:#66d9ef">None</span>, <span style="color:#66d9ef">None</span>]) <span style="color:#f92672">+</span> mean[<span style="color:#66d9ef">None</span>, :, <span style="color:#66d9ef">None</span>, <span style="color:#66d9ef">None</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è§£ç å‡ºæ¥çš„ reconstruction è¦ä¹˜ä»¥ std åŠ ä¸Š mean æŠŠæ•°å€¼å¸¦å›â€œçœŸå®â€é‡çº²ï¼ˆä¸åŸå§‹æ•°æ®åŒä¸€å–å€¼èŒƒå›´ï¼‰ï¼Œå¦åˆ™çœ‹èµ·æ¥ä¼šåƒâ€œå‡å€¼ä¸º 0 çš„å°æ•°â€ã€‚</span>
</span></span></code></pre></div><p>åœ¨å¯è§†åŒ–æ—¶ï¼Œå¯ä»¥å¯¹æ¯”è¾“å…¥å½±åƒä¸é‡å»ºå½±åƒçš„ RGB è¡¨è¾¾ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Input RGB</span>
</span></span><span style="display:flex;"><span>rgb_input <span style="color:#f92672">=</span> data[<span style="color:#ae81ff">0</span>, [<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]]<span style="color:#f92672">.</span>permute(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>cpu()<span style="color:#f92672">.</span>numpy()
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>imshow((rgb_input<span style="color:#f92672">/</span><span style="color:#ae81ff">2000</span>)<span style="color:#f92672">.</span>clip(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Input&#34;</span>); ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Reconstructed RGB</span>
</span></span><span style="display:flex;"><span>rgb_recon <span style="color:#f92672">=</span> reconstruction[<span style="color:#ae81ff">0</span>, [<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]]<span style="color:#f92672">.</span>permute(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>cpu()<span style="color:#f92672">.</span>numpy()
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>imshow((rgb_recon<span style="color:#f92672">/</span><span style="color:#ae81ff">2000</span>)<span style="color:#f92672">.</span>clip(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Reconstruction&#34;</span>); ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>æ•ˆæœï¼šå·¦è¾¹æ˜¯åŸå§‹ Sentinel-2 è¾“å…¥ï¼Œå³è¾¹æ˜¯ Tokenizer è§£ç åçš„é‡å»ºç»“æœã€‚</p>
<p>ğŸ‘‰ è¿™è¯æ˜ <strong>TerraMind èƒ½ç”¨ token è¡¨ç¤ºå½±åƒï¼Œå¹¶ä¸”å¾ˆå¥½åœ°ä¿ç•™ä¿¡æ¯</strong>ã€‚</p>
<h1 id="è·¨æ¨¡æ€ç”Ÿæˆgeneration">è·¨æ¨¡æ€ç”Ÿæˆï¼ˆGenerationï¼‰</h1>
<p>ä»¤äººå…´å¥‹çš„æ˜¯ TerraMind çš„ <strong>ç”Ÿæˆèƒ½åŠ›</strong>ã€‚
å®ƒä¸ä»…èƒ½â€œé‡å»ºâ€è¾“å…¥ï¼Œè¿˜èƒ½å®ç° <strong>è·¨æ¨¡æ€ç”Ÿæˆ (Any-to-Any)</strong>ï¼š</p>
<ul>
<li>å…‰å­¦å½±åƒ â†’ ç”Ÿæˆé›·è¾¾å½±åƒ</li>
<li>DEM â†’ ç”Ÿæˆå…‰å­¦æˆ– NDVI</li>
<li>å½±åƒ â†’ ç”Ÿæˆ LULC åœ°å›¾</li>
<li>ç”šè‡³è¿˜èƒ½åš å›¾åƒ â†” æ–‡æœ¬</li>
</ul>
<p>è¿™ç§ <strong>ä»»æ„æ¨¡æ€åˆ°ä»»æ„æ¨¡æ€çš„ç”Ÿæˆèƒ½åŠ›</strong>ï¼Œæ˜¯ TerraMind ç›¸æ¯”ä¼ ç»Ÿæ¨¡å‹çš„æœ€å¤§çªç ´ã€‚
å®ƒæ„å‘³ç€ï¼šå³ä¾¿æŸäº›æ•°æ®ç¼ºå¤±ï¼Œä¹Ÿèƒ½é€šè¿‡ç”Ÿæˆè¡¥é½ï¼›å³ä¾¿æ ‡æ³¨æœ‰é™ï¼Œä¹Ÿèƒ½é€šè¿‡ç”Ÿæˆå¢å¼ºè®­ç»ƒã€‚</p>
<h2 id="å•-patch-ç¤ºä¾‹">å• patch ç¤ºä¾‹</h2>
<ul>
<li>è¾“å…¥ï¼šå•ä¸ª patchï¼Œå¯ä»¥æ˜¯S2-L2Açš„æ•°æ® (224Ã—224)</li>
<li>è¾“å‡ºï¼šå¤šä¸ªç›®æ ‡æ¨¡æ€ï¼Œå¦‚ S1GRDã€DEMã€LULC ç­‰ã€‚</li>
<li>ç‰¹ç‚¹ï¼š
<ul>
<li>æ¯ä¸ªè¾“å‡ºæ¨¡æ€å¯¹åº”è‡ªå·±çš„ tokenizerï¼ˆå¢åŠ äº†å†…å­˜æ¶ˆè€—ï¼‰ã€‚</li>
<li>ä½¿ç”¨ diffusion stepsï¼ˆå¦‚ 10 æ­¥ï¼‰ç”Ÿæˆç»“æœ â†’ ä¿è¯è¾“å‡ºçš„å¤šæ ·æ€§ä¸è´¨é‡ã€‚</li>
<li>å¯ä»¥ç›´æ¥å¯¹è¾“å…¥åšæ ‡å‡†åŒ–ï¼ˆstandardize=Trueï¼‰ã€‚</li>
</ul>
</li>
<li>æ­¥éª¤ï¼š
<ol>
<li>æ„å»ºæ¨¡å‹</li>
</ol>
<ul>
<li>ä» <code>FULL_MODEL_REGISTRY</code> ä¸­å®ä¾‹åŒ– TerraMind æ¨¡å‹ã€‚</li>
<li>æŒ‡å®š <strong>è¾“å…¥æ¨¡æ€</strong>ï¼ˆä¾‹å¦‚ <code>S2L2A</code>ï¼‰å’Œ <strong>è¾“å‡ºæ¨¡æ€</strong>ï¼ˆä¾‹å¦‚ <code>S1GRD, DEM, LULC</code>ï¼‰ã€‚</li>
<li>é€‰æ‹©æ˜¯å¦åŠ è½½é¢„è®­ç»ƒæƒé‡ï¼ˆ<code>pretrained=True</code>ï¼‰ã€‚</li>
<li>é…ç½®æ ‡å‡†åŒ–ï¼ˆ<code>standardize=True</code>ï¼Œä¼šè‡ªåŠ¨åº”ç”¨é¢„è®­ç»ƒæ—¶çš„å‡å€¼/æ–¹å·®ï¼‰ã€‚</li>
</ul>
<ol start="2">
<li>å‡†å¤‡æ•°æ®</li>
</ol>
<ul>
<li>åŠ è½½rasteræ•°æ®</li>
<li>ä½¿ç”¨ <code>rioxarray.open_rasterio</code> è¯»å–ä¸ºæ•°ç»„ã€‚</li>
<li>è½¬æ¢æˆæ¨¡å‹è¦æ±‚çš„è¾“å…¥å½¢çŠ¶ [Batch, Channels, Height, Width]ï¼Œä¾‹å¦‚ [1, C, 224, 224]ã€‚</li>
</ul>
<ol start="3">
<li>åŠ è½½è¾“å…¥æ•°æ®ï¼šå°†è¾“å…¥æ•°æ®ç»˜åˆ¶æˆ RGB å›¾åƒï¼ˆå¸®åŠ©ç†è§£è¾“å…¥å†…å®¹ï¼‰ã€‚</li>
<li>æ‰§è¡Œæ‰©æ•£ç”Ÿæˆ</li>
</ol>
<ul>
<li>æŠŠè¾“å…¥é€å…¥ GPU/CPUï¼ˆ<code>input.to(device)</code>ï¼‰ã€‚</li>
<li>åœ¨ <code>torch.no_grad()</code> ä¸‹è¿è¡Œ æ‰©æ•£ç”Ÿæˆï¼ˆ<code>model(input, timesteps=10)</code>ï¼‰</li>
<li><code>timesteps</code> æ§åˆ¶æ‰©æ•£è¿‡ç¨‹çš„è¿­ä»£æ¬¡æ•°ï¼ˆæ­¥æ•°è¶Šå¤šï¼Œç”Ÿæˆç»“æœè¶Šç²¾ç»†ä½†è€—æ—¶æ›´é•¿ï¼‰ã€‚</li>
</ul>
<ol start="5">
<li>å¾—åˆ°å¤šæ¨¡æ€è¾“å‡º</li>
</ol>
<ul>
<li>æ¨¡å‹ä¼šè¿”å›ä¸€ä¸ªå­—å…¸ï¼ˆ<code>{æ¨¡æ€å: ç”Ÿæˆç»“æœ}</code>ï¼‰</li>
<li>æ¯ä¸ªè¾“å‡ºæ¨¡æ€æœ‰å¯¹åº”çš„ <strong>ç”Ÿæˆå¼ é‡</strong>ã€‚</li>
</ul>
<ol start="6">
<li>å¯è§†åŒ–ç»“æœã€‚</li>
</ol>
<ul>
<li>éå†è¾“å‡ºæ¨¡æ€ï¼Œè°ƒç”¨ <code>plot_modality()</code> ç»˜åˆ¶æ¯ä¸ªç»“æœã€‚</li>
<li>ä¸è¾“å…¥å›¾åƒå¹¶æ’æ˜¾ç¤ºï¼Œæ–¹ä¾¿æ¯”è¾ƒã€‚</li>
</ul>
</li>
</ul>
<p>ä¸‹é¢pythonç‰‡æ®µå®ç°äº†ç”¨ S-2 è¾“å…¥å»ç”Ÿæˆå…¶ä»–æ¨¡æ€ï¼ˆS-1ã€DEMã€LULCâ€¦â€¦ï¼‰ï¼Œå‚è€ƒ <a href="https://github.com/IBM/terramind/blob/main/notebooks/terramind_generation.ipynb">IBM/terramind/notebooks/terramind_generation.ipynb</a>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># è½½å…¥ç¤ºä¾‹ S-2 L2A å¹¶æ„æˆæ¨¡å‹è¾“å…¥</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> rxr<span style="color:#f92672">.</span>open_rasterio(examples[example_id])          <span style="color:#75715e"># rioxarray DataArray</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>Tensor(data<span style="color:#f92672">.</span>values, device<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;cpu&#39;</span>)<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">0</span>)  <span style="color:#75715e"># -&gt; [B, C, H, W]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»ºæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> FULL_MODEL_REGISTRY<span style="color:#f92672">.</span>build(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;terramind_v1_base_generate&#39;</span>,
</span></span><span style="display:flex;"><span>    modalities<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;S2L2A&#39;</span>],
</span></span><span style="display:flex;"><span>    output_modalities<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;S1GRD&#39;</span>, <span style="color:#e6db74">&#39;DEM&#39;</span>, <span style="color:#e6db74">&#39;LULC&#39;</span>],
</span></span><span style="display:flex;"><span>    pretrained<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>    standardize<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç§»åˆ°è®¾å¤‡</span>
</span></span><span style="display:flex;"><span>_ <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>to(device)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¿è¡Œç”Ÿæˆï¼ˆdiffusion stepsï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> torch<span style="color:#f92672">.</span>no_grad():
</span></span><span style="display:flex;"><span>  generated <span style="color:#f92672">=</span> model(input, verbose<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, timesteps<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span></code></pre></div><p>æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ è·¨æ¨¡æ€ç¿»è¯‘ï¼š<strong>ç»™ä½ ä¸€ä¸ª Sentinel-2 çš„ patchï¼Œæˆ‘å¯ä»¥â€œæƒ³è±¡â€å‡º SARã€DEMã€NDVI ç­‰å…¶ä»–æ¨¡æ€ã€‚</strong></p>
<h2 id="åˆ†å—æ¨ç†tiled-inference">åˆ†å—æ¨ç†ï¼ˆTiled Inferenceï¼‰</h2>
<p><strong>ä¸ºä»€ä¹ˆè¦ç”¨ tiled_inferenceï¼Ÿ</strong></p>
<p>å¤§ç“¦ç‰‡ï¼ˆfull tileï¼‰é€šå¸¸è¶…å‡º GPU å†…å­˜ï¼Œæ•…æŠŠå¤§å›¾åˆ‡æˆè®¸å¤šå° tileï¼ˆpatchï¼‰åˆ†åˆ«åœ¨ GPU ä¸Šæ¨ç†ï¼Œç„¶ååˆå¹¶å›æ•´å›¾ã€‚tiled_inference æ˜¯ä¸€ä¸ªå·¥å…·å‡½æ•°ï¼ˆTerraTorch/ç”¨æˆ·åº“æä¾›ï¼‰ï¼Œè´Ÿè´£åˆ‡ patchã€æŒ‰ batch è°ƒç”¨æ¨¡å‹ã€å¹¶æŠŠ patch è¾“å‡ºåˆå¹¶æˆæ•´å¹…è¾“å‡ºã€‚</p>
<p>æ€»è€Œè¨€ä¹‹ï¼š</p>
<ul>
<li>è¾“å…¥ï¼šæ•´å— tileï¼ˆæ¯”å¦‚ Singapore, Santiagoï¼Œå¯èƒ½æ˜¯ 1000Ã—1000 æˆ–æ›´å¤§ï¼‰ã€‚</li>
<li>é—®é¢˜ï¼šGPU å†…å­˜ä¸å¤Ÿæ”¾ä¸‹æ•´å¼ å›¾ã€‚</li>
<li>æ­¥éª¤ï¼š
<ol>
<li>è½½å…¥å¹¶ï¼ˆå¯é€‰ï¼‰è£å‰ªå¤§ç“¦ç‰‡</li>
<li>è½¬æ¢ä¸º [B,C,H,W]</li>
<li>æ„å»ºç”Ÿæˆæ¨¡å‹ï¼ˆæŒ‡å®šè¾“å‡ºæ¨¡æ€ã€timestepsï¼‰</li>
<li>ç”¨ tiled_inference åˆ‡ patch å¹¶æ‰¹é‡è°ƒç”¨ model_forward</li>
<li>åˆå¹¶å›æ•´å›¾å¾—åˆ° [C_total,H,W]</li>
<li>åˆ‡åˆ†å„æ¨¡æ€é€šé“</li>
<li>å¯¹è¿ç»­æ¨¡æ€åæ ‡å‡†åŒ–ã€å¯¹åˆ†ç±»æ¨¡æ€ argmax</li>
<li>ä¿å­˜ GeoTIFF / å¯è§†åŒ– / æŒ‡æ ‡è¯„ä¼°ã€‚</li>
</ol>
</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€æ®µå®é™…çš„ Python è„šæœ¬ï¼Œå‚è€ƒ <a href="https://github.com/IBM/terramind/blob/main/notebooks/large_tile_generation.ipynb">IBM/terramind/notebooks/large_tile_generation.ipynb</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># è¾“å…¥å‡†å¤‡ï¼ˆcrop / batch dimï¼‰</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> rxr<span style="color:#f92672">.</span>open_rasterio(<span style="color:#e6db74">&#39;examples/S2L2A/Santiago.tif&#39;</span>)<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> data[:, <span style="color:#ae81ff">500</span>:<span style="color:#ae81ff">1500</span>]           <span style="color:#75715e"># å¯é€‰è£å‰ªä»¥åŠ é€Ÿ</span>
</span></span><span style="display:flex;"><span>input <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>tensor(data, dtype<span style="color:#f92672">=</span>torch<span style="color:#f92672">.</span>float, device<span style="color:#f92672">=</span>device)<span style="color:#f92672">.</span>unsqueeze(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»ºå¹¶å‡†å¤‡ç”Ÿæˆæ¨¡å‹ï¼šä»¥ S2L2A ä¸ºæ¡ä»¶è¾“å…¥ï¼Œç”Ÿæˆ S1GRD å’Œ LULC</span>
</span></span><span style="display:flex;"><span>output_modalities <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;S1GRD&#39;</span>, <span style="color:#e6db74">&#39;LULC&#39;</span>]
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> FULL_MODEL_REGISTRY<span style="color:#f92672">.</span>build(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;terramind_v1_base_generate&#39;</span>,
</span></span><span style="display:flex;"><span>    modalities<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;S2L2A&#39;</span>],
</span></span><span style="display:flex;"><span>    output_modalities<span style="color:#f92672">=</span>output_modalities,
</span></span><span style="display:flex;"><span>    pretrained<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>    standardize<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>    timesteps<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>to(device)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä» dict â†’ tensor</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">model_forward</span>(x):
</span></span><span style="display:flex;"><span>    generated <span style="color:#f92672">=</span> model(x)                       <span style="color:#75715e"># dict: {modality: tensor}</span>
</span></span><span style="display:flex;"><span>    out <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>concat([generated[m] <span style="color:#66d9ef">for</span> m <span style="color:#f92672">in</span> output_modalities], dim<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> out
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tiled_inference çš„è¾“å‡ºä¸å»æ‰¹æ¬¡ç»´</span>
</span></span><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> tiled_inference(model_forward, input, crop<span style="color:#f92672">=</span><span style="color:#ae81ff">256</span>, stride<span style="color:#f92672">=</span><span style="color:#ae81ff">192</span>, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>, verbose<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> pred<span style="color:#f92672">.</span>squeeze(<span style="color:#ae81ff">0</span>)   <span style="color:#75715e"># ä» [1, C, H, W] -&gt; [C, H, W]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æŠŠæ‹¼æ¥çš„é€šé“åˆ‡å›å„æ¨¡æ€</span>
</span></span><span style="display:flex;"><span>num_channels <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;S2L2A&#39;</span>:<span style="color:#ae81ff">12</span>, <span style="color:#e6db74">&#39;S1GRD&#39;</span>:<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;S1RTC&#39;</span>:<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;DEM&#39;</span>:<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;LULC&#39;</span>:<span style="color:#ae81ff">10</span>, <span style="color:#e6db74">&#39;NDVI&#39;</span>:<span style="color:#ae81ff">1</span>}
</span></span><span style="display:flex;"><span>num_channels <span style="color:#f92672">=</span> {m: num_channels[m] <span style="color:#66d9ef">for</span> m <span style="color:#f92672">in</span> output_modalities}
</span></span><span style="display:flex;"><span>start_idx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum([<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> list(num_channels<span style="color:#f92672">.</span>values()))
</span></span><span style="display:flex;"><span>generated <span style="color:#f92672">=</span> {m: pred[i:i<span style="color:#f92672">+</span>c]<span style="color:#f92672">.</span>cpu() <span style="color:#66d9ef">for</span> m, i, c <span style="color:#f92672">in</span> zip(output_modalities, start_idx, num_channels<span style="color:#f92672">.</span>values())}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># LULC çš„åå¤„ç†ï¼ˆä»æ¦‚ç‡ -&gt; ç¦»æ•£ç±»åˆ«ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;LULC&#39;</span> <span style="color:#f92672">in</span> generated<span style="color:#f92672">.</span>keys():
</span></span><span style="display:flex;"><span>    generated[<span style="color:#e6db74">&#39;LULC&#39;</span>] <span style="color:#f92672">=</span> generated[<span style="color:#e6db74">&#39;LULC&#39;</span>]<span style="color:#f92672">.</span>argmax(dim<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><p>æ•…è€Œï¼Œè®© TerraMind ä¸åªæ˜¯å° patch demoï¼Œè€Œæ˜¯èƒ½å¤Ÿè¢«åº”ç”¨åˆ°çœŸå®åœ°çƒå¤§èŒƒå›´åœºæ™¯ã€‚</p>
<h1 id="å¾®è°ƒä»»åŠ¡fine-tuning-with-terratorch">å¾®è°ƒä»»åŠ¡ï¼ˆFine-tuning with TerraTorchï¼‰</h1>
<p>TerraMind çš„å¦ä¸€å¤§äº®ç‚¹ï¼Œå°±æ˜¯èƒ½å¾ˆæ–¹ä¾¿åœ°åœ¨ä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¦‚è¯­ä¹‰åˆ†å‰²ï¼‰ä¸Šå¾®è°ƒã€‚æˆ‘ä»¬ä»¥<a href="https://github.com/IBM/terramind/blob/main/notebooks/terramind_v1_base_sen1floods11.ipynb">IBM/terramind/notebooks/terramind_v1_base_sen1floods11.ipynb</a>ä¸ºä¾‹ï¼Œè®²è®²å¾®è°ƒçš„ä¸»è¦æµç¨‹ï¼š</p>
<ol>
<li>
<p><strong>æ•°æ®å‡†å¤‡ï¼ˆDataModuleï¼‰</strong>
ä½¿ç”¨ <code>GenericMultiModalDataModule</code> æ¥å®šä¹‰æ¨¡æ€ã€è·¯å¾„ã€split æ–‡ä»¶ã€æ ‡å‡†åŒ–å‚æ•°ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>æ¨¡æ€ï¼š<code>[&quot;S2L1C&quot;, &quot;S1GRD&quot;]</code></li>
<li>æ ‡ç­¾ï¼š<code>*_LabelHand.tif</code></li>
<li>è®­ç»ƒ/éªŒè¯/æµ‹è¯•åˆ’åˆ†ï¼š<code>flood_train_data.txt</code> ç­‰</li>
</ul>
<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä¸ç®¡ä½ ç”¨çš„æ˜¯å…‰å­¦+é›·è¾¾ï¼Œè¿˜æ˜¯åŠ  DEMã€LULCï¼Œéƒ½èƒ½å¿«é€Ÿé…ç½®ã€‚</p>
</li>
<li>
<p><strong>åŠ è½½é¢„è®­ç»ƒ Backbone</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>model <span style="color:#f92672">=</span> BACKBONE_REGISTRY<span style="color:#f92672">.</span>build(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;terramind_v1_base&#34;</span>,
</span></span><span style="display:flex;"><span>    modalities<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;S2L1C&#34;</span>, <span style="color:#e6db74">&#34;S1GRD&#34;</span>],
</span></span><span style="display:flex;"><span>    pretrained<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div></li>
<li>
<p><strong>å®šä¹‰ä¸‹æ¸¸ä»»åŠ¡ï¼ˆSemanticSegmentationTaskï¼‰</strong></p>
<ul>
<li>Backboneï¼šTerraMind</li>
<li>Neckï¼šç‰¹å¾æå–å’Œ reshape</li>
<li>Decoderï¼šUNetDecoder</li>
<li>Lossï¼šDice æˆ– CE</li>
</ul>
<p>åŒæ—¶æ”¯æŒå†»ç»“/è§£å†» backboneï¼Œè°ƒèŠ‚å­¦ä¹ ç‡ï¼ˆ1e-5 ~ 1e-4ï¼‰ã€‚</p>
</li>
<li>
<p><strong>è®­ç»ƒä¸æµ‹è¯•</strong>
é€šè¿‡ PyTorch Lightning çš„ <code>Trainer.fit()</code> å¯åŠ¨è®­ç»ƒï¼Œä¿å­˜æœ€ä½³ checkpointã€‚
ç„¶ååœ¨ <code>Trainer.test()</code> ä¸Šè¯„ä¼°ï¼Œæœ€åå°±èƒ½è¿›è¡Œé¢„æµ‹å’Œå¯è§†åŒ–ã€‚</p>
</li>
</ol>
<p>æ•´ä¸ªå¾®è°ƒè„šæœ¬è·‘ä¸‹æ¥ï¼Œå°±å¯ä»¥ä»â€œé¢„è®­ç»ƒåŸºç¡€æ¨¡å‹â€å¾—åˆ°ä¸€ä¸ªâ€œé€‚é…ä»»åŠ¡çš„æ¨¡å‹â€ï¼Œå“ªæ€•åªè®­ç»ƒäº†å‡ ä¸ª epochï¼Œå°±èƒ½çœ‹åˆ°æ•ˆæœã€‚</p>
<h2 id="åœ¨å¾®è°ƒä¸­ä½¿ç”¨tim">åœ¨å¾®è°ƒä¸­ä½¿ç”¨TiM</h2>
<p>è¦åœ¨å¾®è°ƒä¸­ä½¿ç”¨ TiMï¼Œåªéœ€è¦ä½¿ç”¨ä»¥ <code>_tim</code> ç»“å°¾çš„ backboneï¼Œå¹¶ä¸”é€šè¿‡ <code>backbone_tim_modalities</code> æŒ‡æ˜è¦ä½¿ç”¨çš„æ¨¡æ€ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">backbone</span>: <span style="color:#ae81ff">terramind_v1_base_tim     </span> <span style="color:#75715e"># è€Œä¸æ˜¯terramind_v1_base</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">backbone_tim_modalities</span>: [<span style="color:#ae81ff">LULC]     </span> <span style="color:#75715e"># æˆ– S1GRD / NDVI / DEM / â€¦</span>
</span></span></code></pre></div><h1 id="æ€»ç»“">æ€»ç»“</h1>
<ul>
<li>
<p><strong>TerraMind æ˜¯ä»€ä¹ˆï¼Ÿ</strong> ä¸€ä¸ªé¢å‘åœ°çƒè§‚æµ‹çš„å¤šæ¨¡æ€åŸºç¡€æ¨¡å‹ã€‚</p>
</li>
<li>
<p><strong>å®ƒèƒ½å¹²ä»€ä¹ˆï¼Ÿ</strong> å¤šæ¨¡æ€æ•´åˆã€ç”Ÿæˆä»»åŠ¡ã€ä¸‹æ¸¸æ³›åŒ–ã€‚</p>
</li>
<li>
<p><strong>æ€ä¹ˆç©ï¼Ÿ</strong></p>
<ul>
<li>å…ˆä½“éªŒç”Ÿæˆèƒ½åŠ›ï¼šè¾“å…¥å½±åƒ â†’ tokens â†’ é‡å»ºå½±åƒã€‚</li>
<li>å†åšä¸‹æ¸¸å¾®è°ƒï¼šé…ç½® DataModuleï¼ŒåŠ è½½é¢„è®­ç»ƒæ¨¡å‹ï¼Œå®šä¹‰ä»»åŠ¡ï¼Œè®­ç»ƒ/æµ‹è¯•ã€‚</li>
</ul>
</li>
</ul>
<p>å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ¨¡å‹ï¼Œæ›´åƒæ˜¯ä¸€ä¸ª <strong>é¢å‘ EO çš„é€šç”¨ AI å¹³å°</strong>ã€‚æœªæ¥ä¸è®ºæ˜¯æ°”å€™ç ”ç©¶ã€ç¾å®³å“åº”ï¼Œè¿˜æ˜¯åœŸåœ°è¦†ç›–ç›‘æµ‹ï¼Œéƒ½èƒ½å€ŸåŠ©å®ƒå¿«é€Ÿè½åœ°ã€‚</p>
<h1 id="äº†è§£æ›´å¤š">äº†è§£æ›´å¤š</h1>
<ul>
<li><a href="https://github.com/IBM/terramind/tree/main">Github: IBM/terramind</a></li>
<li><a href="https://huggingface.co/ibm-esa-geospatial/TerraMind-1.0-base">Hugging Face: ibm-esa-geospatial/TerraMind-1.0-base</a></li>
<li><a href="https://doi.org/10.48550/arXiv.2504.11171">Paper (arxiv): TerraMind: Large-Scale Generative Multimodality for Earth Observation</a></li>
<li><a href="https://research.ibm.com/blog/thinking-in-modalities-terramind">Introducing Thinking-in-Modalities with TerraMind</a></li>
</ul>


        
          <div class="blog-tags">
            
              
              <a href="https://www.xuqiongjie.com/zh-cn/tags/geofm/">GeoFM</a>&nbsp;
            
              
              <a href="https://www.xuqiongjie.com/zh-cn/tags/terramind/">terramind</a>&nbsp;
            
              
              <a href="https://www.xuqiongjie.com/zh-cn/tags/%E9%81%A5%E6%84%9F/">é¥æ„Ÿ</a>&nbsp;
            
              
              <a href="https://www.xuqiongjie.com/zh-cn/tags/ai/">AI</a>&nbsp;
            
              
              <a href="https://www.xuqiongjie.com/zh-cn/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/">å¤§æ¨¡å‹</a>&nbsp;
            
              
              <a href="https://www.xuqiongjie.com/zh-cn/tags/eo/">EO</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=https%3a%2f%2fwww.xuqiongjie.com%2fzh-cn%2fpost%2fgeoai%2fgeofm-intro-terramind%2f&amp;text=%e7%8e%a9%e8%bd%ac%20TerraMind%ef%bc%9a%e4%bb%8e%e7%90%86%e8%a7%a3%e5%88%b0%e5%be%ae%e8%b0%83&amp;via=" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.xuqiongjie.com%2fzh-cn%2fpost%2fgeoai%2fgeofm-intro-terramind%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=https%3a%2f%2fwww.xuqiongjie.com%2fzh-cn%2fpost%2fgeoai%2fgeofm-intro-terramind%2f&amp;title=%e7%8e%a9%e8%bd%ac%20TerraMind%ef%bc%9a%e4%bb%8e%e7%90%86%e8%a7%a3%e5%88%b0%e5%be%ae%e8%b0%83" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.xuqiongjie.com%2fzh-cn%2fpost%2fgeoai%2fgeofm-intro-terramind%2f&amp;title=%e7%8e%a9%e8%bd%ac%20TerraMind%ef%bc%9a%e4%bb%8e%e7%90%86%e8%a7%a3%e5%88%b0%e5%be%ae%e8%b0%83" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fwww.xuqiongjie.com%2fzh-cn%2fpost%2fgeoai%2fgeofm-intro-terramind%2f&amp;title=%e7%8e%a9%e8%bd%ac%20TerraMind%ef%bc%9a%e4%bb%8e%e7%90%86%e8%a7%a3%e5%88%b0%e5%be%ae%e8%b0%83" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fwww.xuqiongjie.com%2fzh-cn%2fpost%2fgeoai%2fgeofm-intro-terramind%2f&amp;description=%e7%8e%a9%e8%bd%ac%20TerraMind%ef%bc%9a%e4%bb%8e%e7%90%86%e8%a7%a3%e5%88%b0%e5%be%ae%e8%b0%83" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          
            
          

          
                  <h4 class="see-also">ä¹Ÿå¯ä»¥çœ‹çœ‹</h4>
                  <ul>
                
                
                    <li><a href="/zh-cn/post/python-geodata/01-intro/">ç¬¬ 1 è¯¾ï¼šé¥æ„Ÿæ•°æ®ä¸ Python ç¯å¢ƒå…¥é—¨</a></li>
                
              </ul>

          
        
      </article>

      
        <ul class="pager blog-pager">
          
          
        </ul>
      


      

    </div>
  </div>
</div>

      <footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
		
		  <a href="mailto:ele.qiong@gmail.com" title="Email me">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://github.com/ictar" title="GitHub">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://linkedin.com/in/qiongjie-xu" title="LinkedIn">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://www.xuqiongjie.com">Qiongjie.X</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2025
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://www.xuqiongjie.com/zh-cn/">ç¼å‘€</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          ç”± <a href="https://gohugo.io">Hugo v0.147.4</a> å¼ºåŠ›é©±åŠ¨ &nbsp;&bull;&nbsp; ä¸»é¢˜ <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> ç§»æ¤è‡ª <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="https://www.xuqiongjie.com/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://www.xuqiongjie.com/js/load-photoswipe.js"></script>










    
  </body>
</html>

