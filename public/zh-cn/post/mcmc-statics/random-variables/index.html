

<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>éšæœºå˜é‡å’Œé‡‡æ · - </title>

  <meta name="description" content="äº†è§£éšæœºå˜é‡ã€æ¦‚ç‡å¯†åº¦å‡½æ•°ã€æœŸæœ›ç­‰æ¦‚å¿µã€å¸¸è§é‡‡æ ·æ–¹æ³•ä»¥åŠç®€å•åˆ†å¸ƒï¼ˆå‡åŒ€ã€æ­£æ€ã€æŒ‡æ•°ï¼‰çš„é‡‡æ ·æ–¹å¼">
  <meta name="author" content="Qiongjie.X"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "ç¼å‘€",
    
    "url": "http:\/\/localhost:1313\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "http:\/\/localhost:1313\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "http:\/\/localhost:1313\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "http:\/\/localhost:1313\/zh-cn\/post\/mcmc-statics\/random-variables\/",
          "name": "éšæœºå˜é‡å’Œé‡‡æ ·"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Qiongjie.X"
  },
  "headline": "éšæœºå˜é‡å’Œé‡‡æ ·",
  "description" : "äº†è§£éšæœºå˜é‡ã€æ¦‚ç‡å¯†åº¦å‡½æ•°ã€æœŸæœ›ç­‰æ¦‚å¿µã€å¸¸è§é‡‡æ ·æ–¹æ³•ä»¥åŠç®€å•åˆ†å¸ƒï¼ˆå‡åŒ€ã€æ­£æ€ã€æŒ‡æ•°ï¼‰çš„é‡‡æ ·æ–¹å¼",
  "inLanguage" : "zh-cn",
  "wordCount":  1487 ,
  "datePublished" : "2025-08-02T00:00:00\u002b00:00",
  "dateModified" : "2025-08-02T00:00:00\u002b00:00",
  "image" : "http:\/\/localhost:1313\/img\/avatar-icon.png",
  "keywords" : [ "éšæœºå˜é‡, é‡‡æ ·, éšæœºè¯•éªŒ, è¯¾ç¨‹ç¬”è®°, æ•°å­¦, python" ],
  "mainEntityOfPage" : "http:\/\/localhost:1313\/zh-cn\/post\/mcmc-statics\/random-variables\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "http:\/\/localhost:1313\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "http:\/\/localhost:1313\/img\/avatar-icon.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="éšæœºå˜é‡å’Œé‡‡æ ·" />
<meta property="og:description" content="äº†è§£éšæœºå˜é‡ã€æ¦‚ç‡å¯†åº¦å‡½æ•°ã€æœŸæœ›ç­‰æ¦‚å¿µã€å¸¸è§é‡‡æ ·æ–¹æ³•ä»¥åŠç®€å•åˆ†å¸ƒï¼ˆå‡åŒ€ã€æ­£æ€ã€æŒ‡æ•°ï¼‰çš„é‡‡æ ·æ–¹å¼">
<meta property="og:image" content="http://localhost:1313/img/avatar-icon.png" />
<meta property="og:url" content="http://localhost:1313/zh-cn/post/mcmc-statics/random-variables/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="ç¼å‘€" />

  <meta name="twitter:title" content="éšæœºå˜é‡å’Œé‡‡æ ·" />
  <meta name="twitter:description" content="äº†è§£éšæœºå˜é‡ã€æ¦‚ç‡å¯†åº¦å‡½æ•°ã€æœŸæœ›ç­‰æ¦‚å¿µã€å¸¸è§é‡‡æ ·æ–¹æ³•ä»¥åŠç®€å•åˆ†å¸ƒï¼ˆå‡åŒ€ã€æ­£æ€ã€æŒ‡æ•°ï¼‰çš„é‡‡æ ·æ–¹å¼">
  <meta name="twitter:image" content="http://localhost:1313/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <link href='http://localhost:1313/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.147.4">
  <link rel="alternate" href="http://localhost:1313/zh-cn/index.xml" type="application/rss+xml" title="ç¼å‘€"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css" integrity="sha384-h/hnnw1Bi4nbpD6kE7nYfCXzovi622sY5WBxww8ARKwpdLj5kUWjRuyiXaD1U2JT" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="http://localhost:1313/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="http://localhost:1313/css/syntax.css" /><link rel="stylesheet" href="http://localhost:1313/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  crossorigin="anonymous"
/>


<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  crossorigin="anonymous"
></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
  onload="renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false}
    ]
  });"></script>

  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">åˆ‡æ¢å¯¼èˆª</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://localhost:1313/zh-cn/">ç¼å‘€</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" role="button" tabindex="0">æ–‡ç« </a>
              <div class="navlinks-children">
                
                  <a href="/zh-cn/post/python-geodata">ç”¨ Python ç©è½¬é¥æ„Ÿæ•°æ®</a>
                
                  <a href="/zh-cn/post/mcmc-statics">è’™ç‰¹å¡æ´›-é©¬å°”å¯å¤«é“¾ç»Ÿè®¡æ–¹æ³•</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="é¡¹ç›®" href="/zh-cn/">é¡¹ç›®</a>
            </li>
          
        
          
            <li>
              <a title="ç¬”è®°" href="/zh-cn/notes">ç¬”è®°</a>
            </li>
          
        
          
            <li>
              <a title="æ ‡ç­¾" href="/zh-cn/tags">æ ‡ç­¾</a>
            </li>
          
        
          
            <li>
              <a title="å…³äºæˆ‘" href="/zh-cn/page/about/">å…³äºæˆ‘</a>
            </li>
          
        

        
          
            <li>
              
            </li>
          
        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="ç¼å‘€" href="http://localhost:1313/zh-cn/">
            <img class="avatar-img" src="http://localhost:1313/img/avatar-icon.png" alt="ç¼å‘€" />
           
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>éšæœºå˜é‡å’Œé‡‡æ ·</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;å‘è¡¨äº August 2, 2025
  
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1487&nbsp;ä¸ªå­—
  
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        
  <aside class="toc">
    <h2>ç›®å½•</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#éšæœºå˜é‡random-variables">éšæœºå˜é‡ï¼ˆRandom Variablesï¼‰</a>
      <ul>
        <li><a href="#å‡åŒ€åˆ†å¸ƒuniform-rv">å‡åŒ€åˆ†å¸ƒï¼ˆUniform RVï¼‰</a></li>
        <li><a href="#ä¼¯åŠªåˆ©éšæœºå˜é‡bernouli-rv">ä¼¯åŠªåˆ©éšæœºå˜é‡ï¼ˆBernouli RVï¼‰</a></li>
        <li><a href="#äºŒé¡¹éšæœºå˜é‡binomial-random-variable">äºŒé¡¹éšæœºå˜é‡ï¼ˆBinomial Random Variableï¼‰</a></li>
        <li></li>
        <li><a href="#æŒ‡æ•°éšæœºå˜é‡exponential-random-variables">æŒ‡æ•°éšæœºå˜é‡ï¼ˆExponential Random Variablesï¼‰</a></li>
        <li><a href="#å‡ ä½•éšæœºå˜é‡geometric-random-variables">å‡ ä½•éšæœºå˜é‡ï¼ˆGeometric Random Variablesï¼‰</a></li>
        <li><a href="#æ­£æ€éšæœºå˜é‡normal-random-variables">æ­£æ€éšæœºå˜é‡ï¼ˆNormal Random Variablesï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#éšæœºå˜é‡çš„è®¡ç®—">éšæœºå˜é‡çš„è®¡ç®—</a>
      <ul>
        <li><a href="#éšæœºå˜é‡å˜æ¢random-variable-transformation">éšæœºå˜é‡å˜æ¢ï¼ˆRandom Variable Transformationï¼‰</a></li>
        <li><a href="#æœŸæœ›è¿ç®—ç¬¦mean-operator">æœŸæœ›è¿ç®—ç¬¦(Mean Operator)</a></li>
        <li><a href="#è¯¯å·®ä¼ æ’­æ³•åˆ™propagation-laws">è¯¯å·®ä¼ æ’­æ³•åˆ™ï¼ˆPropagation Lawsï¼‰</a></li>
        <li><a href="#æ ·æœ¬å‡å€¼ç®—å­sample-mean-operator">æ ·æœ¬å‡å€¼ç®—å­ï¼ˆSample mean operatorï¼‰</a></li>
      </ul>
    </li>
    <li><a href="#é‡‡æ ·æ–¹æ³•sample-methods">é‡‡æ ·æ–¹æ³•ï¼ˆSample Methodsï¼‰</a>
      <ul>
        <li><a href="#åå‡½æ•°æ³•inverse-transform-sampling">åå‡½æ•°æ³•ï¼ˆInverse Transform Samplingï¼‰</a></li>
        <li><a href="#é‡‡æ ·ç¦»æ•£åˆ†å¸ƒ">é‡‡æ ·ç¦»æ•£åˆ†å¸ƒ</a></li>
        <li><a href="#é‡‡æ ·è¿ç»­åˆ†å¸ƒ">é‡‡æ ·è¿ç»­åˆ†å¸ƒ</a></li>
      </ul>
    </li>
    <li><a href="#é™„å½•">é™„å½•</a>
      <ul>
        <li><a href="#ä»å·²çŸ¥äºŒç»´éšæœºå˜é‡-x-y-ä¸­é‡‡æ ·å…¶æåæ ‡å˜æ¢åçš„éšæœºå˜é‡">ä»å·²çŸ¥äºŒç»´éšæœºå˜é‡ (X, Y) ä¸­é‡‡æ ·å…¶æåæ ‡å˜æ¢åçš„éšæœºå˜é‡</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </aside>

<h1 id="éšæœºå˜é‡random-variables">éšæœºå˜é‡ï¼ˆRandom Variablesï¼‰</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®æ ·å¼</span>
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>set_theme(style<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;whitegrid&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_discrete_rv</span>(values, pmf, cdf, samples, rv_name):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å‡†å¤‡ç»éªŒ CDFï¼ˆECDFï¼‰</span>
</span></span><span style="display:flex;"><span>    n_samples <span style="color:#f92672">=</span> len(samples)
</span></span><span style="display:flex;"><span>    sorted_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sort(samples)
</span></span><span style="display:flex;"><span>    ecdf_x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>unique(sorted_samples)
</span></span><span style="display:flex;"><span>    ecdf_y <span style="color:#f92672">=</span> [np<span style="color:#f92672">.</span>sum(sorted_samples <span style="color:#f92672">&lt;=</span> x) <span style="color:#f92672">/</span> n_samples <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> ecdf_x]
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç†è®º PMF</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>stem(values, pmf, basefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34; &#34;</span>, linefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;-.&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Theoretical PMF: </span><span style="color:#e6db74">{</span>rv_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;f(X=x) = P(X = x)&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1.1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç†è®º CDF</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>step(values, cdf, where<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;post&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;green&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Theoretical CDF: </span><span style="color:#e6db74">{</span>rv_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;F(x) = P(X â‰¤ x)&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1.1</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># é‡‡æ ·ç›´æ–¹å›¾</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    sns<span style="color:#f92672">.</span>countplot(x<span style="color:#f92672">=</span>samples, hue<span style="color:#f92672">=</span>samples, legend<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pastel&#39;</span>, stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;proportion&#39;</span>, order<span style="color:#f92672">=</span>values)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical Distribution (</span><span style="color:#e6db74">{</span>n_samples<span style="color:#e6db74">}</span><span style="color:#e6db74"> samples)&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Relative Frequency&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç»éªŒ CDFï¼ˆECDFï¼‰</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>step(ecdf_x, ecdf_y, where<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;post&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Empirical CDF&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;ECDF&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1.1</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h2 id="å‡åŒ€åˆ†å¸ƒuniform-rv">å‡åŒ€åˆ†å¸ƒï¼ˆUniform RVï¼‰</h2>
<h3 id="ç¦»æ•£å‡åŒ€åˆ†å¸ƒdiscrete-uniform-random-variable">ç¦»æ•£å‡åŒ€åˆ†å¸ƒï¼ˆDiscrete Uniform Random Variableï¼‰</h3>
<blockquote>
<p>å¦‚æœä¸€ä¸ªéšæœºå˜é‡ $X$ åœ¨ä¸€ç»„<strong>æœ‰é™çš„ç¦»æ•£æ•°å€¼é›†åˆ</strong>ä¸­å–å€¼ï¼Œä¸”æ¯ä¸ªå€¼å‡ºç°çš„æ¦‚ç‡ç›¸åŒï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ª<strong>ç¦»æ•£å‹å‡åŒ€éšæœºå˜é‡</strong>ã€‚</p></blockquote>
<p>ç¤ºä¾‹ï¼š</p>
<ul>
<li>æ·ä¸€ä¸ªéª°å­ï¼š
$X \in \{1, 2, 3, 4, 5, 6\}$ï¼Œæ¯ä¸ªç‚¹çš„æ¦‚ç‡æ˜¯ $\frac{1}{6}$</li>
<li>éšæœºé€‰æ‹©ä¸€å¼ æ‰‘å…‹ç‰Œï¼ˆä» 1 åˆ° 52ï¼‰</li>
</ul>
<p><strong>æ•°å­¦å®šä¹‰</strong></p>
<p>è®¾ $X \sim \text{DiscreteUniform}(a, b)$ï¼Œå…¶ä¸­ $a$, $b \in \mathbb{Z}$ï¼Œä¸” $a \leq b$ã€‚</p>
<ul>
<li>
<p>æ”¯æŒé›†ï¼ˆå–å€¼èŒƒå›´ï¼Œå€¼åŸŸï¼‰æ˜¯ï¼š</p>
$$
  k \in \{a, a+1, a+2, \dots, b\}
  $$</li>
<li>
<p>æ¯ä¸ªå€¼çš„æ¦‚ç‡æ˜¯ï¼š</p>
$$
  P(X = k) = \frac{1}{b - a + 1}, \quad \text{for } k \in \{a, \dots, b\}
  $$</li>
<li>
<p>æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆPMFï¼‰ï¼š
</p>
$$
  f(X=k) = P(X=k) = \left\{
  \begin{aligned}
  \frac{1}{b-a+1}, \text{for } a \le k \le b\\
  0, \text{ otherwise}
  \end{aligned}
  \right.
  $$</li>
<li>
<p>ç´¯ç§¯åˆ†å¸ƒå‡½æ•°(CDF):
</p>
$$
  F(X=k) = P(X\le k) = \left\{
  \begin{aligned}
  0,  \text{for } k \lt a \\
  \frac{k-a+1}{b-a+1}, \text{for } a \le k \le b\\
  1, \text{ for } k \gt b
  \end{aligned}
  \right.
  $$</li>
<li>
<p>æœŸæœ›ï¼ˆ$\mu$ï¼‰ï¼š$\frac{a+b}{2}$</p>
</li>
<li>
<p>æ–¹å·®ï¼ˆ$\sigma^2$ï¼‰ï¼š$\frac{(b-a+1)^2-1}{12}$</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®éšæœºç§å­ä»¥ä¿è¯ç»“æœå¯é‡å¤</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. å®šä¹‰å‚æ•°</span>
</span></span><span style="display:flex;"><span>a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>  <span style="color:#75715e"># å‡åŒ€åˆ†å¸ƒçš„èŒƒå›´</span>
</span></span><span style="display:flex;"><span>values <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(a, b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># ç¦»æ•£å–å€¼ï¼š1~6</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> len(values)
</span></span><span style="display:flex;"><span>pmf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>ones(n) <span style="color:#f92672">/</span> n  <span style="color:#75715e"># æ¯ä¸ªå€¼çš„æ¦‚ç‡å‡ç­‰</span>
</span></span><span style="display:flex;"><span>cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(pmf)  <span style="color:#75715e"># ç´¯ç§¯åˆ†å¸ƒå‡½æ•°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. æŠ½æ ·</span>
</span></span><span style="display:flex;"><span>n_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>choice(values, size<span style="color:#f92672">=</span>n_samples, p<span style="color:#f92672">=</span>pmf)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. å¯è§†åŒ–ï¼šç†è®ºåˆ†å¸ƒ + é‡‡æ ·é¢‘ç‡å¯¹æ¯”</span>
</span></span><span style="display:flex;"><span>plot_discrete_rv(values, pmf, cdf, samples, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;DiscreteUniform(</span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_4_0.png" alt="png"></p>
<h4 id="é‡‡æ ·">é‡‡æ ·</h4>
<p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª<strong>è¿ç»­å‡åŒ€åˆ†å¸ƒ $U \sim \text{Uniform}(0, 1)$</strong> æ¥ç”Ÿæˆç¦»æ•£å‡åŒ€éšæœºæ•°ã€‚</p>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li>
<p>è®¾åŒºé—´ä¸ºæ•´æ•° $a$ åˆ° $b$ï¼ˆå«ç«¯ç‚¹ï¼‰ï¼Œæ€»å…±æœ‰ $N = b - a + 1$ ä¸ªæ•°</p>
</li>
<li>
<p>ç”Ÿæˆä¸€ä¸ªéšæœºæ•° $U \sim \text{Uniform}(0, 1)$</p>
</li>
<li>
<p>å°† $U$ æ˜ å°„åˆ°æ•´æ•°èŒƒå›´å†…ï¼š</p>
$$
   X = a + \left\lfloor U \cdot N \right\rfloor
   $$<p>âœ… è¿™æ ·å¾—åˆ°çš„æ•´æ•°å°±æ˜¯ $\{a, a+1, ..., b\}$ ä¸­çš„ä¸€ä¸ªï¼Œä¸”ç­‰æ¦‚ç‡</p>
</li>
</ol>
<p>å¦‚æœ $a=0, b=1$ï¼Œåˆ™ï¼š</p>
<ol>
<li>$N = b - a + 1 = 1 - 0 + 1 = 2$</li>
<li>$U \sim \text{Uniform}(0, 1)$</li>
<li>$X = a + \left\lfloor U \cdot N \right\rfloor = 0 + \left\lfloor U \cdot 2 \right\rfloor = \left\lfloor U \cdot 2 \right\rfloor$</li>
</ol>
<p><strong>æ€»ç»“ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>æ­¥éª¤</th>
          <th>æè¿°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ç›®æ ‡</td>
          <td>ä» $\{a, a+1, ..., b\}$ ä¸­ç­‰æ¦‚ç‡é‡‡æ ·</td>
      </tr>
      <tr>
          <td>æ–¹æ³•</td>
          <td>ç”Ÿæˆ $U \sim \text{Uniform}(0,1)$ï¼Œç„¶å $X = a + \lfloor U \cdot (b - a + 1) \rfloor$</td>
      </tr>
      <tr>
          <td>å·¥å…·å‡½æ•°</td>
          <td><code>random.random()</code> or <code>random.randint(a, b)</code></td>
      </tr>
      <tr>
          <td>åº”ç”¨</td>
          <td>æ¨¡æ‹Ÿéª°å­ã€è½®ç›˜ã€æŠ½ç­¾ã€å‡åŒ€æ•´æ•°é‡‡æ ·ç­‰</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">discrete_uniform_sample</span>(a, b, n):
</span></span><span style="display:flex;"><span>    N <span style="color:#f92672">=</span> b <span style="color:#f92672">-</span> a <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># U ~ Uniform(0, 1)</span>
</span></span><span style="display:flex;"><span>    U <span style="color:#f92672">=</span> [random<span style="color:#f92672">.</span>random() <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n)] <span style="color:#75715e"># random.random() è¿”å›åŒºé—´ [0.0, 1.0) çš„æµ®ç‚¹æ•°</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># X ~ Discrete Uniform(a, b)</span>
</span></span><span style="display:flex;"><span>    X <span style="color:#f92672">=</span> [a<span style="color:#f92672">+</span>int(u<span style="color:#f92672">*</span>N) <span style="color:#66d9ef">for</span> u <span style="color:#f92672">in</span> U]  <span style="color:#75715e"># When u = 0.999, u*N = 0.999 * N, which is close to N-1, so a + int(u*N) will be b.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> U, X
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>discrete_uniform_sample(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>)
</span></span></code></pre></div><pre><code>([0.4444854289944321,
  0.951251619861675,
  0.7646892516581814,
  0.9854176841589392,
  0.0983350059391166,
  0.5245935455925463,
  0.962496892423623,
  0.7602027193895072,
  0.3724452123714195,
  0.8460390235179297],
 [0, 1, 1, 1, 0, 1, 1, 1, 0, 1])
</code></pre>
<h5 id="æ›´ç®€æ´æ–¹å¼å†…ç½®å‡½æ•°">æ›´ç®€æ´æ–¹å¼ï¼ˆå†…ç½®å‡½æ•°ï¼‰</h5>
<p>å½“ç„¶ï¼ŒPython ä¹Ÿæä¾›äº†ç›´æ¥é‡‡æ ·çš„æ–¹æ³•ï¼š<code>random.randint(a, b)  # åŒ…å« a å’Œ b</code></p>
<p>å®ƒå®ç°çš„å°±æ˜¯ä¸Šé¢çš„åŸç†ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>)]  <span style="color:#75715e"># ä½¿ç”¨å†…ç½®å‡½æ•°ç›´æ¥é‡‡æ ·ï¼ŒéªŒè¯ç»“æœæ˜¯å¦æ­£ç¡®</span>
</span></span></code></pre></div><pre><code>[0, 1, 1, 0, 0, 1, 0, 0, 0, 0]
</code></pre>
<h5 id="éªŒè¯é‡‡æ ·ç»“æœ">éªŒè¯é‡‡æ ·ç»“æœ</h5>
<p>æˆ‘ä»¬é‡‡æ · 10,000 æ¬¡ï¼Œçœ‹çœ‹åˆ†å¸ƒæ˜¯å¦å‡åŒ€ã€‚</p>
<p>ä½ ä¼šçœ‹åˆ° 1 åˆ° 6 ä¹‹é—´çš„æŸ±çŠ¶å›¾é«˜åº¦å¤§è‡´ç›¸ç­‰ï¼Œè¿™è¯´æ˜æˆ‘ä»¬æ­£ç¡®é‡‡æ ·ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> comb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>a, b, N <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">30000</span>
</span></span><span style="display:flex;"><span>origin_samples, samples <span style="color:#f92672">=</span> discrete_uniform_sample(a, b, N)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical mean: </span><span style="color:#e6db74">{</span>sum(samples)<span style="color:#f92672">/</span>len(samples)<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç»Ÿè®¡é¢‘ç‡</span>
</span></span><span style="display:flex;"><span>counts <span style="color:#f92672">=</span> [samples<span style="color:#f92672">.</span>count(k) <span style="color:#f92672">/</span> N <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(a, b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¡ç®—ç†è®ºæ¦‚ç‡ï¼ˆPMFï¼‰</span>
</span></span><span style="display:flex;"><span>theoretical <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>(b<span style="color:#f92672">-</span>a<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(a, b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;PMF = </span><span style="color:#e6db74">{</span>theoretical<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Step 5: å¯è§†åŒ–</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>bar(range(a, b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), counts, width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled Frequency&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>bar(range(a, b<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), theoretical, width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Theoretical PMF&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;edge&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Value&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Probability&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Discrete Uniform Sample (</span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">~</span><span style="color:#e6db74">{</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><pre><code>Empirical mean: 5.515
PMF = [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_10_1.png" alt="png"></p>
<h3 id="è¿ç»­å‡åŒ€åˆ†å¸ƒcontinuous-uniform-random-variable">è¿ç»­å‡åŒ€åˆ†å¸ƒï¼ˆContinuous Uniform Random Variableï¼‰</h3>
<p><strong>ä»€ä¹ˆæ˜¯è¿ç»­å‹å‡åŒ€åˆ†å¸ƒï¼Ÿ</strong></p>
<blockquote>
<p>ä¸€ä¸ªéšæœºå˜é‡ $X \sim \text{Uniform}(a, b)$ï¼Œå¦‚æœå®ƒåœ¨åŒºé—´ $[a, b]$ ä¸Šçš„æ¯ä¸€ä¸ªå€¼éƒ½ç­‰å¯èƒ½åœ°å‡ºç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°å®ƒæœä»<strong>è¿ç»­å‡åŒ€åˆ†å¸ƒ</strong>ã€‚</p></blockquote>
<p><strong>æ•°å­¦å®šä¹‰</strong></p>
<ul>
<li>
<p>æ”¯æŒé›†ï¼ˆå–å€¼èŒƒå›´ï¼‰ï¼š$X \in [a, b]$</p>
</li>
<li>
<p>æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆPDFï¼‰ï¼š</p>
$$
  f_X(x) = \begin{cases}
  \frac{1}{b - a} & \text{if } x \in [a, b] \\
  0 & \text{otherwise}
  \end{cases}
  $$</li>
<li>
<p>ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰ï¼š</p>
$$
  F_X(x) = \begin{cases}
  0 & \text{if } x < a \\
  \frac{x - a}{b - a} & \text{if } a \leq x \leq b \\
  1 & \text{if } x > b
  \end{cases}
  $$</li>
<li>
<p>æœŸæœ›ï¼ˆ$\mu$ï¼‰ï¼š$\frac{a+b}{2}$</p>
</li>
<li>
<p>æ–¹å·®ï¼ˆ$\sigma^2$ï¼‰ï¼š$\frac{(b-a)^2}{12}$</p>
</li>
</ul>
<p><strong>å‚è€ƒï¼š</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Continuous_uniform_distribution">Wiki: Continuous uniform distribution</a></li>
</ul>
<h4 id="é‡‡æ ·-1">é‡‡æ ·</h4>
<p><strong>é‡‡æ ·åŸç†ï¼ˆInverse Transform Samplingï¼‰</strong></p>
<p>æœ€ç®€å•æœ‰æ•ˆçš„æ–¹æ³•æ˜¯ï¼š</p>
<blockquote>
<p>å¦‚æœ $U \sim \text{Uniform}(0,1)$ï¼Œé‚£ä¹ˆ</p>
$$
> X = a + (b - a) \cdot U \sim \text{Uniform}(a, b)
> $$</blockquote>
<p><em>ğŸ’¡ä¸ºä»€ä¹ˆæˆç«‹ï¼Ÿ</em></p>
<p>å› ä¸ºï¼š</p>
<ol>
<li>$U \in [0, 1]$ï¼Œæ˜¯æ ‡å‡†å‡åŒ€åˆ†å¸ƒ</li>
<li>ç¼©æ”¾åŒºé—´é•¿åº¦ä¸º $(b - a)$ï¼Œå†åŠ ä¸Š $a$ ç›¸å½“äºâ€œçº¿æ€§æ˜ å°„â€</li>
<li>å˜æ¢åçš„éšæœºå˜é‡ $X$ åœ¨ $[a, b]$ ä¸Šä¹Ÿå‡åŒ€åˆ†å¸ƒ</li>
</ol>
<p><strong>é‡‡æ ·æ­¥éª¤ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Step 1ï¼šç”Ÿæˆä¸€ä¸ª U ~ Uniform(0, 1)
</span></span><span style="display:flex;"><span>Step 2ï¼šé€šè¿‡çº¿æ€§å˜æ¢ X = a + (b - a) * U
</span></span><span style="display:flex;"><span>Step 3ï¼šX å°±æ˜¯ä½ è¦çš„ sample from Uniform(a, b)
</span></span></code></pre></div><p><strong>æ€»ç»“è¡¨æ ¼</strong></p>
<table>
  <thead>
      <tr>
          <th>é¡¹ç›®</th>
          <th>å†…å®¹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>åˆ†å¸ƒåç§°</td>
          <td>è¿ç»­å‡åŒ€åˆ†å¸ƒ Uniform(a, b)</td>
      </tr>
      <tr>
          <td>PDF</td>
          <td>$f(x) = \frac{1}{b - a}$</td>
      </tr>
      <tr>
          <td>é‡‡æ ·æ–¹æ³•</td>
          <td>$X = a + (b - a) \cdot U$ï¼Œå…¶ä¸­ $U \sim \text{Uniform}(0,1)$</td>
      </tr>
      <tr>
          <td>Pythonå‡½æ•°</td>
          <td><code>random.random()</code> æˆ– <code>random.uniform(a, b)</code></td>
      </tr>
      <tr>
          <td>åº”ç”¨åœºæ™¯</td>
          <td>è’™ç‰¹å¡æ´›æ–¹æ³•ã€æ¨¡æ‹Ÿå®éªŒã€éšæœºåˆå§‹åŒ–ç­‰</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_uniform</span>(a, b):
</span></span><span style="display:flex;"><span>    U <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random()        <span style="color:#75715e"># U ~ Uniform(0,1)</span>
</span></span><span style="display:flex;"><span>    X <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> (b <span style="color:#f92672">-</span> a) <span style="color:#f92672">*</span> U        <span style="color:#75715e"># X ~ Uniform(a, b)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> X
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_uniform_list</span>(a, b, n):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [sample_uniform(a, b) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n)]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sample_uniform_list(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>)
</span></span></code></pre></div><pre><code>[0.6400024988096578,
 0.05979675338996093,
 0.5161926269415474,
 0.4823864030690008,
 0.31338893853775884,
 0.4885049387562129,
 0.7751242044584421,
 0.03653104468277457,
 0.1006986841203773,
 0.05647975387925808]
</code></pre>
<h5 id="ç›´æ¥ç”¨å†…ç½®å‡½æ•°-uniforma-b">ç›´æ¥ç”¨å†…ç½®å‡½æ•° <code>uniform(a, b)</code></h5>
<p>è¿™æ˜¯æ ‡å‡†åº“å°è£…å¥½çš„å½¢å¼ï¼Œå†…éƒ¨å®ç°å…¶å®ä¹Ÿæ˜¯ <code>a + (b - a) * random.random()</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><pre><code>0.8338807889744516
</code></pre>
<h5 id="éªŒè¯é‡‡æ ·æ•ˆæœ">éªŒè¯é‡‡æ ·æ•ˆæœ</h5>
<p>åŸç†ï¼š<strong>æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—é‡‡æ ·ç»“æœçš„ç›´æ–¹å›¾ï¼Œæ¥éªŒè¯é‡‡æ ·æ•°æ®æ˜¯å¦ä¸æ¨¡å‹ä¸€è‡´ã€‚</strong></p>
<p>æˆ‘ä»¬é‡‡æ · 10,000 ä¸ª $X \sim \text{Uniform}(2, 5)$ï¼Œç”»å‡ºç›´æ–¹å›¾çœ‹çœ‹åˆ†å¸ƒæ˜¯å¦å‡åŒ€ï¼š</p>
<p>âœ… å¦‚æœçœ‹åˆ°ç›´æ–¹å›¾éå¸¸æ¥è¿‘å¹³çš„ï¼Œè¯´æ˜åˆ†å¸ƒæ˜¯å‡åŒ€çš„ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a, b, n <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>pdf <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> (b <span style="color:#f92672">-</span> a)  <span style="color:#75715e"># å‡åŒ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_uniform_list(a, b, n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·ç»“æœ</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(range(n), samples, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Sample results from Uniform(</span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;n&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Sample Value (X)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1.1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·ç›´æ–¹å›¾ï¼ˆé¢‘ç‡ï¼‰</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span>N, density<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Histogram of Sample from Uniform(</span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Sample Value (X)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Absolute Frequency&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·ç›´æ–¹å›¾ï¼ˆç›¸å¯¹é¢‘ç‡ï¼‰</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span>N, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hlines(pdf, a, b, colors<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linestyles<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;solid&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;PDF&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Histogram of Sample from Uniform(</span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Sample Value (X)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;h = Relative Frequency * N (N=</span><span style="color:#e6db74">{</span>N<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_18_0.png" alt="png"></p>
<h2 id="ä¼¯åŠªåˆ©éšæœºå˜é‡bernouli-rv">ä¼¯åŠªåˆ©éšæœºå˜é‡ï¼ˆBernouli RVï¼‰</h2>
<p>åˆç§°<strong>ä¸¤ç‚¹åˆ†å¸ƒ</strong>æˆ–è€…<strong>0-1åˆ†å¸ƒ</strong>ã€‚<strong>ç¦»æ•£</strong>å‹éšæœºå˜é‡ã€‚</p>
<p><strong>æ•°å­¦å®šä¹‰</strong></p>
<p>è®¾ $X \sim \text{Bernouli}(p)$ï¼Œå…¶ä¸­ $0 \le p \le 1$ã€‚</p>
<ul>
<li>
<p>æ”¯æŒé›†ï¼ˆå–å€¼èŒƒå›´ï¼Œå€¼åŸŸï¼‰æ˜¯ï¼š</p>
$$
  k \in \{0, 1\}
  $$</li>
<li>
<p>æ¯ä¸ªå€¼çš„æ¦‚ç‡æ˜¯ï¼š</p>
$$
  P(X = 1) = p \\
  P(X = 0) = 1 - p
  $$</li>
<li>
<p>æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆPMFï¼‰ï¼š
</p>
$$
  f(X=k) = P(X=k) = \left\{
  \begin{aligned}
  p, \text{if } k=1\\
  1-p, \text{if } k=0
  \end{aligned}
  \right.
  $$</li>
<li>
<p>ç´¯ç§¯åˆ†å¸ƒå‡½æ•°(CDF):
</p>
$$
  F(X=k) = P(X\le k) = \left\{
  \begin{aligned}
  0,  \text{if } k \lt 0 \\
  1-p, \text{if } 0 \le k \lt 1\\
  1, \text{ for } k \ge 1
  \end{aligned}
  \right.
  $$</li>
<li>
<p>æœŸæœ›ï¼ˆ$\mu$ï¼‰ï¼š$p$</p>
</li>
<li>
<p>æ–¹å·®ï¼ˆ$\sigma^2$ï¼‰ï¼š$p(1-p)$</p>
</li>
</ul>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Bernoulli_distribution">ç»´åŸºç™¾ç§‘ï¼šä¼¯åŠªåˆ©åˆ†å¸ƒ</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®éšæœºç§å­ä»¥ä¿è¯ç»“æœå¯é‡å¤</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. å®šä¹‰å‚æ•°</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>
</span></span><span style="display:flex;"><span>values <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>])  <span style="color:#75715e"># ç¦»æ•£å–å€¼ï¼š1~6</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> len(values)
</span></span><span style="display:flex;"><span>pmf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>p, p])
</span></span><span style="display:flex;"><span>cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(pmf)  <span style="color:#75715e"># ç´¯ç§¯åˆ†å¸ƒå‡½æ•°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. æŠ½æ ·</span>
</span></span><span style="display:flex;"><span>n_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>binomial(n<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, p<span style="color:#f92672">=</span>p) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n_samples)])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. å¯è§†åŒ–ï¼šç†è®ºåˆ†å¸ƒ + é‡‡æ ·é¢‘ç‡å¯¹æ¯”</span>
</span></span><span style="display:flex;"><span>plot_discrete_rv(values, pmf, cdf, samples, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Bernoulli(p=</span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_20_0.png" alt="png"></p>
<h3 id="ä¼¯åŠªåˆ©å®šç†bernouli-theorm">ä¼¯åŠªåˆ©å®šç†ï¼ˆBernouli Theormï¼‰</h3>
<p>ä¼¯åŠªåˆ©å®šç†ï¼š æè¿°äº†æ¦‚ç‡ä¸é¢‘ç‡ä¹‹é—´çš„å…³ç³»ï¼Œå½“é‡å¤æ¬¡æ•°å¢åŠ æ—¶ï¼Œäº‹ä»¶çš„ç›¸å¯¹é¢‘ç‡ä¼šè¶‹è¿‘äºå…¶æ¦‚ç‡ã€‚</p>
<p>è®¾ $X_1, X_2, ..., X_n$ æ˜¯ $n$ æ¬¡ç‹¬ç«‹åŒåˆ†å¸ƒçš„ä¼¯åŠªåˆ©éšæœºå˜é‡ï¼ˆå³ $X_i \sim \text{Bernoulli}(p)$ï¼‰ï¼Œä»¤</p>
$$
\bar{X}_n = \frac{1}{n} \sum_{i=1}^n X_i
$$<p>å³æˆåŠŸçš„ç›¸å¯¹é¢‘ç‡ã€‚</p>
<p>é‚£ä¹ˆï¼Œä¼¯åŠªåˆ©å®šç†å‘Šè¯‰æˆ‘ä»¬ï¼š</p>
$$
\lim_{n \to \infty} \mathbb{P}\left( \left| \bar{X}_n - p \right| > \epsilon \right) = 0 \quad \text{å¯¹ä»»æ„ } \epsilon > 0
$$<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¼¯åŠªåˆ©å®šç†æ¥éªŒè¯æ¨¡æ‹Ÿé‡‡æ ·çš„æ­£ç¡®æ€§ï¼š</p>
<ol>
<li>è®¡ç®—æ¯ä¸ªäº‹ä»¶çš„çš„å®é™…é¢‘ç‡ $f_{a_i}$</li>
<li>è®¡ç®—æ¯ä¸ªäº‹ä»¶çš„ç›¸å¯¹é¢‘ç‡ $f_i = \frac{f_{a_i}}{N}$</li>
<li>å°†æ¯ä¸ªäº‹ä»¶çš„ç›¸å¯¹é¢‘ç‡ $f_i$ ä¸æ¦‚ç‡ $p$ è¿›è¡Œå¯¹æ¯”ã€‚æ ¹æ®ä¼¯åŠªåˆ©å®šç†ï¼Œå½“ $N$ å˜å¤§æ—¶ï¼Œ$f_i$ ä¼šé€¼è¿‘ $p$</li>
</ol>
<p><strong>å‚è€ƒï¼š</strong></p>
<ul>
<li><a href="https://proofwiki.org/wiki/Bernoulli%27s_Theorem">ProofWiki: Bernoulli&rsquo;s principle</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib.animation <span style="color:#f92672">import</span> FuncAnimation
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> HTML
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å‚æ•°è®¾ç½®</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>                <span style="color:#75715e"># æˆåŠŸæ¦‚ç‡</span>
</span></span><span style="display:flex;"><span>n_trials <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>        <span style="color:#75715e"># æ€»å®éªŒæ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>interval <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>          <span style="color:#75715e"># åŠ¨ç”»é—´éš”æ—¶é—´ï¼ˆmsï¼‰</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆä¼¯åŠªåˆ©å®éªŒæ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>binomial(n<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, p<span style="color:#f92672">=</span>p, size<span style="color:#f92672">=</span>n_trials)
</span></span><span style="display:flex;"><span>cumulative_freq <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(samples) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, n_trials <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºå›¾å½¢</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#ae81ff">1</span>, n_trials)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>axhline(y<span style="color:#f92672">=</span>p, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;True Probability p = </span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>line, <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>plot([], [], lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Empirical Frequency&#39;</span>)
</span></span><span style="display:flex;"><span>text <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>text(<span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">0.9</span>, <span style="color:#e6db74">&#39;&#39;</span>, transform<span style="color:#f92672">=</span>ax<span style="color:#f92672">.</span>transAxes)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Number of Trials&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Success Frequency&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Bernoulli Theorem Animation&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ¨ç”»æ›´æ–°å‡½æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update</span>(frame):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, frame <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> cumulative_freq[:frame]
</span></span><span style="display:flex;"><span>    line<span style="color:#f92672">.</span>set_data(x, y)
</span></span><span style="display:flex;"><span>    text<span style="color:#f92672">.</span>set_text(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;n = </span><span style="color:#e6db74">{</span>frame<span style="color:#e6db74">}</span><span style="color:#e6db74">, freq = </span><span style="color:#e6db74">{</span>y[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> line, text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºåŠ¨ç”»</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -----------------------------</span>
</span></span><span style="display:flex;"><span>ani <span style="color:#f92672">=</span> FuncAnimation(fig, update, frames<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, n_trials <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>),
</span></span><span style="display:flex;"><span>                    interval<span style="color:#f92672">=</span>interval, blit<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Save as GIF</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib.animation <span style="color:#f92672">import</span> PillowWriter
</span></span><span style="display:flex;"><span>ani<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#34;bernoulli_theorem_animation.gif&#34;</span>, writer<span style="color:#f92672">=</span>PillowWriter(fps<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>close(fig)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span>Image(filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bernoulli_theorem_animation.gif&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#plt.close()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åœ¨ notebook ä¸­æ˜¾ç¤ºåŠ¨ç”»</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#HTML(ani.to_jshtml())</span>
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/bernoulli_theorem_animation.gif" alt="png"></p>
<h3 id="é‡‡æ ·-2">é‡‡æ ·</h3>
<h4 id="åŸºäºå‡åŒ€åˆ†å¸ƒ-uniform0-1">åŸºäºå‡åŒ€åˆ†å¸ƒ Uniform(0, 1)</h4>
<p><strong>ğŸŒ± åŸç†</strong></p>
<p>åˆ©ç”¨ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒ $U \sim \text{Uniform}(0,1)$ æ¥å®ç°ï¼š</p>
<ul>
<li>å¦‚æœ $U < p$ï¼Œè¾“å‡º 1ï¼ˆæˆåŠŸï¼‰</li>
<li>å¦åˆ™è¾“å‡º 0ï¼ˆå¤±è´¥ï¼‰</li>
</ul>
<p>è¿™æ˜¯å› ä¸º Uniform(0,1) åœ¨åŒºé—´å†…æ˜¯å‡åŒ€çš„ï¼Œæ‰€ä»¥æ¦‚ç‡å°äº $p$ çš„é‚£ä¸€æ®µæ°å¥½å°±æ˜¯ â€œæˆåŠŸâ€çš„æ¦‚ç‡ã€‚</p>
<p>ğŸ¬ åŠ¨ç”»è¯´æ˜ï¼š
å·¦å›¾ï¼šSampling from Uniform(0,1)</p>
<ul>
<li>æ¯ä¸€å¸§ï¼Œç”Ÿæˆä¸€ä¸ª $Uâˆ¼Uniform(0,1)$ çš„æ ·æœ¬ï¼›</li>
<li>è“è‰²ç‚¹æŒ‰éšæœºé«˜åº¦æ˜¾ç¤ºé‡‡æ ·å€¼ï¼›</li>
<li>çº¢è‰²è™šçº¿è¡¨ç¤ºé˜ˆå€¼ $p=0.3$ï¼Œå³ï¼š
<ul>
<li>$U<p$ â‡’ ä¼¯åŠªåˆ©å€¼ä¸º 1ï¼›</li>
<li>$Uâ‰¥p$ â‡’ ä¼¯åŠªåˆ©å€¼ä¸º 0ã€‚</li>
</ul>
</li>
</ul>
<p>å³å›¾ï¼šBernoulli Sample Counts</p>
<ul>
<li>å®æ—¶æ›´æ–° 0 å’Œ 1 çš„å‡ºç°æ¬¡æ•°æŸ±çŠ¶å›¾ï¼›</li>
<li>æœ€ç»ˆï¼Œ1 çš„æ•°é‡çº¦ä¸º 30%ï¼Œç¬¦åˆæ¦‚ç‡ $p=0.3$ï¼›</li>
<li>0 çš„æ•°é‡çº¦ä¸º 70%ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.animation <span style="color:#66d9ef">as</span> animation
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> HTML
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Parameters</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>n_frames <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Pre-generate uniform samples</span>
</span></span><span style="display:flex;"><span>uniform_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, n_frames)
</span></span><span style="display:flex;"><span>bernoulli_samples <span style="color:#f92672">=</span> (uniform_samples <span style="color:#f92672">&lt;</span> p)<span style="color:#f92672">.</span>astype(int)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set up the figure and axes</span>
</span></span><span style="display:flex;"><span>fig, axs <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>uniform_ax <span style="color:#f92672">=</span> axs[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>bernoulli_ax <span style="color:#f92672">=</span> axs[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize plots</span>
</span></span><span style="display:flex;"><span>uniform_scatter <span style="color:#f92672">=</span> uniform_ax<span style="color:#f92672">.</span>scatter([], [], c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>)
</span></span><span style="display:flex;"><span>bernoulli_bar <span style="color:#f92672">=</span> bernoulli_ax<span style="color:#f92672">.</span>bar([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Configure uniform axis</span>
</span></span><span style="display:flex;"><span>uniform_ax<span style="color:#f92672">.</span>axvline(p, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;p = </span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>uniform_ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>uniform_ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>uniform_ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Sampling from Uniform(0,1)&#39;</span>)
</span></span><span style="display:flex;"><span>uniform_ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Value&#39;</span>)
</span></span><span style="display:flex;"><span>uniform_ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Random Height&#39;</span>)
</span></span><span style="display:flex;"><span>uniform_ax<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>uniform_ax<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Configure Bernoulli axis</span>
</span></span><span style="display:flex;"><span>bernoulli_ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">1.5</span>)
</span></span><span style="display:flex;"><span>bernoulli_ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#ae81ff">0</span>, n_frames)
</span></span><span style="display:flex;"><span>bernoulli_ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Bernoulli Sample Counts&#39;</span>)
</span></span><span style="display:flex;"><span>bernoulli_ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Value&#39;</span>)
</span></span><span style="display:flex;"><span>bernoulli_ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Count&#39;</span>)
</span></span><span style="display:flex;"><span>bernoulli_ax<span style="color:#f92672">.</span>set_xticks([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>bernoulli_ax<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Store sample counts</span>
</span></span><span style="display:flex;"><span>count_0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>count_1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>y_vals <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Animation update function</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update</span>(frame):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> count_0, count_1, x_vals, y_vals
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    u <span style="color:#f92672">=</span> uniform_samples[frame]
</span></span><span style="display:flex;"><span>    x_vals<span style="color:#f92672">.</span>append(u)
</span></span><span style="display:flex;"><span>    y_vals<span style="color:#f92672">.</span>append(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand())  <span style="color:#75715e"># random y position for scatter</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    bern_sample <span style="color:#f92672">=</span> bernoulli_samples[frame]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> bern_sample <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        count_0 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        count_1 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Update scatter</span>
</span></span><span style="display:flex;"><span>    uniform_scatter<span style="color:#f92672">.</span>set_offsets(np<span style="color:#f92672">.</span>column_stack((x_vals, y_vals)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Update bar chart</span>
</span></span><span style="display:flex;"><span>    bernoulli_bar[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_height(count_0)
</span></span><span style="display:flex;"><span>    bernoulli_bar[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_height(count_1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> uniform_scatter, bernoulli_bar
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create animation</span>
</span></span><span style="display:flex;"><span>ani <span style="color:#f92672">=</span> animation<span style="color:#f92672">.</span>FuncAnimation(fig, update, frames<span style="color:#f92672">=</span>n_frames, interval<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, blit<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¿å­˜ä¸º GIF</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib.animation <span style="color:#f92672">import</span> PillowWriter
</span></span><span style="display:flex;"><span>ani<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#34;sample_uniform_to_bernoulli.gif&#34;</span>, writer<span style="color:#f92672">=</span>PillowWriter(fps<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>close(fig)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span>Image(filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sample_uniform_to_bernoulli.gif&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#plt.close()</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åœ¨ notebook ä¸­æ˜¾ç¤ºåŠ¨ç”»</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#HTML(ani.to_jshtml())</span>
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/sample_uniform_to_bernoulli.gif" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_bernoulli</span>(p):
</span></span><span style="display:flex;"><span>    U <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random() <span style="color:#75715e"># U ~ Uniform(0, 1)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> U <span style="color:#f92672">&lt;</span> p <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sample_bernoulli(<span style="color:#ae81ff">0.7</span>)
</span></span></code></pre></div><pre><code>1
</code></pre>
<h5 id="éªŒè¯">éªŒè¯</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p, N <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>, <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> [sample_bernoulli(p) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical mean: </span><span style="color:#e6db74">{</span>sum(samples)<span style="color:#f92672">/</span>len(samples)<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)  <span style="color:#75715e"># åº”è¯¥æ¥è¿‘ 0.7</span>
</span></span></code></pre></div><pre><code>Empirical mean: 0.703
</code></pre>
<h4 id="ä½¿ç”¨-numpy">ä½¿ç”¨ <code>numpy</code></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>binomial(n<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, p<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>)
</span></span></code></pre></div><pre><code>1
</code></pre>
<h5 id="éªŒè¯-1">éªŒè¯</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p, N <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.7</span>, <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> [np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>binomial(n<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, p<span style="color:#f92672">=</span>p) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical mean: </span><span style="color:#e6db74">{</span>sum(samples)<span style="color:#f92672">/</span>len(samples)<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)  <span style="color:#75715e"># åº”è¯¥æ¥è¿‘ 0.7</span>
</span></span></code></pre></div><pre><code>Empirical mean: 0.702
</code></pre>
<h2 id="äºŒé¡¹éšæœºå˜é‡binomial-random-variable">äºŒé¡¹éšæœºå˜é‡ï¼ˆBinomial Random Variableï¼‰</h2>
<p>ä¸€ä¸ªéšæœºå˜é‡ $Xâˆ¼Binomial(n,p)$ï¼Œè¡¨ç¤ºåœ¨<strong>é‡å¤</strong>è¿›è¡Œ $n$ æ¬¡<strong>ç‹¬ç«‹</strong>çš„ä¼¯åŠªåˆ©è¯•éªŒï¼ˆæ¯æ¬¡æˆåŠŸæ¦‚ç‡ä¸º $p$ï¼‰ä¸­ï¼ŒæˆåŠŸï¼ˆè®°ä¸º1ï¼‰å‘ç”Ÿçš„<strong>æ€»æ¬¡æ•°</strong>ã€‚$X$ æ˜¯ç¦»æ•£éšæœºå˜é‡ã€‚</p>
<p><strong>æ•°å­¦å®šä¹‰</strong></p>
<p>è®¾ $X \sim \text{Binomial}(n, p)$ï¼ˆæˆ–è€…æ˜¯ $X \sim B(n,p)$ï¼‰ï¼Œå…¶ä¸­ $n \gt 0, 0 \le p \le 1$ã€‚</p>
<ul>
<li>
<p>æ”¯æŒé›†ï¼ˆå–å€¼èŒƒå›´ï¼Œå€¼åŸŸï¼‰æ˜¯ï¼š</p>
$$
  k \in \{0, \dots, n\}
  $$<ul>
<li>è¡¨ç¤ºæˆåŠŸçš„æ¬¡æ•°</li>
</ul>
</li>
<li>
<p>æ¯ä¸ªå€¼çš„æ¦‚ç‡æ˜¯ï¼š</p>
<h2>$$
  P(X = 0) = (1-p)^n\\
  \dots \\
  P(X = k) = \begin{pmatrix} n \\ k \end{pmatrix}p^k(1-p)^{(n-k)} \\
  \dots \\
  P(X = n) = p^n
  $$</h2>
</li>
<li>
<p>æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆPMFï¼‰ï¼š
</p>
$$
  f(X=k) = P(X=k) = \begin{pmatrix} n \\ k \end{pmatrix}p^k(1-p)^{(n-k)} \\
  å…¶ä¸­ï¼Œ\begin{pmatrix} n \\ k \end{pmatrix} = \frac{n!}{k!(n-k)!}
  $$</li>
<li>
<p>ç´¯ç§¯åˆ†å¸ƒå‡½æ•°(CDF):
</p>
$$
  F(X=k) = P(X\le k) = \sum _{i=0}^{\lfloor k\rfloor }{n \choose i}p^{i}(1-p)^{n-i}
  $$<ul>
<li>where $\lfloor k\rfloor$ is the &ldquo;floor&rdquo; under k, i.e. the greatest integer less than or equal to k.</li>
</ul>
</li>
<li>
<p>æœŸæœ›ï¼ˆ$\mu$ï¼‰ï¼š$np$</p>
<ul>
<li>If $X_{1},\ldots ,X_{n}$ are identical (and independent) Bernoulli random variables with parameter $p$, then $X = X_1 + \dots + X_n$ and $\operatorname {E} [X]=\operatorname {E} [X_{1}+\cdots +X_{n}]=\operatorname {E} [X_{1}]+\cdots +\operatorname {E} [X_{n}]=p+\cdots +p=np.$</li>
</ul>
</li>
<li>
<p>æ–¹å·®ï¼ˆ$\sigma^2$ï¼‰ï¼š$np(1-p)$</p>
<ul>
<li>the variance of a sum of independent random variables = the sum of the variances</li>
</ul>
</li>
</ul>
<p><strong>å‚è€ƒï¼š</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Binomial_distribution">Wiki: Binomial distribution</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> binom
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®éšæœºç§å­ä»¥ä¿è¯ç»“æœå¯é‡å¤</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. å®šä¹‰å‚æ•°</span>
</span></span><span style="display:flex;"><span>n, p <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0.3</span> <span style="color:#75715e"># X ï½ Binomial(n, p)</span>
</span></span><span style="display:flex;"><span>values <span style="color:#f92672">=</span> range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># ç¦»æ•£å–å€¼ï¼š0, 1, ..., n</span>
</span></span><span style="display:flex;"><span>pmf <span style="color:#f92672">=</span> binom<span style="color:#f92672">.</span>pmf(values, n, p)
</span></span><span style="display:flex;"><span>cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(pmf)  <span style="color:#75715e"># ç´¯ç§¯åˆ†å¸ƒå‡½æ•°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. æŠ½æ ·</span>
</span></span><span style="display:flex;"><span>n_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>binomial(n<span style="color:#f92672">=</span>n, p<span style="color:#f92672">=</span>p, size<span style="color:#f92672">=</span>n_samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. å¯è§†åŒ–ï¼šç†è®ºåˆ†å¸ƒ + é‡‡æ ·é¢‘ç‡å¯¹æ¯”</span>
</span></span><span style="display:flex;"><span>plot_discrete_rv(values, pmf, cdf, samples, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Binomial(n=</span><span style="color:#e6db74">{</span>n<span style="color:#e6db74">}</span><span style="color:#e6db74">, p=</span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#39;</span>)
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_34_0.png" alt="png"></p>
<h3 id="é‡‡æ ·-3">é‡‡æ ·</h3>
<p>é‡‡æ · <strong>Binomial éšæœºå˜é‡</strong> $X \sim \text{Binomial}(n, p)$ï¼ˆè¡¨ç¤ºä» $n$ æ¬¡ç‹¬ç«‹ä¼¯åŠªåˆ©è¯•éªŒä¸­æˆåŠŸæ¬¡æ•°ï¼‰çš„æ–¹æ³•å¾ˆå¤šï¼Œé€‚ç”¨äºä¸åŒå‚æ•°èŒƒå›´ã€‚ä¸‹é¢æ˜¯ç›®å‰å·²çŸ¥çš„æ‰€æœ‰ç»å…¸å’Œå®ç”¨æ–¹æ³•ï¼ŒæŒ‰ç±»å‹å½’ç±»æ•´ç†ï¼Œå¹¶æŒ‡å‡ºé€‚ç”¨æƒ…å†µã€‚</p>
<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>ä¸»è¦æ€æƒ³</th>
          <th>é€‚ç”¨èŒƒå›´</th>
          <th>æ˜¯å¦ç²¾ç¡®</th>
          <th>æ˜¯å¦å®¹æ˜“å®ç°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1. <strong>Bernoulli é‡å¤æ³•</strong></td>
          <td>å¯¹ $n$ æ¬¡ä¼¯åŠªåˆ©é‡‡æ ·å¹¶æ±‚å’Œ</td>
          <td>ä»»æ„ $n, p$ï¼Œå°¤å…¶æ˜¯å° $n$</td>
          <td>âœ… ç²¾ç¡®</td>
          <td>âœ… ç®€å•</td>
      </tr>
      <tr>
          <td>2. <strong>åå‡½æ•°é‡‡æ ·æ³•ï¼ˆInverse Transformï¼‰</strong></td>
          <td>ç”¨ CDF æ‰¾ç¬¬ä¸€ä¸ªä½¿ $F(k) â‰¥ u$ çš„ $k$</td>
          <td>å° $n$ æ—¶å¯è¡Œ</td>
          <td>âœ… ç²¾ç¡®</td>
          <td>âš ï¸ æ˜“æ…¢</td>
      </tr>
      <tr>
          <td>3. <strong>è¡¨æŸ¥æ‰¾æ³•ï¼ˆCDF æŸ¥è¡¨ï¼‰</strong></td>
          <td>é¢„è®¡ç®—æ‰€æœ‰ $F(k)$ï¼Œå†æŸ¥</td>
          <td>å° $n$ï¼ˆ&lt;100ï¼‰</td>
          <td>âœ… ç²¾ç¡®</td>
          <td>âœ… å¿«é€Ÿï¼ˆé¢„è®¡ç®—ï¼‰</td>
      </tr>
      <tr>
          <td>4. <strong>Rejection Sampling</strong></td>
          <td>æ„é€ æ˜“é‡‡æ ·çš„ proposal åˆ†å¸ƒå†æ‹’ç»</td>
          <td>ä¸­ç­‰ $n$ï¼Œæˆ–ç”¨äºæ¨¡æ‹Ÿ</td>
          <td>âœ… ç²¾ç¡®</td>
          <td>âš ï¸ éš¾åº¦é«˜</td>
      </tr>
      <tr>
          <td>5. <strong>æ­£æ€è¿‘ä¼¼æ³•ï¼ˆNormal Approximationï¼‰</strong></td>
          <td>ç”¨ $\mathcal{N}(np, np(1-p))$ è¿‘ä¼¼</td>
          <td>å¤§ $n$ï¼Œ$np(1-p) \ge 10$</td>
          <td>âŒ è¿‘ä¼¼</td>
          <td>âœ… éå¸¸å¿«</td>
      </tr>
      <tr>
          <td>6. <strong>Poisson è¿‘ä¼¼æ³•</strong></td>
          <td>å½“ $n$ å¤§ã€$p$ å°ï¼Œ$\lambda = np$</td>
          <td>$p \le 0.05$ï¼Œ$np \le 10$</td>
          <td>âŒ è¿‘ä¼¼</td>
          <td>âœ… å¿«é€Ÿ</td>
      </tr>
      <tr>
          <td>7. <strong>BTPE ç®—æ³•ï¼ˆFast Binomial by Kachitvichyanukul and Schmeiserï¼‰</strong></td>
          <td>åˆ†æ®µæ‹’ç»é‡‡æ ·ï¼ˆç»å…¸é«˜æ•ˆï¼‰</td>
          <td>ä»»æ„ $n, p$ï¼Œç‰¹åˆ«é€‚åˆå¤§ $n$</td>
          <td>âœ… ç²¾ç¡®</td>
          <td>âš ï¸ å®ç°å¤æ‚</td>
      </tr>
      <tr>
          <td>8. <strong>æ¯”ç‰¹æ“ä½œæ³•ï¼ˆBit Trickï¼‰</strong></td>
          <td>ç”¨ä½æ“ä½œæ¨¡æ‹Ÿå¤šæ¬¡ä¼¯åŠªåˆ©</td>
          <td>$n$ ä¸å¤§ï¼ˆå¦‚è’™ç‰¹å¡æ´›ï¼‰</td>
          <td>âœ… ç²¾ç¡®</td>
          <td>âš ï¸ ç‰¹æ®Šä¼˜åŒ–</td>
      </tr>
      <tr>
          <td>9. <strong>Alias æ–¹æ³•ï¼ˆéä¸»æµï¼‰</strong></td>
          <td>ç¦»æ•£å˜é‡çš„é«˜æ•ˆé‡‡æ ·</td>
          <td>å¾ˆå° $n$ ä¸”å¤§é‡é‡å¤é‡‡æ ·</td>
          <td>âœ… ç²¾ç¡®</td>
          <td>âš ï¸ åˆå§‹åŒ–å¤æ‚</td>
      </tr>
  </tbody>
</table>
<p><strong>ğŸ”§ æ¨èä½¿ç”¨</strong></p>
<table>
  <thead>
      <tr>
          <th>ä½¿ç”¨åœºæ™¯</th>
          <th>æ¨èæ–¹æ³•</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>å­¦ä¹ ç†è§£åŸç†</td>
          <td>ä¼¯åŠªåˆ©é‡å¤é‡‡æ · / åå‡½æ•°é‡‡æ ·</td>
      </tr>
      <tr>
          <td>å°æ ·æœ¬ã€å•æ¬¡é‡‡æ ·</td>
          <td>ä»»æ„ï¼ˆéƒ½å¿«ï¼‰</td>
      </tr>
      <tr>
          <td>å¤§æ ·æœ¬ã€é€Ÿåº¦ä¼˜å…ˆ</td>
          <td>æ­£æ€è¿‘ä¼¼æˆ– BTPEï¼ˆä½¿ç”¨ <code>numpy.random.binomial</code>ï¼‰</td>
      </tr>
      <tr>
          <td>å° $p$ã€ç¨€ç–äº‹ä»¶</td>
          <td>Poisson è¿‘ä¼¼</td>
      </tr>
      <tr>
          <td>å¤šæ¬¡é‡å¤é‡‡æ ·</td>
          <td>ä½¿ç”¨æŸ¥è¡¨ / BTPE ç®—æ³•</td>
      </tr>
  </tbody>
</table>
<p><strong>âœ… æ€»ç»“å›¾ç¤ºï¼ˆæ¦‚å¿µæµç¨‹ï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Binomial(n, p)
</span></span><span style="display:flex;"><span>â”‚
</span></span><span style="display:flex;"><span>â”œâ”€â”€ å° n: ç›´æ¥ä¼¯åŠªåˆ©é‡å¤
</span></span><span style="display:flex;"><span>â”œâ”€â”€ å° p: ç”¨ Poisson(np)
</span></span><span style="display:flex;"><span>â”œâ”€â”€ å¤§ n, np(1-p)&gt;10: ç”¨æ­£æ€(np, np(1-p))
</span></span><span style="display:flex;"><span>â”œâ”€â”€ ä»»æ„ n,p: åå‡½æ•° or æŸ¥è¡¨
</span></span><span style="display:flex;"><span>â””â”€â”€ é«˜æ•ˆå·¥ä¸šçº§: BTPE ç®—æ³•ï¼ˆNumPyï¼‰
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> comb
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">verify_binomial_sample</span>(n, p, samples):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    éªŒè¯äºŒé¡¹åˆ†å¸ƒé‡‡æ ·çš„æ­£ç¡®æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param n: äºŒé¡¹åˆ†å¸ƒçš„è¯•éªŒæ¬¡æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param p: æˆåŠŸæ¦‚ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param samples: é‡‡æ ·ç»“æœåˆ—è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: None
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    N <span style="color:#f92672">=</span> len(samples)
</span></span><span style="display:flex;"><span>    empirical_mean <span style="color:#f92672">=</span> sum(samples) <span style="color:#f92672">/</span> N
</span></span><span style="display:flex;"><span>    theoretical_mean <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> p
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical mean: </span><span style="color:#e6db74">{</span>empirical_mean<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, Theoretical mean: </span><span style="color:#e6db74">{</span>theoretical_mean<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    empirical_variance <span style="color:#f92672">=</span> sum((x <span style="color:#f92672">-</span> empirical_mean) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> samples) <span style="color:#f92672">/</span> len(samples)
</span></span><span style="display:flex;"><span>    theoretical_variance <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> p <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical variance: </span><span style="color:#e6db74">{</span>empirical_variance<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, Theoretical variance: </span><span style="color:#e6db74">{</span>theoretical_variance<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç»Ÿè®¡é¢‘ç‡</span>
</span></span><span style="display:flex;"><span>    counts <span style="color:#f92672">=</span> [samples<span style="color:#f92672">.</span>count(k) <span style="color:#f92672">/</span> N <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è®¡ç®—ç†è®ºæ¦‚ç‡ï¼ˆPMFï¼‰</span>
</span></span><span style="display:flex;"><span>    theoretical <span style="color:#f92672">=</span> [comb(n, k) <span style="color:#f92672">*</span> (p <span style="color:#f92672">**</span> k) <span style="color:#f92672">*</span> ((<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p) <span style="color:#f92672">**</span> (n <span style="color:#f92672">-</span> k)) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å¯è§†åŒ–</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>bar(range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>), counts, width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled Frequency&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;edge&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>bar([k <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.4</span> <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)], theoretical, width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Theoretical PMF&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;edge&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Number of Successes&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Probability&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Binomial Distribution: n=</span><span style="color:#e6db74">{</span>n<span style="color:#e6db74">}</span><span style="color:#e6db74">, p=</span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h4 id="æ–¹æ³•ä¸€ä¼¯åŠªåˆ©é‡å¤æ³•åŸºäºä¼¯åŠªåˆ©éšæœºå˜é‡">æ–¹æ³•ä¸€ï¼šä¼¯åŠªåˆ©é‡å¤æ³•ï¼ˆåŸºäºä¼¯åŠªåˆ©éšæœºå˜é‡ï¼‰</h4>
<p>å¦‚æœä½ èƒ½ä»ä¼¯åŠªåˆ©åˆ†å¸ƒä¸­é‡‡æ ·ï¼Œé‚£å°±å¯ä»¥é€šè¿‡<strong>å¯¹ $n$ æ¬¡ä¼¯åŠªåˆ©é‡‡æ ·æ±‚å’Œ</strong>ï¼Œå¾—åˆ°ä¸€ä¸ªäºŒé¡¹å¼æ ·æœ¬ã€‚</p>
<p>âœ… æ­¥éª¤æ¦‚è§ˆï¼š</p>
<ol>
<li>åˆå§‹åŒ–è®¡æ•°å™¨ä¸º 0</li>
<li>é‡å¤ n æ¬¡ä»¥ä¸‹æ“ä½œï¼š</li>
</ol>
<ul>
<li>ä» [0, 1] ä¸­é‡‡æ ·ä¸€ä¸ªä¼¯åŠªåˆ©å€¼ï¼ˆæˆåŠŸçš„æ¦‚ç‡æ˜¯ $p$ï¼‰</li>
<li>å¦‚æœé‡‡æ ·ä¸º 1ï¼ˆè¡¨ç¤ºæˆåŠŸï¼‰ï¼Œåˆ™è®¡æ•°å™¨åŠ ä¸€</li>
</ul>
<ol start="3">
<li>æœ€ç»ˆçš„è®¡æ•°å™¨æ•°å€¼å°±æ˜¯ä¸€æ¬¡äºŒé¡¹åˆ†å¸ƒçš„é‡‡æ ·å€¼</li>
</ol>
<p>ä½¿ç”¨ NumPy å‘é‡åŒ–é‡‡æ ·ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>binomial(n<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, p<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_binomial_mimic</span>(n, p):
</span></span><span style="display:flex;"><span>    count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n): <span style="color:#75715e"># repeat N times Bernouli sampling</span>
</span></span><span style="display:flex;"><span>        u <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random()  <span style="color:#75715e"># ä» [0,1) ä¸­é‡‡æ ·ä¸€ä¸ªå‡åŒ€å˜é‡</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>p <span style="color:#f92672">&lt;=</span> u <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>       <span style="color:#75715e"># æˆåŠŸå°±åŠ ä¸€</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_binomial_mimic_list</span>(n, p, num_samples):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [sample_binomial_mimic(n, p) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(num_samples)]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>n, p, num_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>sample_binomial_mimic_list(n, p, num_samples)
</span></span></code></pre></div><pre><code>[2, 5, 6, 4, 4, 4, 7, 4, 8, 5]
</code></pre>
<h5 id="visualize">Visualize</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, p, num_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0.3</span>, <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_binomial_mimic_list(n, p, num_samples)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span>range(<span style="color:#ae81ff">12</span>), align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>, rwidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.8</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Number of Successes&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Frequency&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Sampling from Binomial(n=10, p=0.3)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_41_0.png" alt="png"></p>
<h5 id="éªŒè¯-2">éªŒè¯</h5>
<p>éªŒè¯çš„æ€è·¯æ˜¯ï¼šé‡‡å¾ˆå¤šæ ·æœ¬ï¼Œç„¶åç”»å‡ºç›´æ–¹å›¾ï¼Œå†ä¸ç†è®ºçš„äºŒé¡¹å¼æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆPMFï¼‰å¯¹æ¯”ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_binomial_mimic_list(n, p, N)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(f&#34;Empirical mean: {sum(samples)/len(samples):.3f}&#34;)  # åº”è¯¥æ¥è¿‘ np = 10x0.4 = 4.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>verify_binomial_sample(n, p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 2.997, Theoretical mean: 3.000
Empirical variance: 2.153, Theoretical variance: 2.100
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_43_1.png" alt="png"></p>
<h4 id="æ–¹æ³•äºŒåå‡½æ•°é‡‡æ ·æ³•inverse-transform">æ–¹æ³•äºŒï¼šåå‡½æ•°é‡‡æ ·æ³•ï¼ˆInverse Transformï¼‰</h4>
<p>å®ƒæ˜¯ä¸€ç§éå¸¸ç»å…¸çš„ã€<strong>ä¸ä¾èµ–äºé‡å¤æ¨¡æ‹Ÿä¼¯åŠªåˆ©åˆ†å¸ƒ</strong>çš„é‡‡æ ·æ–¹æ³•ã€‚ä¸è¿‡å®ƒ<strong>ä¸å¤ªé€‚åˆé«˜ n çš„ Binomial</strong>ï¼Œå› ä¸ºå®ƒæ¶‰åŠç´¯ç§¯æ¦‚ç‡çš„æŸ¥æ‰¾å’Œæœç´¢ï¼Œä½†åœ¨ç†è®ºä¸Šï¼Œå®ƒæ˜¯å®Œå…¨å¯è¡Œçš„ï¼Œè€Œä¸” <strong>æ²¡æœ‰ç”¨åˆ°ä¼¯åŠªåˆ©éšæœºå˜é‡</strong>ï¼</p>
<p><strong>åŸç†æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p>
<ol>
<li>
<p>ç”Ÿæˆä¸€ä¸ªå‡åŒ€éšæœºæ•° $u \sim \text{Uniform}(0, 1)$</p>
</li>
<li>
<p>ä¾æ¬¡ç´¯åŠ äºŒé¡¹å¼åˆ†å¸ƒçš„æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆPMFï¼‰ï¼š</p>
$$
   F(k) = \sum_{i=0}^{k} P(X=i)
   $$</li>
<li>
<p>æ‰¾åˆ°ç¬¬ä¸€ä¸ª $k$ï¼Œä½¿å¾— $F(k) \ge u$</p>
</li>
<li>
<p>è¿”å›è¿™ä¸ª $k$ï¼Œä½œä¸ºé‡‡æ ·ç»“æœ</p>
</li>
</ol>
<p>è¿™å°±å®Œæˆäº†ä¸€æ¬¡é‡‡æ ·ã€‚</p>
<p><strong>ä¼˜ç¼ºç‚¹åˆ†æ</strong></p>
<table>
  <thead>
      <tr>
          <th>ä¼˜ç‚¹</th>
          <th>ç¼ºç‚¹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ç†è®ºé€šç”¨æ€§å¼º</td>
          <td>å¯¹é«˜ç»´ã€é«˜ n çš„äºŒé¡¹åˆ†å¸ƒæ•ˆç‡è¾ƒä½ï¼ˆè¦è®¡ç®—å¾ˆå¤šé¡¹ï¼‰</td>
      </tr>
      <tr>
          <td>ä¸éœ€è¦æ¨¡æ‹Ÿä¼¯åŠªåˆ©</td>
          <td>æ¯æ¬¡é‡‡æ ·éƒ½è¦é‡æ–°ä» k=0 å¼€å§‹æ‰«æ</td>
      </tr>
      <tr>
          <td>å¯ç”¨äºç²¾ç¡®çš„é‡‡æ ·</td>
          <td>æ— æ³•å‘é‡åŒ–ï¼Œä¸èƒ½ç›´æ¥å¹¶è¡ŒåŠ é€Ÿ</td>
      </tr>
  </tbody>
</table>
<p><strong>é€‚åˆç”¨åœ¨ï¼š</strong></p>
<ul>
<li>$n$ è¾ƒå°çš„æƒ…å†µï¼ˆå¦‚ $n \leq 20$ï¼‰</li>
<li>æ•™å­¦å’Œç†è®ºéªŒè¯ç›®çš„</li>
</ul>
<p><strong>ğŸ“Œ æ€»ç»“</strong></p>
<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>æ˜¯å¦ç”¨ä¼¯åŠªåˆ©</th>
          <th>é€Ÿåº¦</th>
          <th>é€‚ç”¨æƒ…å†µ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ç´¯åŠ ä¼¯åŠªåˆ©</td>
          <td>âœ…</td>
          <td>å¿«ï¼ˆç®€å•ï¼‰</td>
          <td>é€šç”¨ã€å° n</td>
      </tr>
      <tr>
          <td>é€†å˜æ¢é‡‡æ ·</td>
          <td>âŒ</td>
          <td>ä¸­ç­‰</td>
          <td>ç†è®ºéªŒè¯ã€éå‘é‡åŒ–åœºæ™¯</td>
      </tr>
      <tr>
          <td>æ­£æ€/æ³Šæ¾è¿‘ä¼¼</td>
          <td>âŒ</td>
          <td>å¿«</td>
          <td>n å¤§ã€p å°/ä¸­</td>
      </tr>
      <tr>
          <td>è¡¨æŸ¥æ³• + äºŒåˆ†æŸ¥æ‰¾</td>
          <td>âŒ</td>
          <td>éå¸¸å¿«</td>
          <td>å›ºå®š nï¼Œå¤šæ¬¡é‡‡æ ·</td>
      </tr>
  </tbody>
</table>
<h5 id="è¾…åŠ©ç¤ºæ„å›¾ç†è§£">è¾…åŠ©ç¤ºæ„å›¾ç†è§£</h5>
<p>å¦‚æœä½ ç”»å‡º Binomial(n=5, p=0.5) çš„ PMFï¼š</p>
<table>
  <thead>
      <tr>
          <th>k</th>
          <th>P(X=k)</th>
          <th>ç´¯ç§¯å’Œ F(k)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0</td>
          <td>0.03125</td>
          <td>0.03125</td>
      </tr>
      <tr>
          <td>1</td>
          <td>0.15625</td>
          <td>0.1875</td>
      </tr>
      <tr>
          <td>2</td>
          <td>0.3125</td>
          <td>0.5</td>
      </tr>
      <tr>
          <td>3</td>
          <td>0.3125</td>
          <td>0.8125</td>
      </tr>
      <tr>
          <td>4</td>
          <td>0.15625</td>
          <td>0.96875</td>
      </tr>
      <tr>
          <td>5</td>
          <td>0.03125</td>
          <td>1.0</td>
      </tr>
  </tbody>
</table>
<p>å¦‚æœä½ ç”Ÿæˆä¸€ä¸ª $u = 0.4$ï¼Œä½ ä¼šå‘ç° $F(2) = 0.5 \ge 0.4$ï¼Œé‚£ä¹ˆå°±é‡‡æ ·å‡º $k = 2$ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> comb
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å‚æ•°</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¡ç®— PMF å’Œ CDF</span>
</span></span><span style="display:flex;"><span>k_vals <span style="color:#f92672">=</span> list(range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>pmf <span style="color:#f92672">=</span> [comb(n, k) <span style="color:#f92672">*</span> p<span style="color:#f92672">**</span>k <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p)<span style="color:#f92672">**</span>(n <span style="color:#f92672">-</span> k) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> k_vals]
</span></span><span style="display:flex;"><span>cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(pmf)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">####### é‡‡æ · ####### </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆä¸€ä¸ªéšæœºæ•° u</span>
</span></span><span style="display:flex;"><span>u <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.52</span>  <span style="color:#75715e"># ä¹Ÿå¯ä»¥æ”¹æˆ random.random()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ‰¾åˆ°ç¬¬ä¸€ä¸ª cdf[k] &gt;= u</span>
</span></span><span style="display:flex;"><span>k_selected <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k, value <span style="color:#f92672">in</span> enumerate(cdf):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> u <span style="color:#f92672">&lt;=</span> value:
</span></span><span style="display:flex;"><span>        k_selected <span style="color:#f92672">=</span> k
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">####### ç»˜åˆ¶éªŒè¯ ####### </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç»˜å›¾</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PMF å›¾ï¼ˆæŸ±çŠ¶å›¾ï¼‰</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>bar(k_vals, pmf, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;PMF: P(X = k)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># CDF å›¾ï¼ˆé˜¶æ¢¯çº¿ï¼‰</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>step(k_vals, cdf, where<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mid&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;CDF: P(X â‰¤ k)&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”»å‡º u å’Œå¯¹åº”çš„ k_selected</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>axhline(y<span style="color:#f92672">=</span>u, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;u = </span><span style="color:#e6db74">{</span>u<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>axvline(x<span style="color:#f92672">=</span>k_selected, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;green&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;sampled k = </span><span style="color:#e6db74">{</span>k_selected<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ ‡æ³¨</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Inverse Transform Sampling for Binomial(n=</span><span style="color:#e6db74">{</span>n<span style="color:#e6db74">}</span><span style="color:#e6db74">, p=</span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;k&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Probability&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xticks(k_vals)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylim(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1.05</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_46_0.png" alt="png"></p>
<h5 id="ä»£ç å®ç°">ä»£ç å®ç°</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> comb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_binomial_inverse</span>(n, p):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 1: generate a uniform random number</span>
</span></span><span style="display:flex;"><span>    u <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 2: initialize cumulative probability</span>
</span></span><span style="display:flex;"><span>    cumulative <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        prob <span style="color:#f92672">=</span> comb(n, k) <span style="color:#f92672">*</span> (p <span style="color:#f92672">**</span> k) <span style="color:#f92672">*</span> ((<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p) <span style="color:#f92672">**</span> (n <span style="color:#f92672">-</span> k))
</span></span><span style="display:flex;"><span>        cumulative <span style="color:#f92672">+=</span> prob
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> u <span style="color:#f92672">&lt;=</span> cumulative:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> k
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> n  <span style="color:#75715e"># fallback</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_binomial_inverse_list</span>(n, p, num_samples):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [sample_binomial_inverse(n, p) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(num_samples)]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>n, p, num_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>sample_binomial_inverse_list(n, p, num_samples)
</span></span></code></pre></div><pre><code>[3, 4, 2, 3, 5, 5, 7, 2, 4, 8]
</code></pre>
<h5 id="å¯è§†åŒ–">å¯è§†åŒ–</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n, p, num_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0.3</span>, <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_binomial_inverse_list(n, p, num_samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span>range(<span style="color:#ae81ff">12</span>), align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;left&#39;</span>, rwidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.8</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Number of Successes&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Frequency&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Sampling from Binomial(n=10, p=0.3)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_51_0.png" alt="png"></p>
<h5 id="éªŒè¯-3">éªŒè¯</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_binomial_inverse_list(n, p, N)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(f&#34;Empirical mean: {sum(samples)/len(samples):.3f}&#34;)  # åº”è¯¥æ¥è¿‘ np = 10x0.4 = 4.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>verify_binomial_sample(n, p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 3.011, Theoretical mean: 3.000
Empirical variance: 2.097, Theoretical variance: 2.100
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_53_1.png" alt="png"></p>
<h4 id="æ–¹æ³•ä¸‰è¡¨æŸ¥æ‰¾æ³•cdf-æŸ¥è¡¨">æ–¹æ³•ä¸‰ï¼šè¡¨æŸ¥æ‰¾æ³•ï¼ˆCDF æŸ¥è¡¨ï¼‰</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> comb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>binomial_table, binomial_table_n, binomial_table_p <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, <span style="color:#66d9ef">None</span>, <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_binomial_table</span>(n, p):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ç”ŸæˆäºŒé¡¹åˆ†å¸ƒçš„ CDF æŸ¥æ‰¾è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param n: äºŒé¡¹åˆ†å¸ƒçš„è¯•éªŒæ¬¡æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param p: æˆåŠŸæ¦‚ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: None
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">global</span> binomial_table
</span></span><span style="display:flex;"><span>    binomial_table <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>    cumulative <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        prob <span style="color:#f92672">=</span> comb(n, k) <span style="color:#f92672">*</span> (p <span style="color:#f92672">**</span> k) <span style="color:#f92672">*</span> ((<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p) <span style="color:#f92672">**</span> (n <span style="color:#f92672">-</span> k))
</span></span><span style="display:flex;"><span>        cumulative <span style="color:#f92672">+=</span> prob
</span></span><span style="display:flex;"><span>        binomial_table[k] <span style="color:#f92672">=</span> cumulative
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_binomial_table</span>(n, p):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 1: generate a uniform random number</span>
</span></span><span style="display:flex;"><span>    u <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 2: look up in the CDF table</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> binomial_table <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span> <span style="color:#f92672">or</span> binomial_table_n <span style="color:#f92672">!=</span> n <span style="color:#f92672">or</span> binomial_table_p <span style="color:#f92672">!=</span> p:
</span></span><span style="display:flex;"><span>        generate_binomial_table(n, p)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 3: find the first k such that CDF[k] &gt;= u</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> u <span style="color:#f92672">&lt;=</span> binomial_table[k]:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> k
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># If no k found, return n</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> n  <span style="color:#75715e"># fallback</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_binomial_table_list</span>(n, p, num_samples):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [sample_binomial_table(n, p) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(num_samples)]
</span></span></code></pre></div><h5 id="éªŒè¯-4">éªŒè¯</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_binomial_table_list(n, p, N)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(f&#34;Empirical mean: {sum(samples)/len(samples):.3f}&#34;)  # åº”è¯¥æ¥è¿‘ np = 10x0.4 = 4.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>verify_binomial_sample(n, p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 3.002, Theoretical mean: 3.000
Empirical variance: 2.100, Theoretical variance: 2.100
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_57_1.png" alt="png"></p>
<h4 id="æ–¹æ³•å››æ‹’ç»-é‡‡æ ·æ³•rejection-sampling">æ–¹æ³•å››ï¼šæ‹’ç»-é‡‡æ ·æ³•ï¼ˆRejection Samplingï¼‰</h4>
<p>ä½¿ç”¨ <strong>Rejection Samplingï¼ˆæ¥å—-æ‹’ç»é‡‡æ ·ï¼‰æ¥é‡‡æ ·</strong>ä¸€ä¸ª<strong>äºŒé¡¹å¼éšæœºå˜é‡</strong>ï¼Œå…¶å®å¹¶ä¸æ˜¯æœ€å¸¸è§çš„æ–¹æ³•ï¼ˆæ›´å¸¸ç”¨çš„æ˜¯ç›´æ¥é‡‡æ ·æˆ–ç”¨æ³Šæ¾/æ­£æ€è¿‘ä¼¼ï¼‰ï¼Œä½†å®ƒåœ¨ç†è®ºä¸Šæ˜¯å¯è¡Œçš„ï¼Œå°¤å…¶åœ¨éš¾ä»¥ç›´æ¥é‡‡æ ·æˆ–éœ€è¦ä»æˆªæ–­/ç½•è§å‚æ•°çš„äºŒé¡¹å¼åˆ†å¸ƒä¸­é‡‡æ ·æ—¶ã€‚</p>
<p><strong>âœ… proposal åˆ†å¸ƒçš„ç†æƒ³é€‰æ‹©ï¼šå‡åŒ€åˆ†å¸ƒ $g(k) = \frac{1}{n+1}$</strong></p>
<ul>
<li>ç®€å•æ˜“å®ç°ï¼›</li>
<li>ä½†è‹¥ç›®æ ‡åˆ†å¸ƒæ˜¯åæ–œçš„ï¼ˆå¦‚ $p=0.05$ï¼‰ï¼Œé‚£ä¹ˆå¤§å¤šæ•° sample ä¼šè¢«æ‹’ç»ï¼ˆæ•ˆç‡å·®ï¼‰ï¼›</li>
<li>ä»ç„¶æ˜¯æ•™å­¦ä¸­æœ€å¸¸ç”¨ç¤ºä¾‹ã€‚</li>
</ul>
<p><strong>âš ï¸ æ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ul>
<li><strong>æ•ˆç‡å–å†³äº M</strong>ï¼šå¦‚æœ $p$ å¾ˆå°æˆ–å¾ˆå¤§ï¼Œ$f(k)$ ä¼šéå¸¸åï¼Œå¯¼è‡´å¾ˆä½çš„æ¥å—ç‡ï¼›</li>
<li>è‹¥æƒ³æ›´é«˜æ•ˆï¼Œå¯ä½¿ç”¨<strong>ç¦»æ•£é«˜æ–¯åˆ†å¸ƒã€æ³Šæ¾åˆ†å¸ƒã€æ­£æ€è¿‘ä¼¼</strong>ç­‰ä½œä¸ºæ›´â€œè´´è¿‘â€ç›®æ ‡çš„ proposal åˆ†å¸ƒï¼›</li>
<li>Rejection Sampling çš„é€šç”¨æ€§å¼ºï¼Œä½†ä¸æ˜¯é‡‡æ · Binomial çš„é¦–é€‰æ–¹æ³•ï¼ˆé¦–é€‰æ˜¯ç›´æ¥ç®—æ³•ã€æˆ–æ­£æ€/æ³Šæ¾è¿‘ä¼¼ï¼‰ã€‚</li>
</ul>
<p><strong>âœ… æ€»ç»“</strong></p>
<table>
  <thead>
      <tr>
          <th>æ­¥éª¤</th>
          <th>å†…å®¹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ğŸ¯ ç›®æ ‡</td>
          <td>ä» Binomial(n, p) ä¸­é‡‡æ ·</td>
      </tr>
      <tr>
          <td>ğŸ§° æ–¹æ³•</td>
          <td>æ„é€  proposal $g(k)$ï¼Œæ»¡è¶³ $f(k) \leq M g(k)$</td>
      </tr>
      <tr>
          <td>ğŸ“ é‡‡æ ·æœºåˆ¶</td>
          <td>é‡‡æ · $k \sim g(k)$ï¼Œä»¥æ¦‚ç‡ $\alpha = \frac{f(k)}{M g(k)}$ æ¥å—</td>
      </tr>
      <tr>
          <td>ğŸ“‰ ç¼ºç‚¹</td>
          <td>æ•ˆç‡å— $p$ å’Œ $M$ å½±å“è¾ƒå¤§ï¼Œé‡‡æ ·è¾ƒæ…¢</td>
      </tr>
      <tr>
          <td>ğŸ§  ä¼˜åŠ¿</td>
          <td>æ€è·¯ç®€å•ã€åˆ†å¸ƒé€šç”¨æ€§å¼º</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> binom
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rejection_sample_binomial</span>(n, p, N_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>):
</span></span><span style="display:flex;"><span>    samples <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç›®æ ‡åˆ†å¸ƒï¼šBin(n, p)</span>
</span></span><span style="display:flex;"><span>    bin_pmf <span style="color:#f92672">=</span> [binom<span style="color:#f92672">.</span>pmf(k, n, p) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Proposal åˆ†å¸ƒï¼šUniform(0, n)</span>
</span></span><span style="display:flex;"><span>    g <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span> <span style="color:#f92672">/</span> (n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æ‰¾æœ€å¤§å€¼ç”¨äºè®¡ç®— M</span>
</span></span><span style="display:flex;"><span>    M <span style="color:#f92672">=</span> max(bin_pmf) <span style="color:#f92672">/</span> g
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> len(samples) <span style="color:#f92672">&lt;</span> N_samples:
</span></span><span style="display:flex;"><span>        k <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>, n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        u <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        accept_prob <span style="color:#f92672">=</span> bin_pmf[k] <span style="color:#f92672">/</span> (M <span style="color:#f92672">*</span> g)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> u <span style="color:#f92672">&lt;</span> accept_prob:
</span></span><span style="display:flex;"><span>            samples<span style="color:#f92672">.</span>append(k)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> samples
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># éªŒè¯</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> rejection_sample_binomial(n, p, N)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(f&#34;Empirical mean: {sum(samples)/len(samples):.3f}&#34;)  # åº”è¯¥æ¥è¿‘ np = 10x0.4 = 4.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>verify_binomial_sample(n, p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 3.014, Theoretical mean: 3.000
Empirical variance: 2.120, Theoretical variance: 2.100
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_60_1.png" alt="png"></p>
<h4 id="æ–¹æ³•äº”æ­£æ€è¿‘ä¼¼æ³•normal-approximation">æ–¹æ³•äº”ï¼šæ­£æ€è¿‘ä¼¼æ³•ï¼ˆNormal Approximationï¼‰</h4>
<p><strong>åŸç†ï¼šDe Moivreâ€“Laplace ä¸­å¿ƒæé™å®šç†</strong></p>
<p>å½“ $n$ è¶³å¤Ÿå¤§æ—¶ï¼ŒäºŒé¡¹å¼åˆ†å¸ƒ $X \sim \text{Bin}(n, p)$ å¯ç”±æ­£æ€åˆ†å¸ƒè¿‘ä¼¼ï¼š</p>
$$
X \approx Y \sim \mathcal{N}(\mu, \sigma^2)
$$<p>å…¶ä¸­ï¼š</p>
<ul>
<li>å‡å€¼ï¼š$\mu = np$</li>
<li>æ–¹å·®ï¼š$\sigma^2 = np(1-p)$</li>
</ul>
<p>è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä»è¯¥æ­£æ€åˆ†å¸ƒä¸­é‡‡æ ·ä¸€ä¸ªå€¼ä½œä¸ºè¿‘ä¼¼ã€‚</p>
<p><strong>é€‚ç”¨æ¡ä»¶ï¼š</strong></p>
<ul>
<li>$n$ è¦è¶³å¤Ÿå¤§</li>
<li>$p$ ä¸è¦å¤ªæ¥è¿‘ 0 æˆ– 1</li>
</ul>
<p><strong>é€šå¸¸ç»éªŒæ³•åˆ™æ˜¯ï¼š</strong></p>
$$
np \geq 10 \quad \text{ä¸”} \quad n(1-p) \geq 10
$$<p><strong>é‡‡æ ·æ–¹æ³•</strong></p>
<ol>
<li>ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ $Z \sim \mathcal{N}(0, 1)$ é‡‡æ ·ï¼›</li>
<li>æ„é€  $Y = np + \sqrt{np(1-p)} \cdot Z$</li>
<li>å°† $Y$ å››èˆäº”å…¥å¾—åˆ°æ•´æ•° $k$ï¼Œå¹¶è£å‰ªåˆ°åˆæ³•èŒƒå›´ $[0, n]$</li>
</ol>
<p><strong>è¯¯å·®åˆ†æ</strong></p>
<table>
  <thead>
      <tr>
          <th>é¡¹ç›®</th>
          <th>æè¿°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>è¯¯å·®æ¥æº</strong></td>
          <td>è¿ç»­ â†’ ç¦»æ•£ã€è¿‘ä¼¼ tail åå·®</td>
      </tr>
      <tr>
          <td><strong>æ•ˆæœæœ€å¥½</strong></td>
          <td>$p \approx 0.5$ ä¸” $n$ è¶³å¤Ÿå¤§</td>
      </tr>
      <tr>
          <td><strong>åæ€æƒ…å†µ</strong></td>
          <td>å½“ $p \ll 0.5$ æˆ– $p \gg 0.5$ æ—¶å°¾éƒ¨è¯¯å·®å¤§</td>
      </tr>
      <tr>
          <td><strong>æ”¹è¿›æ–¹æ³•</strong></td>
          <td>åŠ  continuity correctionï¼ˆè§ä¸‹ï¼‰</td>
      </tr>
  </tbody>
</table>
<p><strong>ğŸ”§ Continuity Correctionï¼ˆè¿ç»­æ€§ä¿®æ­£ï¼‰</strong></p>
<p>ç”±äºæ­£æ€åˆ†å¸ƒæ˜¯è¿ç»­çš„ï¼Œè€ŒäºŒé¡¹å¼æ˜¯ç¦»æ•£çš„ï¼Œ<strong>è¿ç»­æ€§ä¿®æ­£</strong>å¯ç•¥å¾®æå‡ç²¾åº¦ï¼š</p>
<ul>
<li>å°†ç¦»æ•£å€¼ $k$ æ˜ å°„åˆ° $[k - 0.5, k + 0.5]$ çš„åŒºé—´ä¸Šï¼›</li>
<li>é‡‡æ ·æ—¶åŠ  0.5 æˆ– -0.5 æŠµæ¶ˆè¯¯å·®ï¼š</li>
</ul>
$$
X \approx \mathcal{N}(np, np(1-p)) \Rightarrow X' = \text{round}(Y + 0.5)
$$<p>ä»£ç ä¸­å¯å°è¯• <code>samples = np.floor(samples + 0.5).astype(int)</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> binom
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">normal_approx_binomial</span>(n, p, N_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>):
</span></span><span style="display:flex;"><span>    mu <span style="color:#f92672">=</span> n <span style="color:#f92672">*</span> p
</span></span><span style="display:flex;"><span>    sigma <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(n <span style="color:#f92672">*</span> p <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>    samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span>mu, scale<span style="color:#f92672">=</span>sigma, size<span style="color:#f92672">=</span>N_samples)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å››èˆäº”å…¥å¹¶è£å‰ª</span>
</span></span><span style="display:flex;"><span>    samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>round(samples)<span style="color:#f92672">.</span>astype(int)
</span></span><span style="display:flex;"><span>    samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>clip(samples, <span style="color:#ae81ff">0</span>, n)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> samples<span style="color:#f92672">.</span>tolist()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># éªŒè¯</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> normal_approx_binomial(n, p, N)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#print(f&#34;Empirical mean: {sum(samples)/len(samples):.3f}&#34;)  # åº”è¯¥æ¥è¿‘ np = 10x0.4 = 4.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>verify_binomial_sample(n, p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 3.019, Theoretical mean: 3.000
Empirical variance: 2.116, Theoretical variance: 2.100
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_63_1.png" alt="png"></p>
<h2 id="æŒ‡æ•°éšæœºå˜é‡exponential-random-variables">æŒ‡æ•°éšæœºå˜é‡ï¼ˆExponential Random Variablesï¼‰</h2>
<p><strong>è¿ç»­å‹</strong>éšæœºå˜é‡ã€‚<strong>æŒ‡æ•°åˆ†å¸ƒ</strong>å¯ä»¥ç”¨æ¥å»ºæ¨¡å¹³å‡å‘ç”Ÿç‡æ’å®šã€è¿ç»­ã€ç‹¬ç«‹çš„äº‹ä»¶å‘ç”Ÿçš„é—´éš”ã€‚</p>
<p><strong>æ•°å­¦å®šä¹‰</strong></p>
<p>å¯¹äºä¸€ä¸ªå‚æ•°ä¸º $\lambda > 0$ çš„æŒ‡æ•°åˆ†å¸ƒ $X \sim \text{Exp}(\lambda)$ï¼š</p>
<ul>
<li>
<p>æ”¯æŒé›†ï¼ˆå–å€¼èŒƒå›´ï¼Œå€¼åŸŸï¼‰æ˜¯ï¼š$X \in [0, \infty]$</p>
</li>
<li>
<p>æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆPDFï¼‰ï¼š</p>
$$
  f_X(x) = \begin{cases}
    \lambda e^{-\lambda x}, & x \geq 0 \\
    0, & x < 0
    \end{cases}
  $$</li>
<li>
<p>ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰ï¼š</p>
$$
  F_X(x) = \begin{cases}
    1 - e^{-\lambda x}, & x \geq 0 \\
    0, & x < 0
    \end{cases}
  $$</li>
<li>
<p>æœŸæœ›ï¼ˆ$\mu$ï¼‰ï¼š$\frac{1}{\lambda}$</p>
</li>
<li>
<p>æ–¹å·®ï¼ˆ$\sigma^2$ï¼‰ï¼š$\frac{1}{\lambda^2}$</p>
</li>
</ul>
<p><strong>å‚è€ƒï¼š</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Exponential_distribution">Wiki: Exponential distribution</a></li>
<li><a href="https://proofwiki.org/wiki/Expectation_of_Exponential_Distribution">ProofWiki: Expectation of Exponential Distribution</a></li>
<li><a href="https://proofwiki.org/wiki/Variance_of_Exponential_Distribution">ProofWiki: Variance of Exponential Distribution</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®éšæœºç§å­ä»¥ä¿è¯å¯é‡å¤æ€§</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æŒ‡æ•°åˆ†å¸ƒå‚æ•° Î»ï¼ˆé€Ÿç‡å‚æ•°ï¼‰</span>
</span></span><span style="display:flex;"><span>lambda_val <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·æ•°é‡</span>
</span></span><span style="display:flex;"><span>n_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨ numpy é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>exponential(scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>lambda_val, size<span style="color:#f92672">=</span>n_samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºå›¾å½¢</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç»˜åˆ¶é‡‡æ ·çš„ç›´æ–¹å›¾ï¼ˆå½’ä¸€åŒ–ä¸ºå¯†åº¦ï¼‰</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled Histogram&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆç†è®ºæ›²çº¿</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, np<span style="color:#f92672">.</span>max(samples), <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>pdf <span style="color:#f92672">=</span> lambda_val <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>lambda_val <span style="color:#f92672">*</span> x_vals)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x_vals, pdf, <span style="color:#e6db74">&#39;r-&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Theoretical PDF (Î»=</span><span style="color:#e6db74">{</span>lambda_val<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#39;</span>)
</span></span><span style="display:flex;"><span>a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>y_vals <span style="color:#f92672">=</span> a<span style="color:#f92672">+</span>b<span style="color:#f92672">*</span>x_vals
</span></span><span style="display:flex;"><span>ypdf <span style="color:#f92672">=</span> a<span style="color:#f92672">*</span>pdf<span style="color:#f92672">+</span>b
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(y_vals, pdf, <span style="color:#e6db74">&#39;b-&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Theoretical PDF (Î»=</span><span style="color:#e6db74">{</span>lambda_val<span style="color:#e6db74">}</span><span style="color:#e6db74">;y=</span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">*x+</span><span style="color:#e6db74">{</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å›¾å½¢è®¾ç½®</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Exponential Distribution Visualization&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_65_0.png" alt="png"></p>
<h3 id="é‡‡æ ·-4">é‡‡æ ·</h3>
<h4 id="ä½¿ç”¨åå‡½æ•°æ³•inverse-transform-sampling">ä½¿ç”¨åå‡½æ•°æ³•ï¼ˆInverse Transform Samplingï¼‰</h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒ $Uâˆ¼Uniform(0,1)$ï¼Œå¯ä»¥ç”¨åå‡½æ•°æ³•æ¥é‡‡æ ·æŒ‡æ•°éšæœºå˜é‡ï¼š</p>
<p>$ X = -\frac{ln(1-U)}{\lambda}$</p>
<p><strong>æ¨å¯¼</strong>
$$
F(x) = 1 - e^{-\lambda x} = u\
1 - u = e^{-\lambda x} \
ln(1-u) = -\lambda x \
x = -\frac{ln(1-u)}{\lambda}</p>
<p>$$</p>
<p>ğŸ‘‰ è¿™ä¸ªå…¬å¼éå¸¸å¸¸è§ï¼Œä¹Ÿæ˜¯åœ¨æ¨¡æ‹ŸæŒ‡æ•°åˆ†å¸ƒæ—¶çš„åŸºæœ¬æ–¹æ³•ã€‚</p>
<blockquote>
<p>ä¹Ÿå¯ä»¥ç”¨ <code>numpy.random.exponential(scale=1/lambda_val, size=n_samples)</code></p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_exponential_inverse</span>(lambda_val):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    é‡‡æ ·æŒ‡æ•°åˆ†å¸ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param lambda_val: æŒ‡æ•°åˆ†å¸ƒçš„é€Ÿç‡å‚æ•° Î»
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param n_samples: é‡‡æ ·æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: é‡‡æ ·ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    u <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random()  <span style="color:#75715e"># ä» [0, 1) ä¸­é‡‡æ ·ä¸€ä¸ªå‡åŒ€å˜é‡</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>math<span style="color:#f92672">.</span>log(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>u) <span style="color:#f92672">/</span> lambda_val  <span style="color:#75715e"># ä½¿ç”¨é€†å˜æ¢é‡‡æ ·å…¬å¼ X = -ln(1-U)/Î»</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_exponential_inverse_list</span>(lambda_val, n_samples):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [sample_exponential_inverse(lambda_val) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n_samples)]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å‚æ•°è®¾ç½®</span>
</span></span><span style="display:flex;"><span>lambda_val <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.5</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨åå‡½æ•°æ³•é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> sample_exponential_inverse_list(lambda_val, n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># éªŒè¯ï¼šç»˜å›¾</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(X, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled Histogram&#39;</span>)
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x_vals, lambda_val <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>lambda_val <span style="color:#f92672">*</span> x_vals), <span style="color:#e6db74">&#39;r-&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;True PDF&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;X&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;PDF&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Exponential Distribution (Î» = </span><span style="color:#e6db74">{:.1f}</span><span style="color:#e6db74">, n = </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)&#39;</span><span style="color:#f92672">.</span>format(lambda_val, n))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_68_0.png" alt="png"></p>
<h2 id="å‡ ä½•éšæœºå˜é‡geometric-random-variables">å‡ ä½•éšæœºå˜é‡ï¼ˆGeometric Random Variablesï¼‰</h2>
<h3 id="æ¦‚è¿°">æ¦‚è¿°</h3>
<p>å®ƒæ˜¯<strong>ç¦»æ•£å‹</strong>éšæœºå˜é‡ä¸­éå¸¸ç»å…¸çš„ä¸€ä¸ªï¼Œå‡ºç°åœ¨å¾ˆå¤šè¯•éªŒç›´åˆ°ç¬¬ä¸€æ¬¡æˆåŠŸçš„æƒ…æ™¯ä¸­ã€‚</p>
<p>ä¸€ä¸ª<strong>å‡ ä½•éšæœºå˜é‡</strong> $X \sim \text{Geometric}(p)$ï¼Œè¡¨ç¤ºï¼š</p>
<blockquote>
<p><strong>åœ¨ç‹¬ç«‹é‡å¤ä¼¯åŠªåˆ©è¯•éªŒä¸­ï¼Œç¬¬ä¸€æ¬¡æˆåŠŸå‡ºç°çš„è¯•éªŒç¼–å·ã€‚</strong></p></blockquote>
<ul>
<li>æ¯æ¬¡è¯•éªŒéƒ½æ˜¯ç‹¬ç«‹çš„ï¼ŒæˆåŠŸæ¦‚ç‡æ˜¯ $p \in (0,1)$</li>
<li>$X \in \{1, 2, 3, \dots\}$</li>
</ul>
<p><strong>ğŸ“Œ æ¦‚ç‡è´¨é‡å‡½æ•°ï¼ˆPMFï¼‰</strong></p>
<p>å‡ ä½•åˆ†å¸ƒçš„æ¦‚ç‡è´¨é‡å‡½æ•°ä¸ºï¼š</p>
$$
P(X = k) = (1 - p)^{k - 1} \cdot p, \quad \text{for } k = 1, 2, 3, \dots
$$<p>è¿™è¡¨ç¤ºï¼š</p>
<ul>
<li>ç¬¬ $k-1$ æ¬¡éƒ½å¤±è´¥ï¼ˆæ¦‚ç‡ä¸º $(1-p)^{k-1}$ï¼‰ï¼›</li>
<li>ç¬¬ $k$ æ¬¡æˆåŠŸï¼ˆæ¦‚ç‡ä¸º $p$ï¼‰ã€‚</li>
</ul>
<p><strong>ğŸ“Š ä¸¾ä¸ªä¾‹å­</strong></p>
<p>æ¯”å¦‚ä½ åœ¨æŠ›ä¸€ä¸ªä¸å…¬å¹³çš„ç¡¬å¸ï¼Œæ­£é¢ï¼ˆæˆåŠŸï¼‰çš„æ¦‚ç‡æ˜¯ $p = 0.3$ï¼Œä½ åœ¨ç­‰ç¬¬ä¸€æ¬¡å‡ºç°æ­£é¢ï¼š</p>
<ul>
<li>$P(X = 1) = 0.3$ ï¼ˆç¬¬ä¸€æ¬¡å°±æ­£é¢ï¼‰</li>
<li>$P(X = 2) = 0.7 \cdot 0.3 = 0.21$ï¼ˆç¬¬ä¸€æ¬¡åé¢ï¼Œç¬¬äºŒæ¬¡æ­£é¢ï¼‰</li>
<li>$P(X = 3) = 0.7^2 \cdot 0.3 = 0.147$</li>
</ul>
<p><strong>ğŸ“ ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰</strong></p>
$$
P(X \leq k) = 1 - (1 - p)^k, k=1,2, \dots
$$<p>æ¨å¯¼è¿‡ç¨‹ï¼š
</p>
$$
F(k) = P(X \leq k) \\
= \sum^k_{i=1}P(X=i) \\
= \sum^k_{i=1}(1 - p)^{i - 1} \cdot p \\
= p\cdot\sum^k_{i=1}(1 - p)^{i - 1}
$$<p>ä»¤ $j=i-1$ï¼Œåˆ™ï¼š
</p>
$$
F(k) = p\cdot\sum^k_{i=1}(1 - p)^{i - 1} \\
= p\cdot\sum^{k-1}_{j=0}(1 - p)^j \\
= p\cdot\frac{(1-p)^{k-1}-1}{(1-p)-p} \\
= 1-(1-p)^{k-1}
$$<p>ğŸ§  è§£é‡Šç›´è§‰ï¼š
è¿™ä¸ªè¡¨è¾¾å¼è¡¨ç¤ºï¼Œåœ¨å‰ $k$ æ¬¡è¯•éªŒä¸­è‡³å°‘æˆåŠŸä¸€æ¬¡çš„æ¦‚ç‡ã€‚åè¿‡æ¥è¯´ï¼Œæ‰€æœ‰å‰ $k$ æ¬¡éƒ½å¤±è´¥çš„æ¦‚ç‡æ˜¯ $(1âˆ’p)^k$ï¼Œæ‰€ä»¥ CDF æ˜¯ï¼š
</p>
$$
P(è‡³å°‘ä¸€æ¬¡æˆåŠŸ) = 1 - P(å…¨éƒ¨å¤±è´¥) = 1âˆ’(1âˆ’p)^k
$$<h4 id="-æœŸæœ›">ğŸ“ˆ æœŸæœ›</h4>
<p><strong>æœŸæœ›å€¼</strong>ï¼ˆMeanï¼‰ï¼š</p>
$$
\mathbb{E}[X] = \frac{1}{p}
$$<p><strong>ğŸ¯ æ¨å¯¼æœŸæœ› $\mathbb{E}[X]$</strong></p>
<p>æˆ‘ä»¬è¦è®¡ç®—ï¼š</p>
$$
\mathbb{E}[X] = \sum_{k=1}^{\infty} k \cdot (1 - p)^{k-1} \cdot p
$$<p>ä»¤ $q = 1 - p$ï¼Œåˆ™å˜ä¸ºï¼š</p>
$$
\mathbb{E}[X] = p \sum_{k=1}^{\infty} k q^{k-1}
$$<p>è¿™æ˜¯ä¸€ä¸ªç»å…¸çº§æ•°ï¼š</p>
$$
\sum_{k=1}^{\infty} k q^{k-1} = \frac{1}{(1 - q)^2}
\quad \text{(å½“ } |q| < 1 \text{)}
$$<p>ä»£å…¥ï¼š</p>
$$
\mathbb{E}[X] = p \cdot \frac{1}{(1 - q)^2} = p \cdot \frac{1}{p^2} = \frac{1}{p}
$$<h4 id="-æ–¹å·®">ğŸ“ˆ æ–¹å·®</h4>
<p><strong>æ–¹å·®</strong>ï¼ˆVarianceï¼‰ï¼š</p>
$$
\text{Var}(X) = \frac{1 - p}{p^2}
$$<p><strong>ğŸ“Š æ¨å¯¼æ–¹å·® $\mathrm{Var}(X)$</strong></p>
<p>æˆ‘ä»¬ä½¿ç”¨å…¬å¼ï¼š</p>
$$
\mathrm{Var}(X) = \mathbb{E}[X^2] - \left(\mathbb{E}[X]\right)^2
$$<p><strong>1ï¸âƒ£ æ¨å¯¼ $\mathbb{E}[X^2]$</strong></p>
<p>æˆ‘ä»¬è¦ç®—ï¼š</p>
$$
\mathbb{E}[X^2] = \sum_{k=1}^{\infty} k^2 \cdot q^{k-1} \cdot p
= p \cdot \sum_{k=1}^{\infty} k^2 q^{k-1}
$$<p>è¿™æ˜¯ä¸€ä¸ªå·²çŸ¥çº§æ•°ï¼ˆä½ å¯ä»¥ä»å…¬å¼æ‰‹å†Œä¸­æ‰¾åˆ°ï¼‰ï¼š</p>
$$
\sum_{k=1}^{\infty} k^2 q^{k-1} = \frac{1 + q}{(1 - q)^3}
$$<p>ä»£å…¥å¾—ï¼š</p>
$$
\mathbb{E}[X^2] = p \cdot \frac{1 + q}{(1 - q)^3}
= p \cdot \frac{1 + (1 - p)}{p^3}
= p \cdot \frac{2 - p}{p^3}
= \frac{2 - p}{p^2}
$$<p><strong>2ï¸âƒ£ ä»£å…¥æ–¹å·®å…¬å¼</strong></p>
$$
\mathrm{Var}(X) = \mathbb{E}[X^2] - (\mathbb{E}[X])^2
= \frac{2 - p}{p^2} - \left( \frac{1}{p} \right)^2
= \frac{2 - p - 1}{p^2}
= \frac{1 - p}{p^2}
$$<h4 id="-åº”ç”¨åœºæ™¯ä¸¾ä¾‹">ğŸ’¡ åº”ç”¨åœºæ™¯ä¸¾ä¾‹</h4>
<ul>
<li>æŠ›ç¡¬å¸ç›´åˆ°ç¬¬ä¸€æ¬¡æ­£é¢</li>
<li>æŸæœºå™¨ç¬¬ä¸€æ¬¡æˆåŠŸå“åº”çš„æ¬¡æ•°</li>
<li>ç½‘ç»œä¸­ç­‰å¾…ç¬¬ä¸€ä¸ªæˆåŠŸåŒ…åˆ°è¾¾</li>
<li>é©¬å°”ç§‘å¤«é“¾ä¸­çš„ç¬¬ä¸€æ¬¡è·³è½¬æ—¶é—´</li>
</ul>
<p><strong>ğŸ§  å°ç»“</strong></p>
<table>
  <thead>
      <tr>
          <th>å±æ€§</th>
          <th>å‡ ä½•éšæœºå˜é‡</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ç±»å‹</td>
          <td>ç¦»æ•£å‹</td>
      </tr>
      <tr>
          <td>å–å€¼</td>
          <td>æ­£æ•´æ•° $\{1,2,3,\dots\}$</td>
      </tr>
      <tr>
          <td>æ ¸å¿ƒæ€æƒ³</td>
          <td>ç¬¬ä¸€æ¬¡æˆåŠŸçš„è¯•éªŒç¼–å·</td>
      </tr>
      <tr>
          <td>PMF</td>
          <td>$P(X = k) = (1 - p)^{k - 1} \cdot p$</td>
      </tr>
      <tr>
          <td>CDF</td>
          <td>$1 - (1 - p)^k$</td>
      </tr>
      <tr>
          <td>æœŸæœ›</td>
          <td>$\frac{1}{p}$</td>
      </tr>
      <tr>
          <td>æ–¹å·®</td>
          <td>$\frac{1-p}{p^2}$</td>
      </tr>
      <tr>
          <td>é‡‡æ ·</td>
          <td>æ¨¡æ‹Ÿä¼¯åŠªåˆ©åºåˆ—ï¼Œæˆ–ç”¨åå‡½æ•°é‡‡æ ·æ³•</td>
      </tr>
  </tbody>
</table>
<p><strong>å‚è€ƒï¼š</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Geometric_distribution">Wiki: Geometric distribution</a></li>
<li><a href="https://proofwiki.org/wiki/Geometric_Distribution_Gives_Rise_to_Probability_Mass_Function">ProofWiki: Geometric Distribution Gives Rise to Probability Mass Function</a></li>
<li><a href="https://math.stackexchange.com/questions/2161184/solving-for-the-cdf-of-the-geometric-probability-distribution">Stackexchange: Solving for the CDF of the Geometric Probability Distribution</a></li>
<li><a href="https://proofwiki.org/wiki/Expectation_of_Geometric_Distribution">ProofWiki: Expectation of Geometric Distribution</a></li>
<li><a href="https://proofwiki.org/wiki/Variance_of_Geometric_Distribution">ProofWiki: Variance of Geometric Distribution</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> scipy.stats <span style="color:#66d9ef">as</span> stats
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®éšæœºç§å­ä»¥ä¿è¯ç»“æœå¯é‡å¤</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. å®šä¹‰å‚æ•°</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>values <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> len(values)
</span></span><span style="display:flex;"><span>pmf <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>geom(p)<span style="color:#f92672">.</span>pmf(values)
</span></span><span style="display:flex;"><span>cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(pmf)  <span style="color:#75715e"># ç´¯ç§¯åˆ†å¸ƒå‡½æ•°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. æŠ½æ ·</span>
</span></span><span style="display:flex;"><span>n_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>geometric(p<span style="color:#f92672">=</span>p, size<span style="color:#f92672">=</span>n_samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. å¯è§†åŒ–ï¼šç†è®ºåˆ†å¸ƒ + é‡‡æ ·é¢‘ç‡å¯¹æ¯”</span>
</span></span><span style="display:flex;"><span>plot_discrete_rv(values, pmf, cdf, samples, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Geometric(p=</span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_70_0.png" alt="png"></p>
<h3 id="é‡‡æ ·-5">é‡‡æ ·</h3>
<p><strong>é‡‡æ ·æ–¹æ³•å¯¹æ¯”</strong></p>
<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>åŸç†</th>
          <th>æ•ˆç‡</th>
          <th>ä¼˜ç¼ºç‚¹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ä¼¯åŠªåˆ©æ¨¡æ‹Ÿ</td>
          <td>æ¨¡æ‹Ÿæ¯æ¬¡è¯•éªŒ</td>
          <td>ä½</td>
          <td>ç›´è§‚ä½†æ…¢ï¼Œé€‚åˆæ•™å­¦</td>
      </tr>
      <tr>
          <td>åå‡½æ•°é‡‡æ ·</td>
          <td>CDF åå‡½æ•°</td>
          <td>é«˜</td>
          <td>é€‚åˆæ•°å­¦èƒŒæ™¯å¥½è€…</td>
      </tr>
      <tr>
          <td>æŸ¥è¡¨æ³•</td>
          <td>CDF + æŸ¥æ‰¾</td>
          <td>é«˜</td>
          <td>é‡å¤é‡‡æ ·å¿«ï¼Œéœ€é¢„å¤„ç†</td>
      </tr>
      <tr>
          <td>NumPy å†…å»º</td>
          <td>é«˜æ•ˆç®—æ³•</td>
          <td>é«˜</td>
          <td>å·¥ç¨‹å®ç”¨ï¼Œä½†ç•¥é»‘ç®±</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy <span style="color:#f92672">import</span> stats
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">verify_geometric_sample</span>(p, samples):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    éªŒè¯å‡ ä½•åˆ†å¸ƒé‡‡æ ·çš„æ­£ç¡®æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param p: æˆåŠŸæ¦‚ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param samples: é‡‡æ ·ç»“æœåˆ—è¡¨ï¼ˆå€¼åŸŸåº”ä¸º 1, 2, 3, ...ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: None
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    N <span style="color:#f92672">=</span> len(samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å‡å€¼ä¸æ–¹å·®éªŒè¯</span>
</span></span><span style="display:flex;"><span>    empirical_mean <span style="color:#f92672">=</span> sum(samples) <span style="color:#f92672">/</span> N
</span></span><span style="display:flex;"><span>    theoretical_mean <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> p
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical mean: </span><span style="color:#e6db74">{</span>empirical_mean<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, Theoretical mean: </span><span style="color:#e6db74">{</span>theoretical_mean<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    empirical_variance <span style="color:#f92672">=</span> sum((x <span style="color:#f92672">-</span> empirical_mean) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> samples) <span style="color:#f92672">/</span> N
</span></span><span style="display:flex;"><span>    theoretical_variance <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p) <span style="color:#f92672">/</span> (p <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical variance: </span><span style="color:#e6db74">{</span>empirical_variance<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, Theoretical variance: </span><span style="color:#e6db74">{</span>theoretical_variance<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç»Ÿè®¡æœ€å¤§å€¼ä½œä¸ºç»˜å›¾èŒƒå›´</span>
</span></span><span style="display:flex;"><span>    k_max <span style="color:#f92672">=</span> max(samples)
</span></span><span style="display:flex;"><span>    ks <span style="color:#f92672">=</span> list(range(<span style="color:#ae81ff">1</span>, k_max <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç»Ÿè®¡é¢‘ç‡ï¼ˆç»éªŒ PMFï¼‰</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> Counter
</span></span><span style="display:flex;"><span>    counter <span style="color:#f92672">=</span> Counter(samples)
</span></span><span style="display:flex;"><span>    counts <span style="color:#f92672">=</span> [counter<span style="color:#f92672">.</span>get(k, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">/</span> N <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> ks]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç†è®º PMF</span>
</span></span><span style="display:flex;"><span>    theoretical <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>geom(p)<span style="color:#f92672">.</span>pmf(ks)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å¯è§†åŒ–</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>bar([k <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.2</span> <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> ks], counts, width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled Frequency&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>bar([k <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.2</span> <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> ks], theoretical, width<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Theoretical PMF&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>, align<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Number of Trials Until First Success (k)&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Probability&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Geometric Distribution Verification (p=</span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h4 id="æ–¹æ³•-1åˆ©ç”¨-numpy-å†…ç½®å‡½æ•°">æ–¹æ³• 1ï¼šåˆ©ç”¨ NumPy å†…ç½®å‡½æ•°</h4>
<p>NumPy å·²å†…ç½® Geometric åˆ†å¸ƒé‡‡æ ·</p>
<ul>
<li>âœ… <strong>ä¼˜ç‚¹</strong>ï¼šé«˜æ€§èƒ½ã€ç®€æ´</li>
<li>âŒ <strong>ç¼ºç‚¹</strong>ï¼šé€‚åˆå·¥ç¨‹ä½¿ç”¨ï¼Œå­¦ä¹ åŸç†æ—¶ä¸æ¨èç›´æ¥ä½¿ç”¨</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>geometric(p<span style="color:#f92672">=</span>p, size<span style="color:#f92672">=</span>n)<span style="color:#f92672">.</span>tolist()
</span></span><span style="display:flex;"><span>verify_geometric_sample(p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 3.276, Theoretical mean: 3.333
Empirical variance: 7.363, Theoretical variance: 7.778
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_74_1.png" alt="png"></p>
<h4 id="æ–¹æ³•-2åå‡½æ•°é‡‡æ ·æ³•">æ–¹æ³• 2ï¼šåå‡½æ•°é‡‡æ ·æ³•</h4>
<p>å‡ ä½•åˆ†å¸ƒæœ‰ä¸€ä¸ªå°é—­å½¢å¼ï¼ˆclose-formï¼‰çš„ CDFï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨<strong>åå‡½æ•°é‡‡æ ·æ³•</strong>ï¼ˆinverse transform samplingï¼‰ï¼š</p>
$$
X = \left\lceil \frac{\log(1 - U)}{\log(1 - p)} \right\rceil
\quad \text{å…¶ä¸­ } U \sim \text{Uniform}(0, 1)
$$<p><strong>åŸç†ï¼š</strong></p>
<p>åˆ©ç”¨ Geometric åˆ†å¸ƒçš„ CDFï¼ˆ$F(x) \sim \text{Uniform}(0,1)$ï¼‰ï¼š</p>
$$
F(k) = 1 - (1 - p)^k
$$<p>å¦‚æœæˆ‘ä»¬ä» $U \sim \text{Uniform}(0,1)$ ä¸­å¾—åˆ°ä¸€ä¸ªå€¼ $u$ï¼Œé‚£ä¹ˆæœ‰ $1-(1-p)^{i-1} \lt u \le 1-(1-p)^{i} $ï¼Œå…¶ä¸­ï¼Œ$i$ å°±æ˜¯æˆ‘ä»¬è¦çš„é‡‡æ ·å€¼ã€‚æˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºä¸€ä¸ªå°é—­å½¢å¼ï¼š
</p>
$$
1-(1-p)^{i-1} \lt u \le 1-(1-p)^{i} \\
-1+(1-p)^{i-1} \gt -u \ge -1+(1-p)^{i} \\
(1-p)^{i-1} \gt 1-u \ge (1-p)^{i} \\
ln((1-p)^{i-1}) \gt ln(1-u) \ge ln((1-p)^{i}) \\
(i-1)\cdot ln(1-p) \gt ln(1-u) \ge i\cdot ln(1-p) \\
i-1 \lt \frac{ln(1-u)}{ln(1-p)} \le i
$$<p>å› æ­¤ï¼Œ$i = int(\frac{ln(1-u)}{ln(1-p)}) + 1$ï¼Œå…¶ä¸­ï¼Œ$int$ è¡¨ç¤ºå®æ•°éƒ¨åˆ†çš„æ•´æ•°éƒ¨åˆ†</p>
<p>å³ï¼š</p>
$$
k = \left\lceil \frac{\log(1 - U)}{\log(1 - p)} \right\rceil
$$<p>å…¶ä¸­ $U \sim \text{Uniform}(0,1)$</p>
<blockquote>
<p>å®é™…ä¸­ï¼Œå› ä¸º $1 - U$ ä¸ $U$ åœ¨åˆ†å¸ƒä¸Šä¸€è‡´ï¼Œæ‰€ä»¥å¸¸å†™ä¸ºï¼š</p></blockquote>
$$
k = \left\lceil \frac{\log(U)}{\log(1 - p)} \right\rceil
$$<p><strong>ä¼˜åŠ£ï¼š</strong></p>
<ul>
<li>âœ… <strong>ä¼˜ç‚¹</strong>ï¼šæ•ˆç‡é«˜ï¼Œå•æ¬¡é‡‡æ ·å¸¸æ•°æ—¶é—´</li>
<li>âœ… <strong>é€‚åˆä½ $p$</strong> å€¼æ—¶ä½¿ç”¨</li>
<li>âŒ <strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦è®¡ç®—å¯¹æ•°å‡½æ•°ï¼Œå¯èƒ½ç•¥æ…¢äºæŸ¥è¡¨æ³•</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_geometric_inverse</span>(p):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ä½¿ç”¨é€†å˜æ¢æ³•é‡‡æ ·å‡ ä½•åˆ†å¸ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param p: æˆåŠŸæ¦‚ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: é‡‡æ ·ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    u <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># ä» [0, 1) ä¸­é‡‡æ ·ä¸€ä¸ªå‡åŒ€å˜é‡</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> int(np<span style="color:#f92672">.</span>ceil(np<span style="color:#f92672">.</span>log(<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> u) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>log(<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p)))  <span style="color:#75715e"># ä½¿ç”¨é€†å˜æ¢å…¬å¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_geometric_inverse_list</span>(p, n_samples):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ç”Ÿæˆå‡ ä½•åˆ†å¸ƒçš„é‡‡æ ·åˆ—è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param p: æˆåŠŸæ¦‚ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param n_samples: é‡‡æ ·æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: é‡‡æ ·ç»“æœåˆ—è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [sample_geometric_inverse(p) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n_samples)]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_geometric_inverse_list(p, n)
</span></span><span style="display:flex;"><span>verify_geometric_sample(p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 3.396, Theoretical mean: 3.333
Empirical variance: 8.143, Theoretical variance: 7.778
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_77_1.png" alt="png"></p>
<h4 id="æ–¹æ³•-3æŸ¥è¡¨æ³•cdf-table-lookup">æ–¹æ³• 3ï¼šæŸ¥è¡¨æ³•ï¼ˆCDF Table Lookupï¼‰</h4>
<p><strong>åŸç†ï¼š</strong>
æå‰æ„å»º CDF è¡¨ï¼ˆPMF ç´¯åŠ ï¼‰ï¼Œå†ç”¨ Uniform å˜é‡æŸ¥æ‰¾å¯¹åº”åŒºé—´ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<ol>
<li>ç»™å®š $p$ï¼Œè®¡ç®—å‰ $N$ ä¸ªæ¦‚ç‡å’Œ $\text{CDF}(k)$</li>
<li>ç”Ÿæˆ $U \sim \text{Uniform}(0, 1)$</li>
<li>æ‰¾åˆ°æœ€å°çš„ $k$ï¼Œä½¿å¾— $\text{CDF}(k) \geq U$</li>
</ol>
<p><strong>ä¼˜åŠ£ï¼š</strong></p>
<ul>
<li>âœ… <strong>ä¼˜ç‚¹</strong>ï¼šé‡‡æ ·å¿«é€Ÿï¼ˆO(N) æˆ–æ›´å¿«å¦‚äºŒåˆ†æŸ¥æ‰¾ï¼‰</li>
<li>âœ… <strong>é€‚åˆé‡å¤é‡‡æ ·åœºæ™¯</strong></li>
<li>âŒ <strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦é¢„å­˜ CDF è¡¨ï¼ˆå†…å­˜å ç”¨ï¼‰</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_cdf_table</span>(p, max_k<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>):
</span></span><span style="display:flex;"><span>    cdf <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    total <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, max_k <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        prob <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> p) <span style="color:#f92672">**</span> (k <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> p
</span></span><span style="display:flex;"><span>        total <span style="color:#f92672">+=</span> prob
</span></span><span style="display:flex;"><span>        cdf<span style="color:#f92672">.</span>append(total)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> cdf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_geometric_lookup</span>(cdf_table):
</span></span><span style="display:flex;"><span>    u <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, value <span style="color:#f92672">in</span> enumerate(cdf_table):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> u <span style="color:#f92672">&lt;=</span> value:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> len(cdf_table)  <span style="color:#75715e"># fallback</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_geometric_lookup_list</span>(p, n_samples, max_k<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>):
</span></span><span style="display:flex;"><span>    cdf_table <span style="color:#f92672">=</span> build_cdf_table(p, max_k)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [sample_geometric_lookup(cdf_table) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n_samples)]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_geometric_lookup_list(p, n)
</span></span><span style="display:flex;"><span>verify_geometric_sample(p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 3.371, Theoretical mean: 3.333
Empirical variance: 7.935, Theoretical variance: 7.778
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_80_1.png" alt="png"></p>
<h4 id="æ–¹æ³•-4ä¼¯åŠªåˆ©è¯•éªŒæ¨¡æ‹Ÿæ³•bernoulli-trial-simulation">æ–¹æ³• 4ï¼šä¼¯åŠªåˆ©è¯•éªŒæ¨¡æ‹Ÿæ³•ï¼ˆBernoulli Trial Simulationï¼‰</h4>
<p><strong>åŸç†</strong>ï¼šä» $X \sim \text{Geometric}(p)$ çš„å®šä¹‰å‡ºå‘ï¼šå®ƒè¡¨ç¤º<strong>ç¬¬ä¸€ä¸ªæˆåŠŸå‡ºç°çš„ä½ç½®</strong>ã€‚å› æ­¤ï¼Œåªè¦é‡å¤æŠ•æ·ä¼¯åŠªåˆ©(p)åˆ†å¸ƒçš„ç¡¬å¸ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡å‡ºç°â€œæˆåŠŸâ€ï¼ˆå³ä¸º 1ï¼‰ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<ol>
<li>åˆå§‹åŒ–è®¡æ•°å™¨ $k = 1$</li>
<li>é‡å¤ç”Ÿæˆ $U \sim \text{Uniform}(0, 1)$</li>
<li>å¦‚æœ $1-p \le U \le 1$ï¼Œè¡¨ç¤ºæˆåŠŸï¼Œè¿”å› $k$</li>
<li>å¦åˆ™ $k \leftarrow k + 1$ï¼Œé‡å¤</li>
</ol>
<p><strong>ä¼˜åŠ£ï¼š</strong></p>
<ul>
<li>âœ… <strong>ä¼˜ç‚¹</strong>ï¼šåŸç†ç›´è§‚ï¼Œé€‚åˆæ•™å­¦æ¼”ç¤º</li>
<li>âŒ <strong>ç¼ºç‚¹</strong>ï¼šå½“ $p$ å¾ˆå°æ—¶ï¼Œå¯èƒ½éœ€è¦å¾ˆå¤šæ¬¡è¿­ä»£ï¼Œæ•ˆç‡ä½</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_geometric_mimic</span>(p):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    æ¨¡æ‹Ÿå‡ ä½•åˆ†å¸ƒé‡‡æ ·
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param p: æˆåŠŸæ¦‚ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: é‡‡æ ·ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>        u <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random()  <span style="color:#75715e"># ä» [0, 1) ä¸­é‡‡æ ·ä¸€ä¸ªå‡åŒ€å˜é‡</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>p <span style="color:#f92672">&lt;=</span>u <span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">1</span>:  <span style="color:#75715e"># æˆåŠŸ</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> k
</span></span><span style="display:flex;"><span>        k <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>  <span style="color:#75715e"># å¤±è´¥ï¼Œå¢åŠ è®¡æ•°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_geometric_mimic_list</span>(p, n_samples):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ç”Ÿæˆå‡ ä½•åˆ†å¸ƒçš„é‡‡æ ·åˆ—è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param p: æˆåŠŸæ¦‚ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param n_samples: é‡‡æ ·æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: é‡‡æ ·ç»“æœåˆ—è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [sample_geometric_mimic(p) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n_samples)]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_geometric_mimic_list(p, N)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>verify_geometric_sample(p, samples)
</span></span></code></pre></div><pre><code>Empirical mean: 3.339, Theoretical mean: 3.333
Empirical variance: 7.983, Theoretical variance: 7.778
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_83_1.png" alt="png"></p>
<h2 id="æ­£æ€éšæœºå˜é‡normal-random-variables">æ­£æ€éšæœºå˜é‡ï¼ˆNormal Random Variablesï¼‰</h2>
<h3 id="åŸºç¡€çŸ¥è¯†">åŸºç¡€çŸ¥è¯†</h3>
<p>æ­£æ€åˆ†å¸ƒï¼ˆNormal Distributionï¼‰ï¼Œä¹Ÿå«<strong>é«˜æ–¯åˆ†å¸ƒ</strong>ï¼Œæ˜¯ä¸€ç§<strong>è¿ç»­å‹æ¦‚ç‡åˆ†å¸ƒ</strong>ï¼Œåœ¨ç»Ÿè®¡å­¦ä¸­éå¸¸é‡è¦ï¼Œæ˜¯<strong>ä¸­å¿ƒæé™å®šç†</strong>çš„æ ¸å¿ƒåˆ†å¸ƒã€‚å®ƒçš„æ›²çº¿å‘ˆ<strong>é’Ÿå½¢å¯¹ç§°</strong>ï¼Œåœ¨è‡ªç„¶ç•Œä¸å·¥ç¨‹é¢†åŸŸä¸­é¢‘ç¹å‡ºç°ã€‚</p>
<h4 id="-æ¦‚ç‡å¯†åº¦å‡½æ•°pdf">ğŸ“ æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆPDFï¼‰</h4>
<p>æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å¦‚ä¸‹ï¼š</p>
$$
f(x; \mu, \sigma) = \frac{1}{\sqrt{2\pi \sigma^2}} \exp\left(-\frac{(x - \mu)^2}{2\sigma^2}\right)
$$<ul>
<li>$\mu$ï¼šå‡å€¼ï¼ˆä½ç½®å‚æ•°ï¼Œå†³å®šå³°å€¼ä¸­å¿ƒï¼‰</li>
<li>$\sigma^2$ï¼šæ–¹å·®ï¼ˆå°ºåº¦å‚æ•°ï¼Œå†³å®šæ›²çº¿å®½åº¦ï¼‰</li>
<li>$\sigma$ï¼šæ ‡å‡†å·®</li>
</ul>
<h4 id="ç‰¹æ®Šæƒ…å†µæ ‡å‡†æ­£æ€åˆ†å¸ƒ">ç‰¹æ®Šæƒ…å†µï¼šæ ‡å‡†æ­£æ€åˆ†å¸ƒ</h4>
<p>å½“ $\mu = 0, \sigma = 1$ æ—¶ï¼š</p>
$$
f(x) = \frac{1}{\sqrt{2\pi}} \exp\left(-\frac{x^2}{2}\right)
$$<h4 id="-å½¢çŠ¶ä¸ç‰¹æ€§">ğŸ“ˆ å½¢çŠ¶ä¸ç‰¹æ€§</h4>
<ul>
<li>
<p><strong>å¯¹ç§°æ€§</strong>ï¼šå…³äº $\mu$ å¯¹ç§°</p>
</li>
<li>
<p><strong>å•å³°æ€§</strong>ï¼šå‡å€¼å¤„æœ€é«˜ç‚¹</p>
</li>
<li>
<p><strong>å·¦å³å°¾å·´æ— é™å»¶ä¼¸ï¼Œä½†æ€»é¢ç§¯ä¸º 1</strong></p>
</li>
<li>
<p><strong>68-95-99.7 è§„åˆ™ï¼ˆç»éªŒæ³•åˆ™ï¼‰</strong>ï¼š</p>
<ul>
<li>çº¦ 68% çš„æ¦‚ç‡é›†ä¸­åœ¨ $\mu \pm \sigma$</li>
<li>çº¦ 95% çš„æ¦‚ç‡é›†ä¸­åœ¨ $\mu \pm 2\sigma$</li>
<li>çº¦ 99.7% çš„æ¦‚ç‡é›†ä¸­åœ¨ $\mu \pm 3\sigma$</li>
</ul>
</li>
</ul>
<h4 id="-æœŸæœ›ä¸æ–¹å·®çš„æ¨å¯¼æ ‡å‡†æ­£æ€">ğŸ§® æœŸæœ›ä¸æ–¹å·®çš„æ¨å¯¼ï¼ˆæ ‡å‡†æ­£æ€ï¼‰</h4>
<ul>
<li><strong>æœŸæœ›</strong>ï¼š</li>
</ul>
$$
\mathbb{E}[X] = \int_{-\infty}^{\infty} x \cdot f(x) \, dx = 0
$$<ul>
<li><strong>æ–¹å·®</strong>ï¼š</li>
</ul>
$$
\mathbb{V}[X] = \mathbb{E}[X^2] = \int_{-\infty}^{\infty} x^2 \cdot f(x) \, dx = 1
$$<p>è¿™äº›æ¨å¯¼éœ€è¦ç”¨åˆ°å¯¹ç§°æ€§å’Œé«˜æ–¯ç§¯åˆ†æŠ€å·§ï¼ˆå¦‚æ¢å…ƒæ³•æˆ–é…æ–¹æ³•ï¼‰ã€‚</p>
<h4 id="-æ­£æ€åˆ†å¸ƒçš„æ¥æºä¸ç›´è§‰ç†è§£ä¸­å¿ƒæé™å®šç†clt">ğŸ§ª æ­£æ€åˆ†å¸ƒçš„æ¥æºä¸ç›´è§‰ç†è§£ï¼š<a href="https://en.wikipedia.org/wiki/Central_limit_theorem">ä¸­å¿ƒæé™å®šç†ï¼ˆCLTï¼‰</a></h4>
<blockquote>
<p><strong>å¤šä¸ªç‹¬ç«‹éšæœºå˜é‡çš„å¹³å‡å€¼åœ¨ n è¶‹äºæ— ç©·å¤§æ—¶è¶‹äºæ­£æ€åˆ†å¸ƒ</strong>ï¼Œæ— è®ºåŸå§‹åˆ†å¸ƒæ˜¯ä»€ä¹ˆã€‚</p></blockquote>
<p>ä»¤ $\{X_{1},\ldots ,X_{n}\}$ æ˜¯ä¸€ä¸ª<a href="https://zh.wikipedia.org/wiki/%E7%8B%AC%E7%AB%8B%E5%90%8C%E5%88%86%E5%B8%83">ç‹¬ç«‹åŒåˆ†å¸ƒï¼ˆi.i.dï¼‰</a>çš„éšæœºå˜é‡åºåˆ—ï¼Œå®ƒä»¬æ»¡è¶³çš„åˆ†å¸ƒçš„æœŸæœ›å€¼ä¸º$\mu$ï¼Œæ–¹å·®ä¸º $\sigma ^{2}$ã€‚</p>
<p>é‚£ä¹ˆï¼Œå…¶<strong>æ ·æœ¬å‡å€¼</strong>ä¸ºï¼š${\bar {X}}_{n}\equiv {\frac {X_{1}+\cdots +X_{n}}{n}}$ã€‚æ ¹æ®å¤§æ•°å®šç†ï¼Œ</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ­£æ€åˆ†å¸ƒåœ¨è‡ªç„¶ç°è±¡ä¸­å¦‚æ­¤æ™®éï¼šæ¸©åº¦ã€èº«é«˜è¯¯å·®ã€æµ‹é‡è¯¯å·®ã€è€ƒè¯•æˆç»©ç­‰ã€‚</p>
<h4 id="-åº”ç”¨åœºæ™¯">ğŸ§  åº”ç”¨åœºæ™¯</h4>
<ul>
<li>æµ‹é‡è¯¯å·®å»ºæ¨¡</li>
<li>æœºå™¨å­¦ä¹ ä¸­çš„é«˜æ–¯å‡è®¾</li>
<li>è´å¶æ–¯æ¨ç†ä¸­çš„å…ˆéªŒ / ä¼¼ç„¶</li>
<li>è‚¡ç¥¨æ”¶ç›Šå»ºæ¨¡ï¼ˆç²—ç•¥ï¼‰</li>
<li>æ•°æ®ç”Ÿæˆ / æ¨¡æ‹Ÿ / MC æ–¹æ³•åŸºç¡€åˆ†å¸ƒ</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> norm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>pdf <span style="color:#f92672">=</span> norm<span style="color:#f92672">.</span>pdf(x, loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, pdf, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Standard Normal PDF&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>fill_between(x, pdf, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Standard Normal Distribution&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Probability Density&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_86_0.png" alt="png"></p>
<h3 id="ä»æ ‡å‡†æ­£æ€éšæœºå˜é‡standard-normal-rvä¸­é‡‡æ ·">ä»æ ‡å‡†æ­£æ€éšæœºå˜é‡ï¼ˆStandard Normal RVï¼‰ä¸­é‡‡æ ·</h3>
<p>æ ‡å‡†æ­£æ€åˆ†å¸ƒæ˜¯å‡å€¼ $\mu = 0$ï¼Œæ ‡å‡†å·® $\sigma = 1$ çš„æ­£æ€åˆ†å¸ƒï¼š</p>
$$
f_Z(z) = \frac{1}{\sqrt{2\pi}} \exp\left(-\frac{z^2}{2}\right)
$$<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>åŸç†</th>
          <th>æ˜¯å¦æ¨è</th>
          <th>æ˜¯å¦å¿«é€Ÿ</th>
          <th>å¤‡æ³¨</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>np.random.normal</code></td>
          <td>å†…ç½®åº“</td>
          <td>âœ…</td>
          <td>âœ…</td>
          <td>æœ€æ–¹ä¾¿</td>
      </tr>
      <tr>
          <td>Box-Muller</td>
          <td>æåæ ‡å˜æ¢</td>
          <td>âœ…</td>
          <td>âœ…</td>
          <td>åŸç†ç›´è§‚ï¼Œé€‚åˆæ•™å­¦</td>
      </tr>
      <tr>
          <td>Inverse CDF</td>
          <td>åå‡½æ•°é‡‡æ ·</td>
          <td>âŒ</td>
          <td>âŒ</td>
          <td>æ— è§£æè§£ï¼Œéœ€è¿‘ä¼¼æˆ–æŸ¥è¡¨</td>
      </tr>
      <tr>
          <td>ä¸­å¿ƒæé™å®šç†</td>
          <td></td>
          <td></td>
          <td></td>
          <td>ç®€å•ç›´è§‚ï¼Œæ•™å­¦å‹å¥½ï¼Œä½†ç²¾åº¦æœ‰é™ï¼Œä¸é€‚ç”¨äºé«˜ç²¾åº¦æ¨¡æ‹Ÿ</td>
      </tr>
      <tr>
          <td>Rejection Sampling</td>
          <td>æ¥å—æ‹’ç»æœºåˆ¶</td>
          <td>âš ï¸</td>
          <td>âŒ</td>
          <td>é€šç”¨æ€§å¼ºï¼Œæ•ˆç‡ä½</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> norm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">verify_standard_normal_sample</span>(samples):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    éªŒè¯æ ‡å‡†æ­£æ€åˆ†å¸ƒé‡‡æ ·çš„æ­£ç¡®æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param samples: ä» N(0,1) ä¸­é‡‡æ ·çš„ç»“æœ (list or array)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    N <span style="color:#f92672">=</span> len(samples)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç»éªŒç»Ÿè®¡é‡</span>
</span></span><span style="display:flex;"><span>    empirical_mean <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mean(samples)
</span></span><span style="display:flex;"><span>    empirical_var <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>var(samples)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç†è®ºç»Ÿè®¡é‡</span>
</span></span><span style="display:flex;"><span>    theoretical_mean <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    theoretical_var <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical mean: </span><span style="color:#e6db74">{</span>empirical_mean<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> | Theoretical mean: </span><span style="color:#e6db74">{</span>theoretical_mean<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Empirical var: </span><span style="color:#e6db74">{</span>empirical_var<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> | Theoretical var: </span><span style="color:#e6db74">{</span>theoretical_var<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç›´æ–¹å›¾ + ç†è®º PDF</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled Histogram&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(x, norm<span style="color:#f92672">.</span>pdf(x, loc<span style="color:#f92672">=</span>theoretical_mean, scale<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>sqrt(theoretical_var)), <span style="color:#e6db74">&#39;r-&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Theoretical PDF&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;PDF Comparison&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç»éªŒ CDF vs ç†è®º CDF</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    sorted_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sort(samples)
</span></span><span style="display:flex;"><span>    empirical_cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> N
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(sorted_samples, empirical_cdf, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Empirical CDF&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(x, norm<span style="color:#f92672">.</span>cdf(x, loc<span style="color:#f92672">=</span>theoretical_mean, scale<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>sqrt(theoretical_var)), <span style="color:#e6db74">&#39;r--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Theoretical CDF&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;CDF Comparison&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;CDF&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h4 id="-æ–¹æ³•ä¸€ç”¨-numpy-ç›´æ¥é‡‡æ ·æœ€æ–¹ä¾¿">âœ… æ–¹æ³•ä¸€ï¼šç”¨ NumPy ç›´æ¥é‡‡æ ·ï¼ˆæœ€æ–¹ä¾¿ï¼‰</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(loc<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># verify the sampling results</span>
</span></span><span style="display:flex;"><span>verify_standard_normal_sample(samples)
</span></span></code></pre></div><pre><code>Empirical mean: 0.0045 | Theoretical mean: 0
Empirical var: 0.9778 | Theoretical var: 1
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_90_1.png" alt="png"></p>
<h4 id="-æ–¹æ³•äºŒbox-muller-å˜æ¢ç»å…¸æ–¹æ³•">âœ… æ–¹æ³•äºŒï¼šBox-Muller å˜æ¢ï¼ˆç»å…¸æ–¹æ³•ï¼‰</h4>
<p>Box-Muller å˜æ¢ï¼ˆ<a href="https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform">Box-Muller transform</a>ï¼‰æ˜¯ä¸€ç§<strong>ä»å‡åŒ€åˆ†å¸ƒé‡‡æ ·ä¸¤ä¸ªå˜é‡ï¼Œç”Ÿæˆä¸¤ä¸ªç‹¬ç«‹æ ‡å‡†æ­£æ€éšæœºå˜é‡</strong>çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯æ„é€ æ€§çš„ã€éè¿‘ä¼¼çš„ï¼ˆä¸åƒä¸­å¿ƒæé™å®šç†é‚£æ ·æ˜¯é€¼è¿‘ï¼‰ã€‚</p>
<p><strong>ğŸ§  èƒŒåæ€æƒ³ï¼š</strong></p>
<p>æˆ‘ä»¬å¸Œæœ›ä»ä¸¤ä¸ª<strong>ç‹¬ç«‹</strong>çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒ $\mathcal{N}(0, 1)$ ä¸­é‡‡æ ·å‡ºå˜é‡ $Z_1$ å’Œ $Z_2$ã€‚</p>
<p>æˆ‘ä»¬å·²çŸ¥æ— æ³•ç›´æ¥ä»æ­£æ€åˆ†å¸ƒä¸­é‡‡æ ·ï¼Œä½†æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ä»å‡åŒ€åˆ†å¸ƒä¸­é‡‡æ ·ä¸¤ä¸ªå˜é‡ $U_1, U_2 \sim \text{Uniform}(0, 1)$ï¼Œç„¶åé€šè¿‡<strong>å˜é‡å˜æ¢</strong>å¾—åˆ° $Z_1, Z_2$ã€‚</p>
<p><strong>ğŸ§® æ•°å­¦æ¨å¯¼æ ¸å¿ƒæ­¥éª¤</strong></p>
<p>Step 1ï¼šå°†æ­£æ€åˆ†å¸ƒè½¬ä¸ºæåæ ‡</p>
<p>2ç»´ç‹¬ç«‹æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š</p>
$$
f_{XY}(x, y) = f_X(x)f_Y(y) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \cdot \frac{1}{\sqrt{2\pi}} e^{-\frac{y^2}{2}} = \frac{1}{2\pi} e^{-\frac{x^2 + y^2}{2}}
$$<p>å¦‚æœæˆ‘ä»¬ç”¨<a href="https://zh.wikipedia.org/zh-hans/%E6%9E%81%E5%9D%90%E6%A0%87%E7%B3%BB">æåæ ‡</a>è¡¨ç¤º $x = r\cos\theta, y = r\sin\theta$ï¼Œåˆ™ï¼š</p>
$$
f(r, \theta) = f(x,y) \cdot |J| = \frac{1}{2\pi} e^{-\frac{r^2}{2}} \cdot r
$$<p>å…¶ä¸­ $|J| = r$ æ˜¯é›…å¯æ¯”è¡Œåˆ—å¼ï¼ˆé¢ç§¯æ‹‰ä¼¸ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p>
$$
f_{R,\Theta}(r, \theta) = \underbrace{r e^{-r^2/2}}_{\text{ä¸ } r \text{ æœ‰å…³}} \cdot \underbrace{\frac{1}{2\pi}}_{\text{ä¸ } \theta \text{ æœ‰å…³}}
$$<blockquote>
<p>è¿™è¡¨ç¤º $R$ å’Œ $\Theta$ æ˜¯<strong>ç›¸äº’ç‹¬ç«‹</strong>çš„éšæœºå˜é‡ï¼</p></blockquote>
<p>æ‰€ä»¥è”åˆ pdf å˜æˆï¼š</p>
$$
f(r, \theta) = \frac{r}{2\pi} e^{-\frac{r^2}{2}} \quad \text{for } r \in [0, \infty), \theta \in [0, 2\pi)
$$<p>Step 2ï¼šæ„é€ é‡‡æ ·å˜é‡</p>
<p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æƒ³åŠæ³•åˆ†åˆ«ä»ä»¥ä¸‹ä¸¤ä¸ªåˆ†å¸ƒä¸­é‡‡æ ·ï¼š</p>
<ul>
<li>$\Theta \sim \text{Uniform}(0, 2\pi)$</li>
<li>$R \sim \text{PDF } f_R(r) = r e^{-r^2/2},\quad r \geq 0$</li>
</ul>
<p>æˆ‘ä»¬çœ‹ $R$ çš„åˆ†å¸ƒï¼š</p>
$$
f_R(r) = r e^{-r^2/2}
$$<p>å¯¹æ¯”ï¼šè®¾ $U_1 \sim \text{Uniform}(0,1)$ï¼Œæˆ‘ä»¬ä»¤ï¼š</p>
$$
R = \sqrt{-2 \ln U_1}
$$<p>æˆ‘ä»¬å¯ä»¥åå‘éªŒè¯ï¼šè¿™ä¸ª R çš„åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ­£æ˜¯ï¼š</p>
$$
f_R(r) = \frac{d}{dr} \mathbb{P}(R \leq r) = \frac{d}{dr} \mathbb{P}(U_1 \geq e^{-r^2/2}) = \frac{d}{dr} \left( 1 - e^{-r^2/2} \right) = r e^{-r^2/2}
$$<p>æ‰€ä»¥è¿™ä¸ªå˜é‡å˜æ¢æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œåœ¨äºŒç»´æ­£æ€è”åˆåˆ†å¸ƒä¸‹ï¼Œè§’åº¦æ–¹å‘æ˜¯å‡åŒ€çš„ï¼š</p>
$$
f_\Theta(\theta) = \frac{1}{2\pi},\quad \theta \in [0, 2\pi)
$$<p>æ‰€ä»¥åªéœ€è¦ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒ $U_2 \sim \text{Uniform}(0,1)$ï¼Œé€šè¿‡çº¿æ€§ç¼©æ”¾å³å¯ï¼š</p>
$$
\Theta = 2\pi U_2
$$<p><strong>âœ… æœ€ç»ˆå˜æ¢</strong></p>
<p>å°† $R = \sqrt{-2 \ln U_1}$ï¼Œ$\Theta = 2\pi U_2$ å¸¦å…¥ï¼š</p>
$$
Z_1 = R \cos\Theta = \sqrt{-2 \ln U_1} \cdot \cos(2\pi U_2) \\
Z_2 = R \sin\Theta = \sqrt{-2 \ln U_1} \cdot \sin(2\pi U_2)
$$<p>è¿™ä¸¤ä¸ªå˜é‡å°±æ˜¯æˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„<strong>ç‹¬ç«‹æ ‡å‡†æ­£æ€å˜é‡</strong>ã€‚</p>
<p><strong>ğŸ“Œ Box-Muller çš„ä¼˜ç‚¹å’Œç¼ºç‚¹</strong></p>
<table>
  <thead>
      <tr>
          <th>ä¼˜ç‚¹</th>
          <th>ç¼ºç‚¹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æ•°å­¦ä¸¥è°¨ï¼Œç”Ÿæˆå€¼ç²¾ç¡®æœä»æ­£æ€åˆ†å¸ƒ</td>
          <td>éœ€è¦ä½¿ç”¨å¯¹æ•°å’Œä¸‰è§’å‡½æ•°ï¼Œè¾ƒæ…¢</td>
      </tr>
      <tr>
          <td>æ¯æ¬¡é‡‡æ ·ä¸¤ä¸ªæ­£æ€æ ·æœ¬</td>
          <td>ä¸é€‚åˆåµŒå…¥å¼è®¾å¤‡ã€GPU ç­‰éœ€æ€§èƒ½ä¼˜åŒ–åœºåˆ</td>
      </tr>
      <tr>
          <td>é€‚ç”¨äºç†è§£æåæ ‡å˜æ¢ä¸æ­£æ€åˆ†å¸ƒçš„å…³ç³»</td>
          <td>ä¸èƒ½é«˜æ•ˆçŸ¢é‡åŒ–ä¸º SIMD ä»£ç </td>
      </tr>
  </tbody>
</table>
<p><strong>ğŸš€ å°ç»“</strong></p>
<p>Box-Muller æ˜¯ä¸€ä¸ª <strong>ç†è®ºå®Œç¾</strong> çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒé‡‡æ ·æ–¹æ³•ï¼Œå…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>åˆ©ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„ $U(0,1)$ æ ·æœ¬</li>
<li>æ„é€ ä¸¤ä¸ª $\mathcal{N}(0,1)$ ç‹¬ç«‹æ ·æœ¬</li>
<li>å˜æ¢æ–¹å¼åŸºäºäºŒç»´æåæ ‡ç³»ç»Ÿå’Œé›…å¯æ¯”æ¨å¯¼</li>
<li>æ˜¯ä¸€ç§æ ‡å‡†çš„â€œä»ç®€å•åˆ†å¸ƒå˜æ¢ä¸ºå¤æ‚åˆ†å¸ƒâ€çš„ç»å…¸æ¡ˆä¾‹</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> norm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">box_muller_sample</span>(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>, visualize<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 1: ç”Ÿæˆä¸¤ä¸ªå‡åŒ€åˆ†å¸ƒå˜é‡</span>
</span></span><span style="display:flex;"><span>    U1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, n_samples)
</span></span><span style="display:flex;"><span>    U2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, n_samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 2: Box-Mullerå˜æ¢</span>
</span></span><span style="display:flex;"><span>    R <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>log(U1))
</span></span><span style="display:flex;"><span>    theta <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi <span style="color:#f92672">*</span> U2
</span></span><span style="display:flex;"><span>    Z1 <span style="color:#f92672">=</span> R <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>cos(theta)
</span></span><span style="display:flex;"><span>    Z2 <span style="color:#f92672">=</span> R <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sin(theta)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> visualize:
</span></span><span style="display:flex;"><span>        num_bins <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>hist(Z1, bins<span style="color:#f92672">=</span>num_bins, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Z1&#39;</span>)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>plot(x, norm<span style="color:#f92672">.</span>pdf(x), <span style="color:#e6db74">&#39;r--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Standard Normal PDF&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Z1 ~ N(0,1)&#34;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>hist(Z2, bins<span style="color:#f92672">=</span>num_bins, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Z2&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>plot(x, norm<span style="color:#f92672">.</span>pdf(x), <span style="color:#e6db74">&#39;r--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Standard Normal PDF&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Z2 ~ N(0,1)&#34;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#34;Box-Muller Sampling of Standard Normal Distribution&#34;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> Z1, Z2
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>box_muller_sample(n_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>, visualize<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_93_0.png" alt="png"></p>
<pre><code>(array([ 1.48779139,  0.98464068, -0.80586692, ..., -0.52369914,
        -0.56467099, -2.07728924], shape=(10000,)),
 array([ 1.22339848, -0.80627553,  0.55483184, ..., -1.4385899 ,
         2.53391275, -0.82037306], shape=(10000,)))
</code></pre>
<h4 id="-æ–¹æ³•ä¸‰åå‡½æ•°é‡‡æ ·æ³•ç†è®ºå¯è¡Œå®é™…ä½†ä¸å¯è¡Œ">âœ… æ–¹æ³•ä¸‰ï¼šåå‡½æ•°é‡‡æ ·æ³•ï¼ˆç†è®ºå¯è¡Œï¼Œå®é™…ä½†ä¸å¯è¡Œï¼‰</h4>
<ul>
<li>
<p>ç”¨åå‡½æ•°é‡‡æ ·æ³•ï¼šè®¾ $U \sim \text{Uniform}(0,1)$ï¼Œåˆ™ä»¤ï¼š</p>
$$
  Z = F^{-1}(U)
  $$<p>å…¶ä¸­ $F$ æ˜¯æ­£æ€åˆ†å¸ƒçš„ CDFï¼Œ$F^{-1}$ æ˜¯å®ƒçš„åå‡½æ•°ï¼ˆå³åˆ†ä½æ•°å‡½æ•° / probit å‡½æ•°ï¼‰ã€‚</p>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ CDF æ²¡æœ‰è§£æåå‡½æ•°ï¼Œæ‰€ä»¥<strong>ä¸èƒ½ç”¨åŸºæœ¬å‡½æ•°è¡¨è¾¾</strong>ï¼Œä½†å¯ä»¥é€šè¿‡æŸ¥è¡¨æˆ–è¿‘ä¼¼ï¼ˆå¦‚ Beasley-Springer ç®—æ³•ï¼‰ã€‚</p>
</li>
</ul>
<h4 id="-æ–¹æ³•å››åˆ©ç”¨ä¸­å¿ƒæé™å®šç†central-limit-theorem-clt-è¿›è¡Œé‡‡æ ·">âœ… æ–¹æ³•å››ï¼šåˆ©ç”¨ä¸­å¿ƒæé™å®šç†ï¼ˆCentral Limit Theorem, CLTï¼‰ è¿›è¡Œé‡‡æ ·</h4>
<p>ä½¿ç”¨ <strong>ä¸­å¿ƒæé™å®šç†ï¼ˆCentral Limit Theorem, CLTï¼‰</strong> è¿›è¡Œé‡‡æ ·ï¼Œæ˜¯ä¸€ç§ç»å…¸ä¸”ç›´è§‚çš„æ–¹å¼æ¥ç”Ÿæˆè¿‘ä¼¼ <strong>æ ‡å‡†æ­£æ€åˆ†å¸ƒ</strong> çš„æ ·æœ¬ã€‚è¿™ç§æ–¹æ³•å¸¸ç”¨äºæ•™å­¦æ¼”ç¤ºï¼ŒåŸç†ç®€å•ï¼Œä½†åœ¨å®é™…é«˜ç²¾åº¦æ¨¡æ‹Ÿä¸­ä¸å¸¸ç”¨ã€‚</p>
<p><strong>ğŸ§  Step-by-stepï¼šä¸ºä»€ä¹ˆ CLT å¯ä»¥ç”¨æ¥é‡‡æ ·æ ‡å‡†æ­£æ€åˆ†å¸ƒ</strong></p>
<p>æˆ‘ä»¬ä»¥å¦‚ä¸‹é—®é¢˜ä¸ºç›®æ ‡ï¼š</p>
<blockquote>
<p>èƒ½å¦é€šè¿‡ä¸€ç»„ç®€å•çš„<strong>ç‹¬ç«‹éšæœºå˜é‡</strong>ï¼ˆä¾‹å¦‚å‡åŒ€åˆ†å¸ƒï¼‰æ¥æ„é€ ä¸€ä¸ªè¿‘ä¼¼æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ $\mathcal{N}(0, 1)$ çš„å˜é‡ï¼Ÿ</p></blockquote>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å¯ä»¥ï¼</strong> è¿™å°±æ˜¯ä¸­å¿ƒæé™å®šç†çš„å¨åŠ›ã€‚</p>
<p><strong>ğŸ¯ Step 1: ä¸­å¿ƒæé™å®šç†çš„æ ¸å¿ƒå†…å®¹</strong></p>
<blockquote>
<p><strong>ä¸­å¿ƒæé™å®šç†ï¼ˆCLTï¼‰</strong>ï¼š
å‡è®¾ä½ æœ‰ä¸€ç»„ç‹¬ç«‹åŒåˆ†å¸ƒï¼ˆi.i.dï¼‰çš„éšæœºå˜é‡ $X_1, X_2, \dots, X_n$ï¼Œæ¯ä¸ªå˜é‡çš„æœŸæœ›å€¼ä¸º $\mu$ï¼Œæ–¹å·®ä¸º $\sigma^2$ã€‚é‚£ä¹ˆï¼š</p></blockquote>
$$
Z_n = \frac{\sum_{i=1}^n X_i - n\mu}{\sqrt{n\sigma^2}} \xrightarrow{d} \mathcal{N}(0,1)
$$<p>å½“ $n \to \infty$ï¼Œè¿™ä¸ªæ ‡å‡†åŒ–çš„å’Œï¼ˆæˆ–è€…å¹³å‡å€¼ï¼‰<strong>åœ¨åˆ†å¸ƒä¸Šè¶‹è¿‘äºæ ‡å‡†æ­£æ€åˆ†å¸ƒ</strong>ã€‚</p>
<p><strong>ğŸ“Œ Step 2: ç”¨å‡åŒ€åˆ†å¸ƒæ¥ä¸¾ä¾‹è¯´æ˜</strong></p>
<p>æˆ‘ä»¬é€‰ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œä¾‹å¦‚ <strong>Uniform(0, 1)</strong> åˆ†å¸ƒï¼š</p>
<ul>
<li>å®ƒçš„æœŸæœ› $\mu = 0.5$</li>
<li>å®ƒçš„æ–¹å·® $\sigma^2 = \frac{1}{12}$</li>
</ul>
<p>æˆ‘ä»¬é‡‡æ · $n$ ä¸ªè¿™æ ·çš„å˜é‡ $U_1, \dots, U_n$ï¼Œç„¶åæ„é€ å¦‚ä¸‹å˜é‡ï¼š</p>
$$
Z = \frac{\sum_{i=1}^n U_i - n\mu}{\sqrt{n\sigma^2}} = \frac{\sum_{i=1}^n (U_i - 0.5)}{\sqrt{n \cdot \frac{1}{12}}}
$$<p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
$$
Z = \sum_{i=1}^n (U_i - 0.5) \cdot \sqrt{12 / n}
$$<p>è¿™ä¸ªå˜é‡ $Z$ ä¼šè¶Šæ¥è¶Šæ¥è¿‘æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚</p>
<blockquote>
<p>$n$çš„å–å€¼å–å†³äºæ‰€é€‰æ‹©çš„åˆ†å¸ƒã€‚å¯¹äºå‡åŒ€åˆ†å¸ƒï¼Œ$n$çš„å€¼å¯ä»¥å¾ˆå°å°±å¯ä»¥å¿«é€Ÿæ”¶æ•›ã€‚</p></blockquote>
<p><strong>ğŸ§ª Step 3: å®éªŒæ¼”ç¤ºæ„é€ è¿‡ç¨‹</strong></p>
<p>è®¾ $n = 12$ï¼Œé‚£ä¹ˆï¼š</p>
$$
Z = \sum_{i=1}^{12} (U_i - 0.5)
$$<p>ä¸ºä»€ä¹ˆä¹˜ $\sqrt{12}$ï¼Ÿ</p>
<p>å› ä¸ºï¼š</p>
<ul>
<li>æ¯ä¸ª $U_i - 0.5$ æ˜¯å‡å€¼ä¸º 0ã€æ–¹å·®ä¸º $1/12$ çš„å˜é‡ï¼›</li>
<li>ç›¸åŠ ä¹‹åçš„å’Œæ–¹å·®ä¸º $n \cdot \frac{1}{12}$ï¼Œ</li>
<li>ä¸ºäº†æ ‡å‡†åŒ–ï¼ˆå˜æˆæ–¹å·®ä¸º 1 çš„å˜é‡ï¼‰ï¼Œè¦ä¹˜ä»¥ $\frac{1}{\sqrt{n \cdot \frac{1}{12}}} = \sqrt{12 / n}$ã€‚</li>
</ul>
<p><strong>âœ¨ å¯¹äºæ ‡å‡†æ­£æ€é‡‡æ ·ï¼š</strong></p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ„é€ æ–¹å¼ï¼š</p>
$$
Z = \frac{1}{\sqrt{n}} \sum_{i=1}^n (U_i - \mu)
$$<ul>
<li>$U_i \sim \text{Uniform}(a,b)$ï¼ˆæˆ–å…¶ä»–åˆ†å¸ƒï¼‰</li>
<li>$\mu$ æ˜¯ $U_i$ çš„æœŸæœ›ï¼Œä¾‹å¦‚å¯¹ $U(0,1)$ æ˜¯ $0.5$</li>
<li>å½“ $n$ è¶Šå¤§æ—¶ï¼Œ$Z \approx N(0,1)$</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_normal_via_clt</span>(a<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, b<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, n<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>, num_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    åˆ©ç”¨ä¸­å¿ƒæé™å®šç†ä» Uniform(a, b) é‡‡æ ·ç”Ÿæˆè¿‘ä¼¼æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„æ ·æœ¬
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param a: Uniform åˆ†å¸ƒä¸‹ç•Œ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param b: Uniform åˆ†å¸ƒä¸Šç•Œ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param n: æ¯æ¬¡é‡‡æ ·çš„ Uniform ä¸ªæ•°
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param num_samples: æ€»å…±ç”Ÿæˆå¤šå°‘ä¸ªæ ·æœ¬
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: ä¸€ä¸ªè¿‘ä¼¼æ ‡å‡†æ­£æ€çš„æ ·æœ¬æ•°ç»„
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è®¡ç®—å‡å€¼å’Œæ ‡å‡†å·®</span>
</span></span><span style="display:flex;"><span>    mu <span style="color:#f92672">=</span> (a <span style="color:#f92672">+</span> b) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    sigma <span style="color:#f92672">=</span> (b <span style="color:#f92672">-</span> a) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">12</span>) <span style="color:#75715e"># å‡åŒ€åˆ†å¸ƒçš„æ ‡å‡†å·®</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 1: ä» Uniform(a, b) ä¸­ç”Ÿæˆ n ä¸ªæ ·æœ¬ï¼Œé‡å¤ num_samples æ¬¡</span>
</span></span><span style="display:flex;"><span>    uniform_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(a, b, size<span style="color:#f92672">=</span>(num_samples, n))
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#print(uniform_samples.shape) #(num_samples, n)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 2: å¯¹æ¯ä¸€ç»„æ ·æœ¬æ±‚å’Œå¹¶æ ‡å‡†åŒ–</span>
</span></span><span style="display:flex;"><span>    sample_sums <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sum(uniform_samples, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>) <span style="color:#75715e"># (num_samples,)</span>
</span></span><span style="display:flex;"><span>    z_samples <span style="color:#f92672">=</span> (sample_sums <span style="color:#f92672">-</span> n <span style="color:#f92672">*</span> mu) <span style="color:#f92672">/</span> (np<span style="color:#f92672">.</span>sqrt(n) <span style="color:#f92672">*</span> sigma)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> z_samples
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> sample_normal_via_clt(a<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, b<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, n<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, num_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">100000</span>)
</span></span><span style="display:flex;"><span>verify_standard_normal_sample(samples)
</span></span></code></pre></div><pre><code>Empirical mean: 0.0034 | Theoretical mean: 0
Empirical var: 1.0084 | Theoretical var: 1
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_97_1.png" alt="png"></p>
<h4 id="-æ–¹æ³•äº”æ‹’ç»é‡‡æ ·rejection-sampling">âœ… æ–¹æ³•äº”ï¼šæ‹’ç»é‡‡æ ·ï¼ˆRejection Samplingï¼‰</h4>
<ul>
<li>ä½¿ç”¨æ˜“é‡‡æ ·çš„ proposal åˆ†å¸ƒï¼ˆå¦‚ Cauchyã€Laplace ç­‰ï¼‰ï¼Œé€šè¿‡æ¥å—ç‡æ§åˆ¶ç”Ÿæˆæ ‡å‡†æ­£æ€ã€‚</li>
<li>ä¸æ¨èæ–°æ‰‹ä¸€å¼€å§‹å°±ç”¨ï¼Œä½†é€‚åˆäº†è§£å„ç§é‡‡æ ·æ¡†æ¶ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> norm, laplace
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç›®æ ‡åˆ†å¸ƒ: æ ‡å‡†æ­£æ€</span>
</span></span><span style="display:flex;"><span>target_pdf <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x: norm<span style="color:#f92672">.</span>pdf(x)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># proposal: Laplace åˆ†å¸ƒ</span>
</span></span><span style="display:flex;"><span>proposal_pdf <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x: laplace<span style="color:#f92672">.</span>pdf(x)
</span></span><span style="display:flex;"><span>proposal_sampler <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> size: laplace<span style="color:#f92672">.</span>rvs(size<span style="color:#f92672">=</span>size)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># M æ˜¯ f(x)/q(x) çš„ä¸Šç•Œï¼Œä¼°è®¡ä¸ºæœ€å¤§å€¼ï¼ˆç•¥å¤§äºå®é™…æœ€å¤§ï¼‰</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>M <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>max(target_pdf(x_vals) <span style="color:#f92672">/</span> proposal_pdf(x_vals)) <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·å‡½æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rejection_sample</span>(n):
</span></span><span style="display:flex;"><span>    samples <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> len(samples) <span style="color:#f92672">&lt;</span> n:
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> proposal_sampler(<span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        u <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> u <span style="color:#f92672">&lt;</span> target_pdf(x) <span style="color:#f92672">/</span> (M <span style="color:#f92672">*</span> proposal_pdf(x)):
</span></span><span style="display:flex;"><span>            samples<span style="color:#f92672">.</span>append(x)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>array(samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆæ ·æœ¬</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> rejection_sample(<span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯è§†åŒ–</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Sampled (AR)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, norm<span style="color:#f92672">.</span>pdf(x), label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Target N(0,1)&#34;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, M <span style="color:#f92672">*</span> proposal_pdf(x), <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;M * Proposal (M=</span><span style="color:#e6db74">{</span>M<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Rejection Sampling from N(0,1)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_99_0.png" alt="png"></p>
<h1 id="éšæœºå˜é‡çš„è®¡ç®—">éšæœºå˜é‡çš„è®¡ç®—</h1>
<h2 id="éšæœºå˜é‡å˜æ¢random-variable-transformation">éšæœºå˜é‡å˜æ¢ï¼ˆRandom Variable Transformationï¼‰</h2>
<h3 id="çº¿æ€§å˜æ¢">çº¿æ€§å˜æ¢</h3>
<p><strong>ğŸ¯ é—®é¢˜æè¿°</strong></p>
<p>è®¾ï¼š</p>
<ul>
<li>$X$ æ˜¯ä¸€ä¸ªè¿ç»­å‹éšæœºå˜é‡ï¼Œå·²çŸ¥å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆpdfï¼‰ä¸º $f_X(x)$ï¼Œ</li>
<li>$a \neq 0$, $b \in \mathbb{R}$ æ˜¯å¸¸æ•°ï¼Œ</li>
<li>å®šä¹‰ $Y = aX + b$ï¼Œ</li>
<li>æ±‚ $Y$ çš„æ¦‚ç‡å¯†åº¦å‡½æ•° $f_Y(y)$ã€‚</li>
</ul>
<p><strong>ğŸ§  åŸºæœ¬åŸç†</strong></p>
<p>è¿™æ˜¯å•è°ƒå˜æ¢ä¸‹çš„å¯†åº¦å‡½æ•°å˜æ¢è§„åˆ™ï¼š</p>
$$
f_Y(y) = f_X\left( \frac{y - b}{a} \right) \cdot \left| \frac{1}{a} \right|
$$<blockquote>
<p>âš ï¸ æ³¨æ„ç»å¯¹å€¼ç¬¦å·æ˜¯å› ä¸º $a$ æœ‰å¯èƒ½æ˜¯è´Ÿæ•°ã€‚</p></blockquote>
<p><strong>ğŸ“Œ æ¨å¯¼è¿‡ç¨‹</strong></p>
<p>æˆ‘ä»¬æ¥ç³»ç»Ÿæ¨å¯¼ä¸€ä¸‹è¿™ä¸ªå…¬å¼ã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼šä»CDFå‡ºå‘</p>
<p>å…ˆæ±‚å‡º $Y$ çš„ CDFï¼ˆç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼‰ï¼š</p>
<ul>
<li>å¦‚æœ $a > 0$ï¼š</li>
</ul>
$$
F_Y(y) = P(Y \leq y) = P(aX + b \leq y) = P\left(X \leq \frac{y - b}{a} \right) = F_X\left( \frac{y - b}{a} \right)
$$<p>ç„¶åå¯¹ $y$ æ±‚å¯¼ï¼š</p>
$$
f_Y(y) = \frac{d}{dy} F_X\left( \frac{y - b}{a} \right) = f_X\left( \frac{y - b}{a} \right) \cdot \frac{1}{a}
$$<ul>
<li>å¦‚æœ $a < 0$ï¼š</li>
</ul>
$$
F_Y(y) = P(aX + b \leq y) = P\left(X \geq \frac{y - b}{a} \right) = 1 - F_X\left( \frac{y - b}{a} \right)
$$<p>ç„¶åï¼š</p>
$$
f_Y(y) = \frac{d}{dy} \left[ 1 - F_X\left( \frac{y - b}{a} \right) \right] = -f_X\left( \frac{y - b}{a} \right) \cdot \frac{1}{a}
$$<p>å› ä¸º $a < 0$ï¼Œæ‰€ä»¥ç»“æœä»ç„¶æ˜¯ï¼š</p>
$$
f_Y(y) = f_X\left( \frac{y - b}{a} \right) \cdot \left| \frac{1}{a} \right|
$$<p><strong>âœ… ç»“è®ºï¼ˆå˜æ¢å…¬å¼ï¼‰</strong></p>
<p>ä¸ç®¡ $a > 0$ è¿˜æ˜¯ $a < 0$ï¼Œç»Ÿä¸€å…¬å¼ä¸ºï¼š</p>
$$
\boxed{
f_Y(y) = f_X\left( \frac{y - b}{a} \right) \cdot \left| \frac{1}{a} \right|
}
$$<h4 id="-ç¤ºä¾‹">ğŸ§ª ç¤ºä¾‹ï¼š$X \sim \text{Exponential}(\lambda)$ï¼Œ$Y = 2X + 3$</h4>
<p>åŸå§‹ pdfï¼š</p>
$$
f_X(x) = \lambda e^{-\lambda x}, \quad x \geq 0
$$<p>ä»¤ $Y = 2X + 3$ï¼Œé‚£ä¹ˆï¼š</p>
<ul>
<li>$a = 2$, $b = 3$</li>
<li>$ f_Y(y) = f_X\left( \frac{y - 3}{2} \right) \cdot \frac{1}{2} = \lambda e^{-\lambda \cdot \frac{y - 3}{2}} \cdot \frac{1}{2}, \quad y \geq 3$</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Parameters</span>
</span></span><span style="display:flex;"><span>lambda_ <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>  <span style="color:#75715e"># parameter for Exponential distribution</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Define the original PDF of X ~ Exp(lambda)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f_X</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> lambda_ <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>lambda_ <span style="color:#f92672">*</span> x) <span style="color:#f92672">*</span> (x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Define the transformed PDF of Y = aX + b</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f_Y</span>(y):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> (y <span style="color:#f92672">-</span> b) <span style="color:#f92672">/</span> a
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> f_X(x) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> abs(a)) <span style="color:#f92672">*</span> (y <span style="color:#f92672">&gt;=</span> b)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create x and y ranges</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">400</span>)
</span></span><span style="display:flex;"><span>y_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">400</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Evaluate PDFs</span>
</span></span><span style="display:flex;"><span>fx_vals <span style="color:#f92672">=</span> f_X(x_vals)
</span></span><span style="display:flex;"><span>fy_vals <span style="color:#f92672">=</span> f_Y(y_vals)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x_vals, fx_vals, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$f_X(x)$ (Exponential)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(y_vals, fy_vals, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$f_Y(y)$ (Transformed)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;PDF of X and Y = aX + b (a=2, b=3)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x or y&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_103_0.png" alt="png"></p>
<h3 id="éçº¿æ€§å˜æ¢nonlinear-transformation">éçº¿æ€§å˜æ¢ï¼ˆnonlinear transformationï¼‰</h3>
<p>éå¸¸å¥½ï¼è®¨è®º**éçº¿æ€§å˜æ¢ï¼ˆnonlinear transformationï¼‰**æ˜¯ç†è§£æ¦‚ç‡è®ºä¸ç»Ÿè®¡æ¨ç†çš„å…³é”®éƒ¨åˆ†ã€‚æˆ‘ä»¬åˆ†æ­¥éª¤æ·±å…¥è®²è§£ï¼š</p>
<p><strong>ğŸ§  é—®é¢˜ï¼šéçº¿æ€§å˜æ¢ä¸‹å¦‚ä½•æ±‚éšæœºå˜é‡çš„åˆ†å¸ƒï¼Ÿ</strong></p>
<p>è®¾ï¼š</p>
<ul>
<li>$X$ æ˜¯ä¸€ä¸ªå·²çŸ¥è¿ç»­å‹éšæœºå˜é‡ï¼Œæœ‰å¯†åº¦å‡½æ•° $f_X(x)$</li>
<li>å®šä¹‰æ–°å˜é‡ï¼š$Y = g(X)$ï¼Œå…¶ä¸­ $g$ æ˜¯ä¸€ä¸ª <strong>å¯å¾®çš„ã€ä¸¥æ ¼å•è°ƒçš„å‡½æ•°</strong></li>
</ul>
<p>æˆ‘ä»¬æƒ³è¦æ±‚å‡º $Y$ çš„æ¦‚ç‡å¯†åº¦å‡½æ•° $f_Y(y)$ã€‚</p>
<p><strong>ğŸ§® ç†è®ºç»“æœï¼šå˜æ¢æ³•å…¬å¼</strong></p>
<p>å¯¹äºå•è°ƒå¯å¾®å‡½æ•° $g$ï¼Œæœ‰ï¼š</p>
$$
f_Y(y) = f_X\big(g^{-1}(y)\big) \cdot \left| \frac{d}{dy} g^{-1}(y) \right|
$$<p>è¿™ä¸ªå…¬å¼è¢«ç§°ä½œ<strong>å˜æ¢æ³•ï¼ˆChange of Variablesï¼‰<strong>æˆ–</strong>åå‡½æ•°æ³•ï¼ˆInverse Methodï¼‰</strong>ã€‚</p>
<p><strong>âœ… æ­¥éª¤æ€»ç»“ï¼ˆä»¥å•è°ƒé€’å¢å‡½æ•°ä¸ºä¾‹ï¼‰</strong></p>
<ol>
<li>å†™å‡º $Y = g(X)$</li>
<li>æ¨å‡ºåå‡½æ•° $X = g^{-1}(Y)$</li>
<li>è®¡ç®—åå‡½æ•°çš„å¯¼æ•° $\frac{d}{dy} g^{-1}(y)$</li>
<li>å°†è¿™äº›ä»£å…¥å˜æ¢å…¬å¼ï¼Œå¾—å‡º $f_Y(y)$</li>
</ol>
<h4 id="-ä¸¾ä¾‹å…¶ä¸­">ğŸ“Œ ä¸¾ä¾‹ï¼š$Y = \sqrt{X}$ï¼Œå…¶ä¸­ $X \sim \text{Uniform}(0, 1)$</h4>
<p>æˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥æ“ä½œè¿™ä¸ªå˜æ¢ã€‚</p>
<ol>
<li>åŸå§‹å˜é‡ï¼š</li>
</ol>
$$
f_X(x) = 1, \quad 0 \le x \le 1
$$<ol start="2">
<li>éçº¿æ€§å˜æ¢ï¼š</li>
</ol>
$$
Y = g(X) = \sqrt{X} \Rightarrow X = g^{-1}(Y) = Y^2
$$<ol start="3">
<li>æ±‚å¯¼ï¼š</li>
</ol>
$$
\frac{d}{dy} g^{-1}(y) = \frac{d}{dy} (Y^2) = 2y
$$<ol start="4">
<li>ä»£å…¥å…¬å¼ï¼š</li>
</ol>
$$
f_Y(y) = f_X(Y^2) \cdot \left| \frac{d}{dy} Y^2 \right| = 1 \cdot 2y = 2y
$$<p>å®šä¹‰åŸŸï¼š</p>
<ul>
<li>å› ä¸º $X \in [0, 1] \Rightarrow Y \in [0, 1]$</li>
</ul>
<p>æ‰€ä»¥ï¼š</p>
$$
f_Y(y) = 
\begin{cases}
2y, & 0 \le y \le 1 \\
0, & \text{otherwise}
\end{cases}
$$<p>è¿™æ˜¯ä¸€ä¸ªä¸‰è§’å½¢å½¢çŠ¶çš„å¯†åº¦å‡½æ•°ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Define the original PDF: X ~ Uniform(0, 1)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f_X</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>ones_like(x) <span style="color:#f92672">*</span> ((x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;</span> (x <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Define the transformation: Y = sqrt(X) =&gt; X = Y^2</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f_Y</span>(y):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> y <span style="color:#f92672">*</span> ((y <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;</span> (y <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create value ranges</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#ae81ff">400</span>)
</span></span><span style="display:flex;"><span>y_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#ae81ff">400</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Evaluate PDFs</span>
</span></span><span style="display:flex;"><span>fx_vals <span style="color:#f92672">=</span> f_X(x_vals)
</span></span><span style="display:flex;"><span>fy_vals <span style="color:#f92672">=</span> f_Y(y_vals)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the PDFs</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x_vals, fx_vals, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$f_X(x)$: Uniform(0, 1)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(y_vals, fy_vals, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$f_Y(y)$: $Y = \sqrt</span><span style="color:#e6db74">{X}</span><span style="color:#e6db74">$&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;&#34;&#34;PDF Transformation: $Y = \sqrt</span><span style="color:#e6db74">{X}</span><span style="color:#e6db74">$ with $X \sim U(0, 1)$&#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x or y&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><pre><code>&lt;&gt;:24: SyntaxWarning: invalid escape sequence '\s'
&lt;&gt;:24: SyntaxWarning: invalid escape sequence '\s'
/var/folders/mx/684cy0qs5zd3c_pdx4wy4pkc0000gn/T/ipykernel_15262/4117088612.py:24: SyntaxWarning: invalid escape sequence '\s'
  plt.title(&quot;&quot;&quot;PDF Transformation: $Y = \sqrt{X}$ with $X \sim U(0, 1)$&quot;&quot;&quot;)
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_105_1.png" alt="png"></p>
<h2 id="æœŸæœ›è¿ç®—ç¬¦mean-operator">æœŸæœ›è¿ç®—ç¬¦(Mean Operator)</h2>
<h3 id="åŸºç¡€">åŸºç¡€</h3>
<p><strong>ğŸ” ä»€ä¹ˆæ˜¯ Mean Operatorï¼Ÿ</strong></p>
<p>â€œMean operatorâ€æ˜¯æŒ‡<strong>å¯¹éšæœºå˜é‡å–æœŸæœ›çš„è¿ç®—ç¬¦</strong>ã€‚
åœ¨æ¦‚ç‡è®ºä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ç¬¦å·ï¼š</p>
$$
\mathbb{E}[X]
$$<p>æ¥è¡¨ç¤ºéšæœºå˜é‡ $X$ çš„æœŸæœ›ï¼ˆä¹Ÿç§°<strong>å¹³å‡å€¼</strong>ã€<strong>æœŸæœ›å€¼</strong>ã€<strong>å‡å€¼</strong>ï¼‰ã€‚
è¿™ä¸ªè¿ç®—å¯ä»¥çœ‹æˆæ˜¯å¯¹éšæœºå˜é‡åœ¨å…¶åˆ†å¸ƒä¸‹çš„â€œåŠ æƒå¹³å‡â€ã€‚</p>
<h4 id="-ç¦»æ•£å‹éšæœºå˜é‡çš„æœŸæœ›">ğŸ“Š ç¦»æ•£å‹éšæœºå˜é‡çš„æœŸæœ›</h4>
<p>å¦‚æœ $X$ æ˜¯ä¸€ä¸ªç¦»æ•£å‹éšæœºå˜é‡ï¼Œå–å€¼ä¸º $x_1, x_2, \dots$ï¼Œæ¦‚ç‡ä¸º $P(X = x_i) = p_i$ï¼Œ
é‚£ä¹ˆå…¶æœŸæœ›ä¸ºï¼š</p>
$$
\mathbb{E}[X] = \sum_{i} x_i \cdot p_i
$$<p><strong>ä¾‹å­ï¼š</strong></p>
<p>æŠ•ä¸€æšå…¬å¹³çš„ç¡¬å¸ï¼Œä»¤ $X = 1$ è¡¨ç¤ºæ­£é¢ï¼Œ$X = 0$ è¡¨ç¤ºåé¢ï¼š</p>
$$
\mathbb{E}[X] = 1 \cdot \frac{1}{2} + 0 \cdot \frac{1}{2} = \frac{1}{2}
$$<h4 id="-è¿ç»­å‹éšæœºå˜é‡çš„æœŸæœ›">ğŸ“ˆ è¿ç»­å‹éšæœºå˜é‡çš„æœŸæœ›</h4>
<p>å¦‚æœ $X$ æ˜¯ä¸€ä¸ªè¿ç»­éšæœºå˜é‡ï¼Œå…·æœ‰æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆPDFï¼‰ $f_X(x)$ï¼Œ
é‚£ä¹ˆå…¶æœŸæœ›ä¸ºï¼š</p>
$$
\mathbb{E}[X] = \int_{-\infty}^{\infty} x \cdot f_X(x) \, dx
$$<p><strong>ä¾‹å­ï¼š</strong></p>
<p>è‹¥ $X \sim \text{Uniform}(0, 1)$ï¼Œå³ $f_X(x) = 1$ for $x \in [0, 1]$ï¼Œåˆ™ï¼š</p>
$$
\mathbb{E}[X] = \int_0^1 x \cdot 1 \, dx = \left[ \frac{1}{2}x^2 \right]_0^1 = \frac{1}{2}
$$<h4 id="-mean-operator-vs-å®é™…å¹³å‡">ğŸ” Mean Operator vs å®é™…å¹³å‡</h4>
<p>æœŸæœ›æ˜¯ç†è®ºä¸Šçš„å¹³å‡å€¼ï¼Œæ˜¯å¯¹æ•´ä¸ª<strong>æ¦‚ç‡åˆ†å¸ƒ</strong>è€Œè¨€çš„ã€‚è€Œç°å®ä¸­æˆ‘ä»¬å¾€å¾€åªèƒ½è§‚å¯Ÿåˆ°æœ‰é™çš„æ ·æœ¬ï¼š</p>
$$
\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i
$$<p>è¿™å«åš<strong>æ ·æœ¬å‡å€¼ï¼ˆsample meanï¼‰</strong>ï¼Œå®ƒæ˜¯ç”¨æ¥è¿‘ä¼¼ä¼°è®¡ $\mathbb{E}[X]$ çš„ã€‚æ ¹æ®<strong>å¤§æ•°å®šå¾‹</strong>ï¼Œå½“æ ·æœ¬æ•°é‡è¶‹è¿‘äºæ— ç©·å¤§æ—¶ï¼Œæ ·æœ¬å‡å€¼ä¼šæ”¶æ•›åˆ°ç†è®ºæœŸæœ›ã€‚</p>
<h4 id="-mean-operator-çš„æ€§è´¨çº¿æ€§">ğŸ§® Mean Operator çš„æ€§è´¨ï¼ˆçº¿æ€§ï¼‰</h4>
<p>è®¾ $X, Y$ æ˜¯éšæœºå˜é‡ï¼Œ$a, b$ æ˜¯å¸¸æ•°ï¼Œåˆ™ï¼š</p>
<ol>
<li>çº¿æ€§æ€§ï¼ˆLinearityï¼‰ï¼š</li>
</ol>
$$
\mathbb{E}[aX + bY] = a \mathbb{E}[X] + b \mathbb{E}[Y]
$$<ol start="2">
<li>æ’ç­‰å‡½æ•°çš„æœŸæœ›ï¼š</li>
</ol>
$$
\mathbb{E}[c] = c \quad \text{(å¸¸æ•°çš„æœŸæœ›å°±æ˜¯å®ƒæœ¬èº«)}
$$<h5 id="å¯¹äºå‡½æ•°çš„æœŸæœ›">å¯¹äºå‡½æ•°çš„æœŸæœ›</h5>
<p>è®¾ $X$ æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œæˆ‘ä»¬å¸Œæœ›è®¡ç®— $g(X)$ çš„æœŸæœ›ï¼š</p>
$$
\mathbb{E}[g(X)]
$$<h6 id="-ç¦»æ•£å‹æ¨å¯¼">âœ… ç¦»æ•£å‹æ¨å¯¼</h6>
<p>å‡è®¾ $X$ æ˜¯ç¦»æ•£å‹éšæœºå˜é‡ï¼Œå–å€¼é›†åˆä¸º $\{x_1, x_2, \dots, x_n\}$ï¼Œæ¦‚ç‡è´¨é‡å‡½æ•°ä¸º $p(x_i) = P(X = x_i)$ã€‚</p>
<p>æˆ‘ä»¬è¦è®¡ç®— $\mathbb{E}[g(X)]$ï¼Œæ„æ€æ˜¯å¯¹æ¯ä¸ªå¯èƒ½çš„å–å€¼ $x_i$ï¼Œå–å‡½æ•°å€¼ $g(x_i)$ï¼Œå†ä¹˜ä»¥å…¶å‡ºç°çš„æ¦‚ç‡ï¼Œå†åŠ æ€»èµ·æ¥ã€‚</p>
<p><strong>ğŸ” æ¨å¯¼ï¼š</strong></p>
$$
\mathbb{E}[g(X)] = \sum_{i=1}^{n} g(x_i) \cdot P(X = x_i)
$$<blockquote>
<p>âœ… æœ¬è´¨æ˜¯â€œå¯¹éšæœºå˜é‡å‡½æ•°å€¼çš„åŠ æƒå¹³å‡â€ï¼Œæƒé‡å°±æ˜¯å…¶å‘ç”Ÿæ¦‚ç‡ã€‚</p></blockquote>
<h6 id="-è¿ç»­å‹æ¨å¯¼">âœ… è¿ç»­å‹æ¨å¯¼ï¼š</h6>
<p>è®¾ $X$ æ˜¯è¿ç»­å‹éšæœºå˜é‡ï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º $f_X(x)$ï¼Œæˆ‘ä»¬å¸Œæœ›è®¡ç®— $\mathbb{E}[g(X)]$ã€‚</p>
<p><strong>ğŸ” æ¨å¯¼ï¼š</strong></p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç§¯åˆ†çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰å¯èƒ½çš„ $x$ ä¸Šçš„ $g(x)$ å€¼è¿›è¡ŒåŠ æƒå¹³å‡ï¼Œæƒé‡æ˜¯ $f_X(x)$ï¼š</p>
$$
\mathbb{E}[g(X)] = \int_{-\infty}^{\infty} g(x) \cdot f_X(x) \, dx
$$<blockquote>
<p>âœ… æœ¬è´¨ä¸Šä»ç„¶æ˜¯â€œåŠ æƒå¹³å‡â€ï¼šå¯¹æ¯ä¸ªå¯èƒ½çš„ $x$ï¼Œç”¨å¯†åº¦å‡½æ•°ç»™å‡ºçš„æƒé‡ã€‚</p></blockquote>
<h6 id="-ä¸¾ä¾‹è®²è§£">ğŸ“Œ ä¸¾ä¾‹è®²è§£</h6>
<p>ä¾‹å­ä¸€ï¼šğŸ² ç¦»æ•£å‹ä¾‹å­ã€‚</p>
<p>è®¾ $X$ æ˜¯æ·ä¸€ä¸ªå››é¢éª°å­çš„ç»“æœï¼ˆå‡åŒ€ç¦»æ•£åˆ†å¸ƒï¼‰ï¼Œå–å€¼ä¸º $\{1,2,3,4\}$ï¼Œæ¯ä¸ªæ¦‚ç‡ $p(x) = 1/4$ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰ $g(X) = X^2$ï¼Œè®¡ç®—å…¶æœŸæœ›ï¼š</p>
$$
\mathbb{E}[X^2] = \sum_{x=1}^{4} x^2 \cdot \frac{1}{4} = \frac{1}{4}(1^2 + 2^2 + 3^2 + 4^2) = \frac{1}{4}(1 + 4 + 9 + 16) = \frac{30}{4} = 7.5
$$<hr>
<p>ä¾‹å­äºŒï¼šğŸ“ˆ è¿ç»­å‹ä¾‹å­ã€‚</p>
<p>è®¾ $X \sim \text{Uniform}(0, 1)$ï¼Œå¯†åº¦å‡½æ•° $f_X(x) = 1$ for $x \in [0, 1]$ã€‚</p>
<p>å–å‡½æ•° $g(x) = x^2$ï¼Œè®¡ç®—ï¼š</p>
$$
\mathbb{E}[X^2] = \int_0^1 x^2 \cdot 1 \, dx = \left[ \frac{x^3}{3} \right]_0^1 = \frac{1}{3}
$$<hr>
<h6 id="-ä¸ç›´æ¥æœŸæœ›çš„åŒºåˆ«">ğŸ” ä¸ç›´æ¥æœŸæœ›çš„åŒºåˆ«</h6>
<ul>
<li>$\mathbb{E}[X]$ï¼šæ˜¯åŸå§‹éšæœºå˜é‡çš„æœŸæœ›ï¼›</li>
<li>$\mathbb{E}[g(X)]$ï¼šæ˜¯å¯¹ $X$ åšå‡½æ•°å˜æ¢åçš„æœŸæœ›ï¼Œ<strong>ä¸ç­‰äº</strong> $g(\mathbb{E}[X])$ï¼ˆé™¤é $g$ æ˜¯çº¿æ€§å‡½æ•°ï¼‰ï¼</li>
</ul>
<p>ä¾‹å¦‚ä¸Šä¾‹ä¸­ï¼š</p>
<ul>
<li>$\mathbb{E}[X] = 0.5$ï¼Œ</li>
<li>$g(x) = x^2$ï¼Œ</li>
<li>$g(\mathbb{E}[X]) = (0.5)^2 = 0.25 \neq \mathbb{E}[X^2] = \frac{1}{3}$</li>
</ul>
<hr>
<h6 id="-æ€»ç»“">ğŸ“š æ€»ç»“</h6>
<table>
  <thead>
      <tr>
          <th>ç±»å‹</th>
          <th>å®šä¹‰</th>
          <th>å…¬å¼</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ç¦»æ•£å‹</td>
          <td>$\mathbb{E}[g(X)] = \sum g(x_i) \cdot P(X = x_i)$</td>
          <td>åŠ æƒå¹³å‡</td>
      </tr>
      <tr>
          <td>è¿ç»­å‹</td>
          <td>$\mathbb{E}[g(X)] = \int g(x) \cdot f_X(x) \, dx$</td>
          <td>åŠ æƒç§¯åˆ†</td>
      </tr>
  </tbody>
</table>
<h2 id="è¯¯å·®ä¼ æ’­æ³•åˆ™propagation-laws">è¯¯å·®ä¼ æ’­æ³•åˆ™ï¼ˆPropagation Lawsï¼‰</h2>
<p><strong>Propagation laws</strong>ï¼ˆè¯¯å·®ä¼ æ’­å®šå¾‹ï¼‰ï¼Œä¹Ÿå«ä½œ<strong>uncertainty propagation</strong>ï¼Œæ˜¯æŒ‡å½“ä½ é€šè¿‡æŸä¸ªå‡½æ•° $Y = g(X_1, X_2, \dots, X_n)$ æ¥è®¡ç®—ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¦‚æœè¾“å…¥å˜é‡ $X_i$ éƒ½æœ‰ä¸ç¡®å®šæ€§ï¼ˆé€šå¸¸ä»¥æ–¹å·®æˆ–æ ‡å‡†å·®è¡¨ç¤ºï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬æƒ³çŸ¥é“è¾“å‡ºå˜é‡ $Y$ çš„ä¸ç¡®å®šæ€§æ˜¯å¤šå°‘ã€‚</p>
<p>è¿™å¥—ç†è®ºçš„æ ¸å¿ƒæ˜¯å¦‚ä½•æ¨å¯¼ï¼š</p>
$$
\text{Var}(Y) \quad \text{æˆ–è€…} \quad \sigma_Y
$$<h3 id="-ä¸€å…ƒæƒ…å½¢åªæœ‰ä¸€ä¸ªå˜é‡">âœ… ä¸€å…ƒæƒ…å½¢ï¼ˆåªæœ‰ä¸€ä¸ªå˜é‡ï¼‰</h3>
<p>]
è®¾ $Y = g(X)$ï¼Œè€Œ $X$ æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œå‡å€¼ $\mu_X$ï¼Œæ–¹å·® $\sigma_X^2$ï¼Œ</p>
<p>å¦‚æœ $g$ æ˜¯å…‰æ»‘å‡½æ•°ï¼ˆå¯å¾®ï¼‰ï¼Œå¹¶ä¸” $X$ çš„æ³¢åŠ¨ä¸å¤§ï¼Œå¯ä»¥ä½¿ç”¨ä¸€é˜¶æ³°å‹’å±•å¼€è¿‘ä¼¼ï¼š</p>
$$
Y \approx g(\mu_X) + g'(\mu_X)(X - \mu_X)
$$<p>äºæ˜¯å¯ä»¥è¿‘ä¼¼å¾—åˆ°ï¼š</p>
$$
\boxed{\text{Var}(Y) \approx \left(g'(\mu_X)\right)^2 \cdot \text{Var}(X)}
$$<h3 id="-å¤šå…ƒæƒ…å½¢å¤šä¸ªè¾“å…¥å˜é‡">âœ… å¤šå…ƒæƒ…å½¢ï¼ˆå¤šä¸ªè¾“å…¥å˜é‡ï¼‰</h3>
<p>è®¾è¾“å‡ºå˜é‡ï¼š</p>
$$
Y = g(X_1, X_2, \dots, X_n)
$$<p>æˆ‘ä»¬å¯ä»¥å±•å¼€ä¸€é˜¶<a href="https://en.wikipedia.org/wiki/Taylor_series">æ³°å‹’å±•å¼€å¼</a>ï¼š</p>
$$
Y \approx g(\boldsymbol{\mu}) + \sum_{i=1}^{n} \frac{\partial g}{\partial x_i} (X_i - \mu_i)
$$<p>äºæ˜¯å¾—åˆ°æ–¹å·®çš„è¿‘ä¼¼ä¼ æ’­å¼ï¼š</p>
$$
\boxed{\text{Var}(Y) \approx \sum_{i=1}^{n} \left(\frac{\partial g}{\partial x_i}\right)^2 \cdot \text{Var}(X_i) + 2 \sum_{i < j} \frac{\partial g}{\partial x_i} \cdot \frac{\partial g}{\partial x_j} \cdot \text{Cov}(X_i, X_j)}
$$<ul>
<li>å¦‚æœ $X_1, \dots, X_n$ <strong>ç‹¬ç«‹</strong>ï¼Œåæ–¹å·®é¡¹ä¸º 0ï¼Œç®€åŒ–ä¸ºï¼š</li>
</ul>
$$
\boxed{\text{Var}(Y) \approx \sum_{i=1}^{n} \left(\frac{\partial g}{\partial x_i}\right)^2 \cdot \text{Var}(X_i)}
$$<h3 id="-ç¤ºä¾‹è®²è§£">ğŸ“ ç¤ºä¾‹è®²è§£</h3>
<h4 id="-ä¾‹å­-1ä¹˜æ³•ä¼ æ’­">ğŸ¯ ä¾‹å­ 1ï¼šä¹˜æ³•ä¼ æ’­</h4>
<p>è®¾ $Y = XY$ï¼Œå…¶ä¸­ $X \sim N(\mu_X, \sigma_X^2)$ï¼Œ$Y \sim N(\mu_Y, \sigma_Y^2)$ï¼Œä¸” $X, Y$ ç‹¬ç«‹ã€‚</p>
<ul>
<li>$g(X, Y) = XY$</li>
</ul>
<p>æˆ‘ä»¬æœ‰ï¼š</p>
<ul>
<li>$\frac{\partial g}{\partial X} = Y$</li>
<li>$\frac{\partial g}{\partial Y} = X$</li>
</ul>
<p>ä»£å…¥ä¼ æ’­å…¬å¼ï¼ˆç”¨æœŸæœ›è¿‘ä¼¼å¯¼æ•°ï¼‰ï¼š</p>
$$
\text{Var}(XY) \approx (\mu_Y)^2 \sigma_X^2 + (\mu_X)^2 \sigma_Y^2
$$<hr>
<h4 id="-ä¾‹å­-2æ¸©åº¦æ¢ç®—çº¿æ€§å˜æ¢">ğŸ“Š ä¾‹å­ 2ï¼šæ¸©åº¦æ¢ç®—ï¼ˆçº¿æ€§å˜æ¢ï¼‰</h4>
<p>æ‘„æ°æ¸©åº¦ $C \sim N(\mu, \sigma^2)$ï¼Œæ¢ç®—æˆåæ°æ¸©åº¦ï¼š</p>
$$
F = 1.8 C + 32
$$<p>ç”±äºæ˜¯çº¿æ€§å˜æ¢ï¼Œç›´æ¥ä½¿ç”¨å…¬å¼ï¼š</p>
$$
\text{Var}(F) = (1.8)^2 \cdot \text{Var}(C)
$$<hr>
<h3 id="-å°ç»“è¡¨æ ¼">ğŸ“Œ å°ç»“è¡¨æ ¼</h3>
<table>
  <thead>
      <tr>
          <th>å½¢å¼</th>
          <th>æè¿°</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>ä¸€å…ƒå˜æ¢</td>
          <td>$\text{Var}(Y) \approx (g'(\mu))^2 \cdot \text{Var}(X)$</td>
      </tr>
      <tr>
          <td>å¤šå…ƒç‹¬ç«‹å˜é‡</td>
          <td>$\text{Var}(Y) \approx \sum (\partial g / \partial x_i)^2 \cdot \text{Var}(X_i)$</td>
      </tr>
      <tr>
          <td>å¤šå…ƒç›¸å…³å˜é‡</td>
          <td>åŠ ä¸Šåæ–¹å·®é¡¹</td>
      </tr>
      <tr>
          <td>çº¿æ€§å˜æ¢</td>
          <td>ç²¾ç¡®æˆç«‹ï¼š$Y = aX + b \Rightarrow \text{Var}(Y) = a^2 \cdot \text{Var}(X)$</td>
      </tr>
  </tbody>
</table>
<hr>
<h3 id="-æ³¨æ„äº‹é¡¹">âš ï¸ æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>è¯¥æ–¹æ³•æ˜¯<strong>è¿‘ä¼¼</strong>æ–¹æ³•ï¼Œå‡†ç¡®æ€§å–å†³äºå‡½æ•°åœ¨å±€éƒ¨çš„çº¿æ€§ç¨‹åº¦ï¼›</li>
<li>é€‚ç”¨äºè¾“å…¥è¯¯å·®<strong>è¾ƒå°</strong>çš„æƒ…å†µï¼›</li>
<li>æ›´é«˜é˜¶è¯¯å·®å¯ä»¥ç”¨<strong>äºŒé˜¶æ³°å‹’å±•å¼€</strong>æ”¹è¿›ï¼›</li>
<li>è‹¥åˆ†å¸ƒä¸æ˜¯æ­£æ€åˆ†å¸ƒï¼Œç»“æœä¾ç„¶æ˜¯è¿‘ä¼¼çš„ã€‚</li>
</ul>
<h3 id="ä¸ºä»€ä¹ˆå¯ä»¥ç”¨-x-åœ¨å‡å€¼é™„è¿‘çš„çº¿æ€§è¿‘ä¼¼">ä¸ºä»€ä¹ˆå¯ä»¥ç”¨ X åœ¨å‡å€¼é™„è¿‘çš„çº¿æ€§è¿‘ä¼¼ï¼Ÿ</h3>
<p>æˆ‘ä»¬è¯´ï¼š</p>
<blockquote>
<p>è®¾éšæœºå˜é‡ $X$ æœ‰å‡å€¼ $\mu_X$ï¼Œå‡½æ•° $Y = g(X)$ï¼Œ
é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ <strong>X åœ¨å‡å€¼é™„è¿‘çš„çº¿æ€§è¿‘ä¼¼</strong>ï¼š</p></blockquote>
$$
g(X) \approx g(\mu_X) + g'(\mu_X)(X - \mu_X)
$$<p>ä½ é—®çš„æ˜¯ï¼š<strong>è¿™ä¸€æ­¥ä¸ºä»€ä¹ˆå¯ä»¥è¿™ä¹ˆåšï¼Ÿæœ‰ä»€ä¹ˆä¾æ®ï¼Ÿ</strong></p>
<p>âœ… è¿™ä¸€æ­¥å…¶å®æ˜¯ä½¿ç”¨äº†â€œæ³°å‹’ä¸€é˜¶å±•å¼€â€ï¼ˆTaylor Expansionï¼‰</p>
<h4 id="-1-ä»€ä¹ˆæ˜¯æ³°å‹’å±•å¼€">ğŸŒŸ 1. ä»€ä¹ˆæ˜¯æ³°å‹’å±•å¼€ï¼Ÿ</h4>
<p>æ³°å‹’å±•å¼€æ˜¯ç”¨ä¸€ä¸ªå‡½æ•°åœ¨æŸç‚¹çš„å¯¼æ•°ä¿¡æ¯ï¼Œè¿‘ä¼¼è¡¨ç¤ºè¿™ä¸ªå‡½æ•°åœ¨é™„è¿‘çš„å€¼ã€‚</p>
<p>å¯¹ä¸€ä¸ªå¯å¯¼å‡½æ•° $g(x)$ï¼Œåœ¨ç‚¹ $x = a$ å¤„è¿›è¡Œæ³°å‹’å±•å¼€ï¼Œæœ‰ï¼š</p>
$$
g(x) = g(a) + g'(a)(x - a) + \frac{g''(a)}{2!}(x - a)^2 + \cdots
$$<p>å¦‚æœæˆ‘ä»¬åªä¿ç•™<strong>ä¸€é˜¶é¡¹</strong>ï¼ˆä¹Ÿå°±æ˜¯å¯¼æ•°é‚£ä¸€é¡¹ï¼‰ï¼Œå°±å«ï¼š</p>
$$
\boxed{
g(x) \approx g(a) + g'(a)(x - a)
}
\quad \text{ï¼ˆä¸€é˜¶æ³°å‹’å±•å¼€ï¼‰}
$$<h4 id="-2-ä¸ºä»€ä¹ˆåœ¨è¯¯å·®ä¼ æ’­é‡Œè¿™ä¹ˆç”¨">ğŸŒŸ 2. ä¸ºä»€ä¹ˆåœ¨è¯¯å·®ä¼ æ’­é‡Œè¿™ä¹ˆç”¨ï¼Ÿ</h4>
<p>è®¾ $X$ æ˜¯ä¸€ä¸ª<strong>å¸¦å™ªå£°çš„è¾“å…¥é‡</strong>ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒçš„å‡å€¼æ˜¯ $\mu_X$ï¼Œæ–¹å·®æ˜¯ $\sigma_X^2$ï¼Œä½†å®ƒæ€»æœ‰ä¸€äº›æ³¢åŠ¨ã€‚</p>
<p>æˆ‘ä»¬å…³å¿ƒçš„æ˜¯ï¼šå½“ $X$ åœ¨ $\mu_X$ é™„è¿‘æ³¢åŠ¨æ—¶ï¼Œè¾“å‡º $Y = g(X)$ ä¼šæ€æ ·æ³¢åŠ¨ï¼Ÿ</p>
<p>äºæ˜¯æˆ‘ä»¬åœ¨ $\mu_X$ é™„è¿‘è¿›è¡Œçº¿æ€§è¿‘ä¼¼ï¼š</p>
$$
g(X) \approx g(\mu_X) + g'(\mu_X)(X - \mu_X)
$$<p>è¿™ä¸ªå¼å­çš„æ„ä¹‰æ˜¯ï¼š</p>
<ul>
<li>$g(\mu_X)$ï¼šæ˜¯å¹³å‡è¾“å‡º</li>
<li>$g'(\mu_X)(X - \mu_X)$ï¼šæ˜¯è¾“å…¥ $X$ æ³¢åŠ¨å¸¦æ¥çš„<strong>çº¿æ€§å˜åŒ–</strong></li>
</ul>
<p>è¿™ç§çº¿æ€§é€¼è¿‘åœ¨ $X$ å˜åŠ¨ä¸å¤§çš„æ—¶å€™æ˜¯å¾ˆåˆç†çš„ â€”â€” å°±åƒæˆ‘ä»¬ç”»å›¾æ—¶ç”¨ç›´çº¿è¿‘ä¼¼æ›²çº¿çš„ä¸€å°æ®µã€‚</p>
<h4 id="-å›¾åƒç›´è§‚ç†è§£">ğŸ“ˆ å›¾åƒç›´è§‚ç†è§£</h4>
<ol>
<li>ç”»ä¸€æ¡å‡½æ•°æ›²çº¿ $y = g(x)$ï¼Œæ¯”å¦‚ $g(x) = \log x$</li>
<li>åœ¨ $x = \mu_X$ ç”»ä¸€æ¡åˆ‡çº¿</li>
<li>çœ‹çœ‹è¿™æ¡åˆ‡çº¿åœ¨é™„è¿‘æ˜¯å¦ä¸åŸå‡½æ•°å·®ä¸å¤š</li>
</ol>
<p>è¿™å°±æ˜¯æ³°å‹’å±•å¼€çš„ä¸€é˜¶é€¼è¿‘ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ï¼š</p>
<blockquote>
<p>å¦‚æœä½ åªå…³å¿ƒâ€œå‡½æ•°åœ¨å¹³å‡ç‚¹é™„è¿‘æ˜¯æ€ä¹ˆå˜çš„â€ï¼Œé‚£ä¹ˆåªçœ‹å¯¼æ•°ï¼ˆæ–œç‡ï¼‰å°±è¶³å¤Ÿã€‚</p></blockquote>
<h4 id="-ä¸ºä»€ä¹ˆä¸€é˜¶å°±è¶³å¤Ÿ">ğŸ” ä¸ºä»€ä¹ˆä¸€é˜¶å°±è¶³å¤Ÿï¼Ÿ</h4>
<p>å› ä¸ºæˆ‘ä»¬å…³æ³¨çš„æ˜¯<strong>æ–¹å·®</strong>çš„ä¼ æ’­ï¼š</p>
<ul>
<li>æ–¹å·®åªå–å†³äºå‡½æ•°çš„<strong>ä¸€é˜¶å˜åŒ–é€Ÿåº¦</strong>ï¼Œå³ $g'(x)$ï¼›</li>
<li>å¦‚æœä½ ä¿ç•™é«˜é˜¶é¡¹ï¼Œæ¯”å¦‚ $(x - \mu)^2$ï¼Œä½ éœ€è¦çŸ¥é“é«˜é˜¶å¯¼æ•°ï¼Œåˆ†æä¼šå¤æ‚å¾ˆå¤šï¼›</li>
<li>åœ¨è¯¯å·®å¾ˆå°ï¼ˆå³ $X$ çš„æ³¢åŠ¨å¾ˆå°ï¼‰æ—¶ï¼Œä¸€é˜¶é¡¹å°±ä¸»å¯¼äº†è¯¯å·®ä¼ æ’­çš„è¡Œä¸ºã€‚</li>
</ul>
<h4 id="-æ€»ç»“ä¸€å¥è¯">âœ… æ€»ç»“ä¸€å¥è¯ï¼š</h4>
<p>æˆ‘ä»¬ç”¨ï¼š</p>
$$
g(X) \approx g(\mu_X) + g'(\mu_X)(X - \mu_X)
$$<p>æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>è¿™æ˜¯<strong>ä¸€é˜¶æ³°å‹’å±•å¼€</strong>ï¼Œç”¨äºåœ¨ $\mu_X$ é™„è¿‘é€¼è¿‘å‡½æ•°ï¼›</li>
<li>å½“è¾“å…¥è¯¯å·®å¾ˆå°æ—¶ï¼Œè¿™æ˜¯éå¸¸å¥½çš„è¿‘ä¼¼ï¼›</li>
<li>è¿™ä¸ªé€¼è¿‘èƒ½å¸®åŠ©æˆ‘ä»¬åˆ†æè¾“å‡º $Y$ çš„æ³¢åŠ¨ï¼ˆå³æ–¹å·®ï¼‰æ˜¯å¦‚ä½•ç”±è¾“å…¥ $X$ çš„æ³¢åŠ¨é€ æˆçš„ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å®šä¹‰éçº¿æ€§å‡½æ•°å’Œå®ƒçš„å¯¼æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">g</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>log(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">g_prime</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å–å‡å€¼ç‚¹ mu</span>
</span></span><span style="display:flex;"><span>mu <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">2.0</span>, <span style="color:#ae81ff">400</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŸå‡½æ•°å€¼</span>
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> g(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¸€é˜¶çº¿æ€§è¿‘ä¼¼ï¼šåœ¨ mu é™„è¿‘</span>
</span></span><span style="display:flex;"><span>y_approx <span style="color:#f92672">=</span> g(mu) <span style="color:#f92672">+</span> g_prime(mu) <span style="color:#f92672">*</span> (x <span style="color:#f92672">-</span> mu)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç»˜å›¾</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$g(x) = \log(x)$&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y_approx, <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Linear approximation at $\mu=1$&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>axvline(mu, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;:&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$\mu_X$&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ ‡è®°ç‚¹</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter([mu], [g(mu)], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, zorder<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>text(mu<span style="color:#f92672">+</span><span style="color:#ae81ff">0.02</span>, g(mu)<span style="color:#f92672">+</span><span style="color:#ae81ff">0.1</span>, <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;$g(\mu_X)$&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Function $g(x)$ and Its Linear Approximation at $\mu_X$&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;g(x)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><pre><code>&lt;&gt;:24: SyntaxWarning: invalid escape sequence '\m'
&lt;&gt;:31: SyntaxWarning: invalid escape sequence '\m'
&lt;&gt;:24: SyntaxWarning: invalid escape sequence '\m'
&lt;&gt;:31: SyntaxWarning: invalid escape sequence '\m'
/var/folders/mx/684cy0qs5zd3c_pdx4wy4pkc0000gn/T/ipykernel_15262/692038390.py:24: SyntaxWarning: invalid escape sequence '\m'
  plt.plot(x, y_approx, '--', label='Linear approximation at $\mu=1$', color='red')
/var/folders/mx/684cy0qs5zd3c_pdx4wy4pkc0000gn/T/ipykernel_15262/692038390.py:31: SyntaxWarning: invalid escape sequence '\m'
  plt.title('Function $g(x)$ and Its Linear Approximation at $\mu_X$')
</code></pre>
<p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_110_1.png" alt="png"></p>
<h2 id="æ ·æœ¬å‡å€¼ç®—å­sample-mean-operator">æ ·æœ¬å‡å€¼ç®—å­ï¼ˆSample mean operatorï¼‰</h2>
<p>åœ¨ç»Ÿè®¡ä¸­ï¼Œ<strong>sample mean operator</strong> å°±æ˜¯å°†ä¸€ä¸ªéšæœºå˜é‡çš„è‹¥å¹²ä¸ªç‹¬ç«‹æ ·æœ¬æ±‚å¹³å‡çš„æ“ä½œï¼š</p>
<p>ç»™å®šæŸä¸ªéšæœºå˜é‡ $X$ï¼Œæˆ‘ä»¬ä»ä¸­ç‹¬ç«‹é‡‡æ · $n$ ä¸ªæ ·æœ¬ï¼š</p>
$$
X_1, X_2, \dots, X_n \sim \text{i.i.d. from } X
$$<p>åˆ™æ ·æœ¬å‡å€¼ï¼ˆsample meanï¼‰å®šä¹‰ä¸ºï¼š</p>
$$
\bar{X}_n = \frac{1}{n} \sum_{i=1}^{n} X_i
$$<p>è¿™ä¸ªæ“ä½œå°±å«åš sample mean operatorï¼šå®ƒæ¥å—ä¸€ä¸ªæ ·æœ¬åºåˆ—ï¼Œè¾“å‡ºå¹³å‡å€¼ã€‚</p>
<blockquote>
<p><strong>Sample mean operator æ˜¯ä»æ•°æ®ä¸­ä¼°è®¡æ€»ä½“å‡å€¼çš„æœ€åŸºæœ¬å·¥å…·ï¼Œå…·æœ‰æ— åæ€§ã€æ–¹å·®éšæ ·æœ¬æ•°é™ä½ã€é›†ä¸­æ€§å’Œæ­£æ€æ€§ç­‰é‡è¦æ€§è´¨ã€‚</strong></p></blockquote>
<h3 id="-sample-mean-çš„é‡è¦æ€§è´¨">ğŸ“Œ sample mean çš„é‡è¦æ€§è´¨</h3>
<h4 id="1-æ— åæ€§unbiasedness">1. <strong>æ— åæ€§ï¼ˆUnbiasednessï¼‰</strong></h4>
$$
\mathbb{E}[\bar{X}_n] = \mathbb{E}\left[\frac{1}{n} \sum_{i=1}^n X_i\right] = \frac{1}{n} \sum_{i=1}^n \mathbb{E}[X_i] = \mu
$$<p>ğŸ‘‰ è¯´æ˜ï¼šæ ·æœ¬å‡å€¼æ˜¯æ€»ä½“å‡å€¼çš„æ— åä¼°è®¡ã€‚</p>
<h4 id="2-æ–¹å·®">2. <strong>æ–¹å·®</strong></h4>
$$
\mathrm{Var}[\bar{X}_n] = \frac{1}{n^2} \sum_{i=1}^n \mathrm{Var}[X_i] = \frac{\sigma^2}{n}
$$<p>ğŸ‘‰ æ„ä¹‰ï¼šæ ·æœ¬å‡å€¼çš„æ–¹å·®éšç€æ ·æœ¬æ•°å¢åŠ è€Œå‡å°ã€‚</p>
<h4 id="3-é›†ä¸­æ€§å¤§æ•°å®šå¾‹">3. <strong>é›†ä¸­æ€§ï¼ˆå¤§æ•°å®šå¾‹ï¼‰</strong></h4>
<p>æ ¹æ®<strong>å¤§æ•°å®šå¾‹</strong>ï¼ˆLaw of Large Numbersï¼‰ï¼š</p>
$$
\bar{X}_n \xrightarrow{a.s.} \mu \quad \text{as } n \to \infty
$$<p>ğŸ‘‰ æ„ä¹‰ï¼šæ ·æœ¬å‡å€¼å‡ ä¹å¿…ç„¶æ”¶æ•›åˆ°æ€»ä½“å‡å€¼ã€‚</p>
<hr>
<h4 id="4-è¿‘ä¼¼æ­£æ€åˆ†å¸ƒä¸­å¿ƒæé™å®šç†">4. <strong>è¿‘ä¼¼æ­£æ€åˆ†å¸ƒï¼ˆä¸­å¿ƒæé™å®šç†ï¼‰</strong></h4>
<p>å½“ $n$ å¾ˆå¤§æ—¶ï¼Œæ ¹æ®ä¸­å¿ƒæé™å®šç†ï¼š</p>
$$
\bar{X}_n \approx \mathcal{N}\left(\mu, \frac{\sigma^2}{n} \right)
$$<p>ğŸ‘‰ æ„ä¹‰ï¼šæ— è®ºåŸå§‹åˆ†å¸ƒå¦‚ä½•ï¼Œæ ·æœ¬å‡å€¼åœ¨å¤§æ ·æœ¬ä¸‹è¿‘ä¼¼æœä»æ­£æ€åˆ†å¸ƒã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å‡è®¾åŸå§‹åˆ†å¸ƒ X æ˜¯æŒ‡æ•°åˆ†å¸ƒï¼ˆä¸æ˜¯æ­£æ€ï¼‰</span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>exponential(scale<span style="color:#f92672">=</span><span style="color:#ae81ff">1.0</span>, size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10000</span>,))  <span style="color:#75715e"># åŸå§‹æ ·æœ¬</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¸åŒæ ·æœ¬æ•°é‡ä¸‹çš„ sample mean</span>
</span></span><span style="display:flex;"><span>sample_sizes <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">100</span>]
</span></span><span style="display:flex;"><span>means <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> sample_sizes:
</span></span><span style="display:flex;"><span>    sample_means <span style="color:#f92672">=</span> [np<span style="color:#f92672">.</span>mean(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>choice(X, n, replace<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1000</span>)]
</span></span><span style="display:flex;"><span>    means<span style="color:#f92672">.</span>append(sample_means)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯è§†åŒ–ä¸åŒ n ä¸‹çš„ sample mean åˆ†å¸ƒ</span>
</span></span><span style="display:flex;"><span>fig, axs <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, len(sample_sizes), figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, n <span style="color:#f92672">in</span> enumerate(sample_sizes):
</span></span><span style="display:flex;"><span>    axs[i]<span style="color:#f92672">.</span>hist(means[i], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;skyblue&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    axs[i]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;n=</span><span style="color:#e6db74">{</span>n<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    axs[i]<span style="color:#f92672">.</span>axvline(np<span style="color:#f92672">.</span>mean(X), color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;True Mean&#39;</span>)
</span></span><span style="display:flex;"><span>    axs[i]<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#39;Sample Mean Distribution as Sample Size Increases&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_112_0.png" alt="png"></p>
<h3 id="åˆ©ç”¨-sample-mean-operator-æ¥è¿‘ä¼¼è®¡ç®—ä¸€äº›æ— æ³•è§£ææ±‚è§£çš„ç§¯åˆ†">åˆ©ç”¨ sample mean operator æ¥è¿‘ä¼¼è®¡ç®—ä¸€äº›æ— æ³•è§£ææ±‚è§£çš„ç§¯åˆ†</h3>
<p>è¿™å…¶å®å°±æ˜¯<strong>è’™ç‰¹å¡æ´›ç§¯åˆ†ï¼ˆMonte Carlo Integrationï¼‰<strong>çš„æ ¸å¿ƒæ€æƒ³ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ sample mean operator æ¥</strong>è¿‘ä¼¼è®¡ç®—ä¸€äº›æ— æ³•è§£ææ±‚è§£çš„ç§¯åˆ†</strong>ï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜ç»´æˆ–å¤æ‚å‡½æ•°æƒ…å½¢ä¸‹ã€‚</p>
<p><strong>ğŸ§  æ€è·¯æ€»è§ˆï¼šç”¨æ ·æœ¬å‡å€¼è¿‘ä¼¼ç§¯åˆ†</strong></p>
<p>è®¾æˆ‘ä»¬æƒ³è®¡ç®—ä¸€ä¸ªç§¯åˆ†ï¼š</p>
$$
I = \int_a^b f(x)\,dx
$$<p>è‹¥è¿™ä¸ªç§¯åˆ†æ— æ³•è§£ææ±‚å‡ºï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆæœŸæœ›ï¼š</p>
$$
I = (b - a) \cdot \mathbb{E}_{X \sim \mathcal{U}(a, b)}[f(X)]
$$<p>å…¶ä¸­ï¼Œ$X$ æ˜¯å‡åŒ€éšæœºå˜é‡</p>
<h4 id="-ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·å˜">âœ… ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·å˜ï¼Ÿ</h4>
<p>å¦‚æœ $X \sim \mathcal{U}(a, b)$ï¼Œé‚£ä¹ˆå®ƒçš„å¯†åº¦æ˜¯ï¼š</p>
$$
p(x) = \frac{1}{b-a}, \quad x \in [a, b]
$$<p>æ‰€ä»¥ï¼š</p>
$$
\mathbb{E}[f(X)] = \int_a^b f(x) \cdot p(x)\,dx = \int_a^b f(x) \cdot \frac{1}{b-a} \, dx
= \frac{1}{b-a} \int_a^b f(x)\,dx
$$<p>æ•´ç†å¾—ï¼š</p>
$$
\int_a^b f(x)\,dx = (b - a) \cdot \mathbb{E}[f(X)]
$$<h4 id="-ç”¨æ ·æœ¬å‡å€¼è¿‘ä¼¼æœŸæœ›">ğŸ“Œ ç”¨æ ·æœ¬å‡å€¼è¿‘ä¼¼æœŸæœ›</h4>
<p>æˆ‘ä»¬å¯ä»¥ä» $X \sim \mathcal{U}(a, b)$ ä¸­é‡‡æ · $n$ ä¸ªæ ·æœ¬ $x_1, x_2, \dots, x_n$ï¼Œè®¡ç®—ï¼š</p>
$$
\mathbb{E}[f(X)] \approx \frac{1}{n} \sum_{i=1}^{n} f(x_i)
$$<p>å› æ­¤ï¼š</p>
$$
\int_a^b f(x)\,dx \approx \frac{b - a}{n} \sum_{i=1}^n f(x_i)
$$<h4 id="-æ‹“å±•ä¸ºä»€ä¹ˆè¿™å¾ˆæœ‰ç”¨">ğŸ“š æ‹“å±•ï¼šä¸ºä»€ä¹ˆè¿™å¾ˆæœ‰ç”¨ï¼Ÿ</h4>
<ul>
<li>
<p>åœ¨<strong>é«˜ç»´ç©ºé—´</strong>æˆ–<strong>å¤æ‚ç§¯åˆ†ï¼ˆæ¯”å¦‚è´å¶æ–¯æ¨æ–­ä¸­ï¼‰</strong>ï¼Œæ²¡æœ‰è§£æè§£æ—¶ï¼š</p>
<ul>
<li>ä½ æ— æ³•ç”¨ç‰›é¡¿ç§¯åˆ†ï¼›</li>
<li>ä½ å¯ä»¥åªä¾èµ–æ ·æœ¬ï¼</li>
</ul>
</li>
</ul>
<h4 id="-æ€»ç»“ä¸€å¥è¯-1">âœ… æ€»ç»“ä¸€å¥è¯</h4>
<blockquote>
<p><strong>é€šè¿‡æŠŠç§¯åˆ†è½¬åŒ–ä¸ºæœŸæœ›ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ sample mean operator å’Œå‡åŒ€é‡‡æ ·æ¥è¿‘ä¼¼ä»»ä½•æ— æ³•è§£ææ±‚è§£çš„ç§¯åˆ† â€”â€” è¿™å°±æ˜¯è’™ç‰¹å¡æ´›ç§¯åˆ†çš„æ ¸å¿ƒã€‚</strong></p></blockquote>
<h4 id="-python-å®ç°monte-carlo-ç§¯åˆ†">âœ… Python å®ç°ï¼šMonte Carlo ç§¯åˆ†</h4>
<p>æˆ‘ä»¬æ¥è¯•è¯•è®¡ç®—ï¼š</p>
$$
I = \int_0^1 e^{-x^2}\,dx
$$<p>è¿™é‡Œï¼Œ</p>
<ul>
<li>$a = 0, b = 1$</li>
<li>$f(x) = e^{-x^2}$</li>
</ul>
<p>è¿™æ˜¯æ— æ³•è§£ææ±‚å‡ºçš„ï¼ˆå…¶å®è¿™å°±æ˜¯è¯¯å·®å‡½æ•° erf çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ•°å€¼ä¼°ç®—å®ƒã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¢«ç§¯å‡½æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç§¯åˆ†åŒºé—´</span>
</span></span><span style="display:flex;"><span>a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Monte Carlo é‡‡æ ·æ•°é‡</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>x_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(a, b, n) <span style="color:#75715e"># 1ï¸âƒ£ å‡åŒ€é‡‡æ · [a, b] åŒºé—´</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ ·æœ¬å‡å€¼ä¼°è®¡</span>
</span></span><span style="display:flex;"><span>estimate <span style="color:#f92672">=</span> (b <span style="color:#f92672">-</span> a) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>mean(f(x_samples)) <span style="color:#75715e"># 2ï¸âƒ£ è®¡ç®—æ ·æœ¬å‡å€¼å¹¶ä¹˜ä»¥åŒºé—´é•¿åº¦</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[Estimate Value] Monte Carlo estimate of âˆ«â‚€Â¹ e^(-xÂ²) dx â‰ˆ </span><span style="color:#e6db74">{</span>estimate<span style="color:#e6db74">:</span><span style="color:#e6db74">.6f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¡ç®—çœŸå®å€¼</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.special <span style="color:#f92672">import</span> erf
</span></span><span style="display:flex;"><span>true_val <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(np<span style="color:#f92672">.</span>pi)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> erf(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[True Value] The true value of âˆ«â‚€Â¹ e^(-xÂ²) dx â‰ˆ </span><span style="color:#e6db74">{</span>true_val<span style="color:#e6db74">:</span><span style="color:#e6db74">.6f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><pre><code>[Estimate Value] Monte Carlo estimate of âˆ«â‚€Â¹ e^(-xÂ²) dx â‰ˆ 0.743534
[True Value] The true value of âˆ«â‚€Â¹ e^(-xÂ²) dx â‰ˆ 0.746824
</code></pre>
<h1 id="é‡‡æ ·æ–¹æ³•sample-methods">é‡‡æ ·æ–¹æ³•ï¼ˆSample Methodsï¼‰</h1>
<p><strong>åˆè§ï¼š</strong></p>
<ul>
<li><a href="./extra-Sampling%20from%20discrete_continuous%20distributions.pdf">Sampling from discrete distributions</a> | <a href="https://dept.stat.lsa.umich.edu/~jasoneg/Stat406/lab5.pdf">Online version</a></li>
</ul>
<h2 id="åå‡½æ•°æ³•inverse-transform-sampling">åå‡½æ•°æ³•ï¼ˆInverse Transform Samplingï¼‰</h2>
<p>ç»™å®šæ¦‚ç‡å¯†åº¦/è´¨é‡å‡½æ•° $f_X(x)$ï¼Œåˆ™ï¼š</p>
<ol>
<li>è®¡ç®— $F_X(x)$</li>
<li>åŸºäºå‡åŒ€éšæœºå˜é‡è·å¾—ä¸€ä¸ªå€¼</li>
<li>è®¡ç®— $F_X^{-1}(u)$ ä»è€Œå¾—åˆ° $x$ã€‚è¿™ä¸ª $x$ å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„é‡‡æ ·å€¼ã€‚</li>
</ol>
<p>æƒ³è±¡ä½ ç”»äº† CDF æ›²çº¿ $F_X(x)$ï¼Œæ¨ªè½´æ˜¯$x$ï¼Œçºµè½´æ˜¯æ¦‚ç‡$[0,1]$ã€‚</p>
<ul>
<li>éšæœºç”Ÿæˆä¸€ä¸ª $u \in [0,1]$</li>
<li>æ‰¾åˆ°è¿™ä¸ª $u$ åœ¨ CDF ä¸Šå¯¹åº”çš„æ¨ªåæ ‡ï¼šè¿™å°±æ˜¯ä½ è¦çš„æ ·æœ¬ $x$</li>
</ul>
<p>æ³¨æ„ï¼š</p>
<blockquote>
<p>å½“æˆ‘ä»¬å·²ç»çŸ¥é“äº†CDFï¼Œå¹¶ä¸”å¯ä»¥ä»è¿™ä¸ªCDFè·å¾—ä¸€ä¸ªå°é—­å½¢å¼ï¼ˆclose formï¼‰çš„å‡½æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> plotly.graph_objs <span style="color:#66d9ef">as</span> go
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> plotly.subplots <span style="color:#f92672">import</span> make_subplots
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç›®æ ‡åˆ†å¸ƒï¼šæŒ‡æ•°åˆ†å¸ƒ X ~ Exp(Î»=1)</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>cdf_vals <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>x_vals)  <span style="color:#75715e"># CDF of Exp(1)</span>
</span></span><span style="display:flex;"><span>inv_cdf <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> u: <span style="color:#f92672">-</span>np<span style="color:#f92672">.</span>log(<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> u)  <span style="color:#75715e"># x = åå‡½æ•° Fâ»Â¹(u)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># éšæœºé‡‡æ · 5 ä¸ªå‡åŒ€æ•°</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>u_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sort(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>x_samples <span style="color:#f92672">=</span> inv_cdf(u_samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºå­å›¾ï¼šå·¦ä¾§æ˜¾ç¤º CDF æ˜ å°„è¿‡ç¨‹ï¼Œå³ä¾§æ˜¾ç¤º Histogram</span>
</span></span><span style="display:flex;"><span>fig <span style="color:#f92672">=</span> make_subplots(rows<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, cols<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>                    subplot_titles<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;Inverse Transform Sampling&#34;</span>, <span style="color:#e6db74">&#34;Histogram of Transformed Samples&#34;</span>),
</span></span><span style="display:flex;"><span>                    column_widths<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0.6</span>, <span style="color:#ae81ff">0.4</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å·¦å›¾ï¼šCDF æ›²çº¿</span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>x_vals, y<span style="color:#f92672">=</span>cdf_vals, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lines&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;CDF F(x)&#39;</span>, line<span style="color:#f92672">=</span>dict(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)),
</span></span><span style="display:flex;"><span>              row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ·»åŠ æ¯ä¸ª u å€¼çš„æ°´å¹³çº¿å’Œå¯¹åº”çš„ x æ˜ å°„</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> u, x <span style="color:#f92672">in</span> zip(u_samples, x_samples):
</span></span><span style="display:flex;"><span>    fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>, x], y<span style="color:#f92672">=</span>[u, u], mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lines&#39;</span>,
</span></span><span style="display:flex;"><span>                             line<span style="color:#f92672">=</span>dict(dash<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;dot&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>), showlegend<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>[x], y<span style="color:#f92672">=</span>[u], mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;markers+text&#39;</span>,
</span></span><span style="display:flex;"><span>                             marker<span style="color:#f92672">=</span>dict(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>),
</span></span><span style="display:flex;"><span>                             text<span style="color:#f92672">=</span>[<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;x=</span><span style="color:#e6db74">{</span>x<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>], textposition<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;top right&#39;</span>, showlegend<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ·»åŠ  u æ ·æœ¬ç‚¹</span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span>len(u_samples), y<span style="color:#f92672">=</span>u_samples, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;markers&#39;</span>,
</span></span><span style="display:flex;"><span>                         marker<span style="color:#f92672">=</span>dict(symbol<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;line-ns-open&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;green&#39;</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>),
</span></span><span style="display:flex;"><span>                         name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;u ~ Uniform(0,1)&#39;</span>), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å³å›¾ï¼šx æ ·æœ¬çš„ç›´æ–¹å›¾</span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Histogram(x<span style="color:#f92672">=</span>x_samples, nbinsx<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled X&#39;</span>, marker_color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¸ƒå±€è®¾ç½®</span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>update_layout(height<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>, width<span style="color:#f92672">=</span><span style="color:#ae81ff">900</span>, title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Inverse Transform Sampling Visualization (Exponential RV)&#34;</span>,
</span></span><span style="display:flex;"><span>                  showlegend<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>update_xaxes(title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span>, row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>update_yaxes(title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;F(x) or u&#34;</span>, row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>update_xaxes(title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Sampled x&#34;</span>, row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>update_yaxes(title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Frequency&#34;</span>, row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h3 id="ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨å‡åŒ€åˆ†å¸ƒæ¥é‡‡æ ·å…¶ä»–ä»»æ„åˆ†å¸ƒæ¯”å¦‚ä¼¯åŠªåˆ©æŒ‡æ•°æ­£æ€ç­‰">ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨å‡åŒ€åˆ†å¸ƒæ¥é‡‡æ ·å…¶ä»–ä»»æ„åˆ†å¸ƒï¼ˆæ¯”å¦‚ä¼¯åŠªåˆ©ã€æŒ‡æ•°ã€æ­£æ€ç­‰ï¼‰</h3>
<p>è¿™èƒŒåçš„ç†è®ºåŸºç¡€æ˜¯ <strong>æ¦‚ç‡è®ºä¸­å…³äº</strong>â€¯<strong>åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰å’Œå…¶åå‡½æ•°çš„æ€§è´¨</strong>ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæ¦‚ç‡ç§¯åˆ†å˜æ¢ï¼ˆProbability Integral Transformï¼‰</p>
<p><strong>å®šç†ï¼ˆæ¦‚ç‡ç§¯åˆ†å˜æ¢ / Probability Integral Transformï¼‰</strong>ï¼š</p>
<blockquote>
<p>è‹¥éšæœºå˜é‡ $X$ çš„åˆ†å¸ƒå‡½æ•°æ˜¯ $F_X(x)$ï¼Œä¸” $F_X$ æ˜¯ä¸¥æ ¼å•è°ƒçš„è¿ç»­å‡½æ•°ï¼Œé‚£ä¹ˆ
<strong>$U = F_X(X) \sim \text{Uniform}(0,1)$</strong>ï¼Œ
åè¿‡æ¥ï¼Œ<strong>$X = F_X^{-1}(U)$</strong> ä¹Ÿæœä»åŸå§‹åˆ†å¸ƒ $X$ã€‚</p></blockquote>
<p>æ¢å¥è¯è¯´ï¼š</p>
<ul>
<li><strong>ä½ å¯ä»¥æŠŠä»»ä½•åˆ†å¸ƒçš„é‡‡æ ·é—®é¢˜ï¼Œå˜æˆ Uniform(0,1) çš„é‡‡æ ·é—®é¢˜ + ä¸€ä¸ªåå‡½æ•°å˜æ¢ã€‚</strong></li>
</ul>
<h4 id="-ä¸ºä»€ä¹ˆè¿™ä¸ªæˆç«‹">ğŸ§  ä¸ºä»€ä¹ˆè¿™ä¸ªæˆç«‹ï¼Ÿ</h4>
<p>æˆ‘ä»¬æ¥ç›´è§‚æ¨å¯¼ä¸€ä¸‹ç¬¬äºŒä¸ªæ–¹å‘ï¼ˆä¹Ÿæ˜¯æˆ‘ä»¬ç”¨æ¥â€œç”Ÿæˆä»»æ„åˆ†å¸ƒâ€çš„æ–¹å‘ï¼‰ï¼š</p>
<p><strong>å‡è®¾ï¼š</strong></p>
<ul>
<li>$U \sim \text{Uniform}(0,1)$</li>
<li>è®¾ $Y = F^{-1}(U)$ï¼Œæˆ‘ä»¬æƒ³è¯æ˜ $Y \sim F$</li>
</ul>
<p><strong>è¯æ˜ï¼š</strong></p>
<p>æˆ‘ä»¬æ¥è®¡ç®— $Y = F^{-1}(U)$ çš„ CDFï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
$$
P(Y \leq y)
$$<p>ç”±äº $Y = F^{-1}(U)$ï¼Œé‚£ä¹ˆï¼š</p>
$$
P(Y \leq y) = P(F^{-1}(U) \leq y)
$$<p><strong>âœ… ç¬¬ä¸€æ­¥ï¼šè¿ç”¨åå‡½æ•°çš„å•è°ƒæ€§</strong></p>
<p><strong>å‰ææ¡ä»¶ï¼š$F$ æ˜¯è¿ç»­ã€ä¸¥æ ¼é€’å¢çš„å‡½æ•°</strong>ï¼ˆè¿™æ˜¯ä¿è¯åå‡½æ•°å­˜åœ¨å¹¶å•è°ƒçš„å…³é”®ï¼‰ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹ä¸ç­‰å¼ $F^{-1}(U) \leq y$ åº”ç”¨å‡½æ•° $F$ï¼Œå˜æˆï¼š</p>
$$
F^{-1}(U) \leq y \quad \Leftrightarrow \quad U \leq F(y)
$$<p>è¿™æ˜¯éå¸¸å…³é”®çš„ä¸€æ­¥ï¼æˆ‘ä»¬æŠŠ <strong>â€œå…³äº $Y$â€ çš„äº‹ä»¶</strong> è½¬åŒ–æˆäº† <strong>â€œå…³äº $U$â€ çš„äº‹ä»¶</strong>ã€‚</p>
<p><strong>âœ… ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ $U \sim \text{Uniform}(0,1)$</strong></p>
$$
P(U \leq F(y)) = F(y)
$$<p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºï¼š</p>
<ul>
<li>$U \sim \text{Uniform}(0,1)$</li>
<li>æ‰€ä»¥ <strong>$P(U \leq u) = u$</strong>ï¼Œå¯¹äº $u \in [0,1]$</li>
<li>è€Œ $F(y) \in [0,1]$ï¼Œå› ä¸º $F$ æ˜¯ä¸€ä¸ªåˆæ³•çš„åˆ†å¸ƒå‡½æ•°</li>
</ul>
<p>æ‰€ä»¥ï¼š</p>
$$
P(U \leq F(y)) = F(y)
$$<p><strong>âœ… ç»¼åˆèµ·æ¥ï¼š</strong></p>
$$
P(Y \leq y) = P(F^{-1}(U) \leq y) = P(U \leq F(y)) = F(y)
$$<p>å› æ­¤ï¼Œ<strong>$Y$ çš„åˆ†å¸ƒå‡½æ•°å°±æ˜¯ $F$</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯´ $Y \sim F$ã€‚</p>
<h4 id="-åº”ç”¨ä¸¾ä¾‹">ğŸ¯ åº”ç”¨ä¸¾ä¾‹ï¼š</h4>
<ul>
<li>
<p><strong>ä¼¯åŠªåˆ©é‡‡æ ·ï¼š</strong></p>
<ul>
<li>
<p>å¦‚æœ $U < p$ï¼Œæˆ‘ä»¬å°±è¾“å‡º 1ï¼Œå¦åˆ™è¾“å‡º 0ï¼Œç›¸å½“äºï¼š</p>
$$
    F^{-1}(u) = 
    \begin{cases}
    1 & u < p \\
    0 & u \ge p
    \end{cases}
    $$</li>
</ul>
</li>
<li>
<p><strong>æŒ‡æ•°åˆ†å¸ƒé‡‡æ ·ï¼š</strong></p>
<ul>
<li>Exponential çš„ CDF æ˜¯ $F(x) = 1 - e^{-\lambda x}$</li>
<li>åå‡½æ•°æ˜¯ $F^{-1}(u) = -\frac{1}{\lambda} \ln(1 - u)$</li>
</ul>
</li>
</ul>
<h4 id="-ç›´è§‰æ€»ç»“">ğŸ’¡ ç›´è§‰æ€»ç»“</h4>
<p>ä½ å¯ä»¥æŠŠ Uniform(0,1) ç†è§£ä¸ºâ€œæŠ½ç­¾â€ï¼Œç„¶åç”¨æ¯ç§åˆ†å¸ƒçš„<strong>åˆ†å¸ƒå‡½æ•°</strong>å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªâ€œæŠ½ç­¾å·â€å¯¹åº”ä»€ä¹ˆâ€œäº‹ä»¶â€æˆ–â€œæ•°å€¼â€ã€‚</p>
<h4 id="-ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦è¿™æ ·åš">ğŸ“Š ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦è¿™æ ·åšï¼Ÿ</h4>
<ol>
<li><strong>Uniform(0,1)</strong> æ˜¯æœ€å®¹æ˜“æ¨¡æ‹Ÿçš„åˆ†å¸ƒï¼šå‡ ä¹æ‰€æœ‰è¯­è¨€éƒ½æœ‰ <code>random()</code>ã€‚</li>
<li>å¦‚æœèƒ½æŠŠä»»ä½•åˆ†å¸ƒè½¬åŒ–ä¸º Uniformï¼Œå°±èƒ½ç»Ÿä¸€é‡‡æ ·æµç¨‹ï¼Œç®€åŒ–ç®—æ³•è®¾è®¡ã€‚</li>
<li>ç”¨åœ¨ï¼š<strong>è’™ç‰¹å¡æ´›æ–¹æ³•ã€MCMCã€ç”Ÿæˆæ¨¡å‹ã€ä»¿çœŸç³»ç»Ÿâ€¦â€¦</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Target distribution: Exponential(lambda=1)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> expon
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate Uniform samples</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>U <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, n)
</span></span><span style="display:flex;"><span>U_sorted <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sort(U)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Compute inverse CDF (quantile function) for exponential</span>
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> expon<span style="color:#f92672">.</span>ppf(U_sorted)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Prepare plot</span>
</span></span><span style="display:flex;"><span>fig, axs <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot CDF of Exponential</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>cdf <span style="color:#f92672">=</span> expon<span style="color:#f92672">.</span>cdf(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(x, cdf, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;CDF of Exponential(Î»=1)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>scatter(Y, U_sorted, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;(Y, U)&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Inverse Transform Sampling Visualization&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;y&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;u = F(y)&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot histogram of sampled Y</span>
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>hist(Y, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled Y&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(x, expon<span style="color:#f92672">.</span>pdf(x), color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;True PDF&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Sampled Distribution via Inverse Transform&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;y&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>)
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>axs[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_120_0.png" alt="png"></p>
<h3 id="ç¦»æ•£å‹åå‡½æ•°é‡‡æ ·">ç¦»æ•£å‹åå‡½æ•°é‡‡æ ·</h3>
<p><strong>åå‡½æ•°æ³•ï¼ˆInverse Transform Samplingï¼‰</strong> å¹¶ä¸åªé€‚ç”¨äºè¿ç»­å‹éšæœºå˜é‡ï¼Œå®ƒåŒæ ·é€‚ç”¨äº<strong>ç¦»æ•£å‹éšæœºå˜é‡</strong>ï¼ŒåŸç†æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯æ“ä½œç•¥æœ‰ä¸åŒã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†ä¸ºä½ è®²è§£ç¦»æ•£å‹éšæœºå˜é‡ä¸Šçš„åº”ç”¨ã€‚</p>
<p>è€Œå¯¹äº<strong>ç¦»æ•£åˆ†å¸ƒ</strong>ï¼Œ$F_X(x)$ æ˜¯é˜¶æ¢¯å‡½æ•°ï¼ˆè·³è·ƒï¼‰ï¼Œæˆ‘ä»¬ä¸èƒ½ç”¨â€œè§£æåå‡½æ•°â€ï¼Œä½†å¯ä»¥é€šè¿‡<strong>æŸ¥æ‰¾æ³•å®ç°â€œåå‡½æ•°â€çš„æ•ˆæœ</strong>ã€‚</p>
<h4 id="-ç¦»æ•£å‹åå‡½æ•°é‡‡æ ·æ ¸å¿ƒæ­¥éª¤">ğŸ§® ç¦»æ•£å‹åå‡½æ•°é‡‡æ ·ï¼šæ ¸å¿ƒæ­¥éª¤</h4>
<p>æˆ‘ä»¬é€šè¿‡<strong>ç´¯ç§¯æ¦‚ç‡è¡¨</strong>æ¥ä»£æ›¿åå‡½æ•°ï¼Œä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>æœ‰ä¸€ä¸ªç¦»æ•£å‹ RV $X$ï¼Œå…¶å¯èƒ½å–å€¼ä¸º $x_1, x_2, ..., x_n$ï¼Œæ¦‚ç‡ä¸º $p_1, p_2, ..., p_n$</p>
</li>
<li>
<p>æ„é€ å…¶ <strong>ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰</strong>ï¼š</p>
$$
   F(x_k) = \sum_{i=1}^k p_i
   $$</li>
<li>
<p>ä» $u \sim \text{Uniform}(0, 1)$ ä¸­é‡‡æ ·</p>
</li>
<li>
<p>æ‰¾åˆ°ç¬¬ä¸€ä¸ªä½¿å¾— $F(x_k) \geq u$ çš„ $x_k$ï¼Œè¿™å°±æ˜¯é‡‡æ ·å€¼</p>
</li>
</ol>
<h4 id="-ç¤ºä¾‹é‡‡æ ·ç¦»æ•£å˜é‡-xå…¶ä¸­">âœ… ç¤ºä¾‹ï¼šé‡‡æ ·ç¦»æ•£å˜é‡ Xï¼Œå…¶ä¸­ï¼š</h4>
<ul>
<li>$P(X=1) = 0.1$</li>
<li>$P(X=2) = 0.3$</li>
<li>$P(X=3) = 0.4$</li>
<li>$P(X=4) = 0.2$</li>
</ul>
<p>é‚£ä¹ˆ CDF ä¸ºï¼š</p>
<table>
  <thead>
      <tr>
          <th>å€¼ $x$</th>
          <th>æ¦‚ç‡ $p$</th>
          <th>ç´¯ç§¯ $F(x)$</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>0.1</td>
          <td>0.1</td>
      </tr>
      <tr>
          <td>2</td>
          <td>0.3</td>
          <td>0.4</td>
      </tr>
      <tr>
          <td>3</td>
          <td>0.4</td>
          <td>0.8</td>
      </tr>
      <tr>
          <td>4</td>
          <td>0.2</td>
          <td>1.0</td>
      </tr>
  </tbody>
</table>
<p>å¦‚æœä½ é‡‡åˆ° $u = 0.75$ï¼Œä½ ä¼šè½åœ¨ $F(x=3)=0.8$ï¼Œæ‰€ä»¥è¾“å‡º 3ï¼›
å¦‚æœ $u = 0.85$ï¼Œä½ ä¼šè¾“å‡º 4ã€‚</p>
<h4 id="-æ€»ç»“-1">âœ… æ€»ç»“</h4>
<table>
  <thead>
      <tr>
          <th>å¯¹è±¡ç±»å‹</th>
          <th>æ˜¯å¦èƒ½ç”¨åå‡½æ•°æ³•ï¼Ÿ</th>
          <th>å¦‚ä½•å®ç°ï¼Ÿ</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>è¿ç»­å‹ RV</td>
          <td>âœ… æ˜¯</td>
          <td>ç”¨è§£ææˆ–æ•°å€¼æ–¹å¼è®¡ç®— $F^{-1}(u)$</td>
      </tr>
      <tr>
          <td>ç¦»æ•£å‹ RV</td>
          <td>âœ… æ˜¯</td>
          <td>ç”¨æŸ¥æ‰¾ + ç´¯ç§¯åˆ†å¸ƒå‡½æ•°æ¨¡æ‹Ÿ $F^{-1}(u)$</td>
      </tr>
  </tbody>
</table>
<h2 id="é‡‡æ ·ç¦»æ•£åˆ†å¸ƒ">é‡‡æ ·ç¦»æ•£åˆ†å¸ƒ</h2>
<h3 id="é‡‡æ ·ä¸€ä¸ªäºŒç»´æœ‰é™ç¦»æ•£å‹éšæœºå˜é‡2d-finite-discrete-random-variable">é‡‡æ ·ä¸€ä¸ªäºŒç»´æœ‰é™ç¦»æ•£å‹éšæœºå˜é‡ï¼ˆ2D Finite Discrete Random Variableï¼‰</h3>
<p>é‡‡æ ·ä¸€ä¸ª<strong>äºŒç»´æœ‰é™ç¦»æ•£å‹éšæœºå˜é‡ï¼ˆ2D Finite Discrete Random Variableï¼‰</strong>ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä»ä¸€ä¸ªç»™å®šçš„<strong>è”åˆæ¦‚ç‡åˆ†å¸ƒè¡¨ $P(X = x_i, Y = y_j)$</strong> ä¸­ç”Ÿæˆéšæœºæ ·æœ¬å¯¹ $(x_i, y_j)$ã€‚</p>
<p><strong>âœ… æ€»ç»“</strong></p>
<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>åŸç†</th>
          <th>é€‚ç”¨åœºæ™¯</th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>å±•å¹³è”åˆåˆ†å¸ƒ + åå‡½æ•°é‡‡æ ·</td>
          <td>ä¸€ç»´åŒ–å¤„ç†æ‰€æœ‰ $(x,y)$ å¯¹</td>
          <td>è”åˆæ¦‚ç‡çŸ©é˜µå·²çŸ¥</td>
          <td></td>
      </tr>
      <tr>
          <td>è¾¹ç¼˜ + æ¡ä»¶é‡‡æ ·</td>
          <td>å…ˆé‡‡ $X$ï¼Œå†é‡‡ (Y</td>
          <td>X)</td>
          <td>æ›´å¤æ‚/ç»“æ„åŒ–çš„æ¨¡å‹</td>
      </tr>
  </tbody>
</table>
<h4 id="-æ–¹æ³•ä¸€å±•å¹³åå‡½æ•°é‡‡æ ·">âœ… æ–¹æ³•ä¸€ï¼šå±•å¹³+åå‡½æ•°é‡‡æ ·</h4>
<p><strong>æ ¸å¿ƒæ€è·¯ï¼š</strong></p>
<p>å°†äºŒç»´è”åˆåˆ†å¸ƒ<strong>å±•å¹³</strong>ä¸ºä¸€ç»´ï¼Œç„¶ååš<strong>ç´¯ç§¯æ¦‚ç‡è¡¨ + åå‡½æ•°é‡‡æ ·ï¼ˆInverse CDF Samplingï¼‰</strong>ã€‚</p>
<p><strong>ğŸ”¢ æ­¥éª¤ï¼š</strong></p>
<ol>
<li>åˆ›å»ºæ‰€æœ‰å¯èƒ½çš„å€¼å¯¹ $(x_i, y_j)$ï¼›</li>
<li>å±•å¹³è”åˆæ¦‚ç‡è¡¨ $P(x_i, y_j)$ï¼›</li>
<li>æ„é€ ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰ï¼›</li>
<li>ä» $[0,1]$ ä¸Šé‡‡æ · $u$ï¼Œæ‰¾ç¬¬ä¸€ä¸ª $u \leq \text{CDF}[k]$ï¼›</li>
<li>è¿”å›å¯¹åº”çš„ $(x_i, y_j)$ã€‚</li>
</ol>
<p><strong>âœ… å‡è®¾ä½ å·²æœ‰è”åˆåˆ†å¸ƒè¡¨</strong></p>
<p>æ¯”å¦‚ï¼š</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th>y=0</th>
          <th>y=1</th>
          <th>y=2</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>x=0</td>
          <td>0.1</td>
          <td>0.2</td>
          <td>0.1</td>
      </tr>
      <tr>
          <td>x=1</td>
          <td>0.1</td>
          <td>0.2</td>
          <td>0.1</td>
      </tr>
      <tr>
          <td>x=2</td>
          <td>0.05</td>
          <td>0.05</td>
          <td>0.1</td>
      </tr>
  </tbody>
</table>
<p>è¿™ä¸ªäºŒç»´åˆ†å¸ƒçš„æ€»æ¦‚ç‡æ˜¯ 1ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">flatten_joint_distribution</span>(x_vals, y_vals, joint_probs):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    å±•å¹³äºŒç»´è”åˆåˆ†å¸ƒçŸ©é˜µ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param joint_probs: äºŒç»´è”åˆåˆ†å¸ƒçŸ©é˜µ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: å±•å¹³åçš„æ¦‚ç‡åˆ†å¸ƒ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å±•å¹³è”åˆåˆ†å¸ƒ</span>
</span></span><span style="display:flex;"><span>    flattened <span style="color:#f92672">=</span> joint_probs<span style="color:#f92672">.</span>flatten()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#print(&#34;Flatten joint probabilities:&#34;, flattened)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æ‰€æœ‰å¯èƒ½çš„(x, y)ç»„åˆï¼ˆé¡ºåºä¸flattenedä¸€è‡´ï¼‰</span>
</span></span><span style="display:flex;"><span>    xy_pairs <span style="color:#f92672">=</span> [(x, y) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> x_vals <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> y_vals]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#print(&#34;XY pairs:&#34;, xy_pairs)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> flattened, xy_pairs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_2d_discrete_inverse_transform</span>(x_vals, y_vals, joint_probs):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># flatten the joint distribution</span>
</span></span><span style="display:flex;"><span>    flattened, xy_pairs <span style="color:#f92672">=</span> flatten_joint_distribution(x_vals, y_vals, joint_probs)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># apply inverse transform sampling</span>
</span></span><span style="display:flex;"><span>    cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(flattened)
</span></span><span style="display:flex;"><span>    u <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>random()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, threshold <span style="color:#f92672">in</span> enumerate(cdf):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> u <span style="color:#f92672">&lt;=</span> threshold:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> xy_pairs[i]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> xy_pairs[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]  <span style="color:#75715e"># fallback for u ~ 1.0</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å®šä¹‰äºŒç»´ç¦»æ•£è”åˆåˆ†å¸ƒ</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>y_vals <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>joint_probs <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.1</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.1</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">0.1</span>]
</span></span><span style="display:flex;"><span>])  <span style="color:#75715e"># shape (3, 3)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assert</span> np<span style="color:#f92672">.</span>isclose(joint_probs<span style="color:#f92672">.</span>sum(), <span style="color:#ae81ff">1.0</span>), <span style="color:#e6db74">&#34;Joint probabilities must sum to 1&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> [sample_2d_discrete_inverse_transform(x_vals, y_vals, joint_probs) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span>x_sample, y_sample <span style="color:#f92672">=</span> zip(<span style="color:#f92672">*</span>samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯è§†åŒ–è”åˆé¢‘ç‡</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;x&#39;</span>: x_sample, <span style="color:#e6db74">&#39;y&#39;</span>: y_sample})
</span></span><span style="display:flex;"><span>pivot_table <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>crosstab(df[<span style="color:#e6db74">&#39;x&#39;</span>], df[<span style="color:#e6db74">&#39;y&#39;</span>], normalize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;all&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>heatmap(joint_probs, annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YlGnBu&#34;</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.3f&#34;</span>, xticklabels<span style="color:#f92672">=</span>y_vals, yticklabels<span style="color:#f92672">=</span>x_vals)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Theoretical Joint Distribution from Samples&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Y&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;X&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>heatmap(pivot_table, annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YlGnBu&#34;</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.3f&#34;</span>, xticklabels<span style="color:#f92672">=</span>y_vals, yticklabels<span style="color:#f92672">=</span>x_vals)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Empirical Joint Distribution from Samples&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Y&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;X&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_126_0.png" alt="png"></p>
<h4 id="-æ–¹æ³•äºŒè¾¹ç¼˜--æ¡ä»¶åˆ†å¸ƒé‡‡æ ·æ³•marginal--conditional-sampling">âœ… æ–¹æ³•äºŒï¼šâ€œè¾¹ç¼˜ + æ¡ä»¶åˆ†å¸ƒé‡‡æ ·æ³•â€ï¼ˆMarginal + Conditional Samplingï¼‰</h4>
<p>è¿™ç§æ–¹æ³•åœ¨æ¦‚ç‡è®ºã€è´å¶æ–¯å»ºæ¨¡ä¸­éå¸¸å¸¸è§ï¼Œé€»è¾‘ä¹Ÿæ›´ç›´è§‚ï¼Œå°¤å…¶é€‚ç”¨äºç»“æ„åŒ–æ¦‚ç‡æ¨¡å‹ï¼ˆå¦‚è´å¶æ–¯ç½‘ï¼‰æˆ–æ¡ä»¶æ¦‚ç‡ä¿¡æ¯æ¸…æ™°çš„åœºæ™¯ã€‚</p>
<p>é‡‡æ ·ä¸€ä¸ªäºŒç»´ç¦»æ•£éšæœºå˜é‡ $(X, Y)$ çš„åŸºæœ¬æ€è·¯æ˜¯ï¼š</p>
<blockquote>
<p>å…ˆä»è¾¹ç¼˜åˆ†å¸ƒ $P(X = x_i)$ ä¸­é‡‡æ ·ä¸€ä¸ª $x_i$ï¼Œ
ç„¶åæ ¹æ®è¿™ä¸ª $x_i$ï¼Œä»æ¡ä»¶åˆ†å¸ƒ $P(Y = y_j \mid X = x_i)$ ä¸­é‡‡æ ·ä¸€ä¸ª $y_j$ã€‚</p></blockquote>
<p><strong>ğŸ§® æ•°å­¦åŸºç¡€</strong></p>
<p>è”åˆæ¦‚ç‡å¯åˆ†è§£ä¸ºï¼š</p>
$$
P(X = x_i, Y = y_j) = P(X = x_i) \cdot P(Y = y_j \mid X = x_i)
$$<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰è¿™ä¸ªé¡ºåºé‡‡æ ·ï¼</p>
<p><strong>âœ… ä¸¾ä¸ªå…·ä½“ä¾‹å­</strong></p>
<p>å¦‚æœæˆ‘ä»¬æœ‰è”åˆåˆ†å¸ƒè¡¨ $P(X,Y)$ï¼š</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th>y=0</th>
          <th>y=1</th>
          <th>y=2</th>
          <th>åˆè®¡</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>x=0</td>
          <td>0.1</td>
          <td>0.2</td>
          <td>0.1</td>
          <td>0.4</td>
      </tr>
      <tr>
          <td>x=1</td>
          <td>0.1</td>
          <td>0.2</td>
          <td>0.1</td>
          <td>0.4</td>
      </tr>
      <tr>
          <td>x=2</td>
          <td>0.05</td>
          <td>0.05</td>
          <td>0.1</td>
          <td>0.2</td>
      </tr>
  </tbody>
</table>
<p>é‚£ä¹ˆ<strong>è¾¹ç¼˜åˆ†å¸ƒ</strong>ï¼ˆå¯¹Yæ±‚å’Œï¼‰ï¼š</p>
$$
P(X = 0) = 0.4,\quad P(X = 1) = 0.4,\quad P(X = 2) = 0.2
$$<p>ä»¥åŠ<strong>æ¡ä»¶åˆ†å¸ƒ</strong> $P(Y = y_j \mid X = x_i)$ï¼ˆæ¯ä¸€è¡Œå½’ä¸€åŒ–ï¼‰ï¼š</p>
<table>
  <thead>
      <tr>
          <th></th>
          <th>y=0</th>
          <th>y=1</th>
          <th>y=2</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>x=0</td>
          <td>0.25</td>
          <td>0.5</td>
          <td>0.25</td>
      </tr>
      <tr>
          <td>x=1</td>
          <td>0.25</td>
          <td>0.5</td>
          <td>0.25</td>
      </tr>
      <tr>
          <td>x=2</td>
          <td>0.25</td>
          <td>0.25</td>
          <td>0.5</td>
      </tr>
  </tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sample_2d_marginal_conditional</span>(x_vals, y_vals, joint_probs):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è®¡ç®—è¾¹ç¼˜åˆ†å¸ƒ P(X)</span>
</span></span><span style="display:flex;"><span>    P_X <span style="color:#f92672">=</span> joint_probs<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># shape (3,)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è®¡ç®—æ¡ä»¶åˆ†å¸ƒ P(Y | X)</span>
</span></span><span style="display:flex;"><span>    P_Y_given_X <span style="color:#f92672">=</span> joint_probs <span style="color:#f92672">/</span> P_X[:, np<span style="color:#f92672">.</span>newaxis]  <span style="color:#75715e"># æ¯è¡Œé™¤ä»¥å¯¹åº” P(X)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 1. é‡‡æ · X</span>
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>choices(x_vals, weights<span style="color:#f92672">=</span>P_X)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    x_idx <span style="color:#f92672">=</span> x_vals<span style="color:#f92672">.</span>index(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 2. æ ¹æ® P(Y|X=x) é‡‡æ · Y</span>
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>choices(y_vals, weights<span style="color:#f92672">=</span>P_Y_given_X[x_idx])[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (x, y)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å€¼åŸŸ</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>y_vals <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è”åˆæ¦‚ç‡çŸ©é˜µ</span>
</span></span><span style="display:flex;"><span>joint_probs <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.1</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.1</span>],
</span></span><span style="display:flex;"><span>    [<span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">0.1</span>]
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>  <span style="color:#75715e"># é‡‡æ ·æ¬¡æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> [sample_2d_marginal_conditional(x_vals, y_vals, joint_probs) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span>x_sample, y_sample <span style="color:#f92672">=</span> zip(<span style="color:#f92672">*</span>samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯è§†åŒ–</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;x&#39;</span>: x_sample, <span style="color:#e6db74">&#39;y&#39;</span>: y_sample})
</span></span><span style="display:flex;"><span>pivot_table <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>crosstab(df[<span style="color:#e6db74">&#39;x&#39;</span>], df[<span style="color:#e6db74">&#39;y&#39;</span>], normalize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;all&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>heatmap(joint_probs, annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YlGnBu&#34;</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.3f&#34;</span>, xticklabels<span style="color:#f92672">=</span>y_vals, yticklabels<span style="color:#f92672">=</span>x_vals)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Theoretical Joint Distribution from Marginal + Conditional Sampling&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Y&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;X&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>heatmap(pivot_table, annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;YlGnBu&#34;</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.3f&#34;</span>, xticklabels<span style="color:#f92672">=</span>y_vals, yticklabels<span style="color:#f92672">=</span>x_vals)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Empirical Joint Distribution from Marginal + Conditional Sampling&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Y&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;X&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_129_0.png" alt="png"></p>
<h2 id="é‡‡æ ·è¿ç»­åˆ†å¸ƒ">é‡‡æ ·è¿ç»­åˆ†å¸ƒ</h2>
<h3 id="æ ¼ç‚¹é‡‡æ ·å™¨grid-sampler">æ ¼ç‚¹é‡‡æ ·å™¨ï¼ˆGrid samplerï¼‰</h3>
<p><strong>æ ¼ç‚¹é‡‡æ ·å™¨ï¼ˆGrid Samplerï¼‰</strong> æ˜¯ä¸€ç§åŸºäºäºŒè¿›åˆ¶ç»†åˆ†åŒºé—´çš„<strong>é€’å½’é‡‡æ ·æ–¹æ³•</strong>ï¼Œé€‚ç”¨äº<strong>è¿‘ä¼¼ä»ä»»æ„è¿ç»­åˆ†å¸ƒä¸­é‡‡æ ·</strong>ï¼Œå‰ææ˜¯æˆ‘ä»¬å¯ä»¥<strong>è®¡ç®—ä»»æ„åŒºé—´çš„æ¦‚ç‡è´¨é‡ï¼ˆç§¯åˆ†ï¼‰</strong>ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•æ˜¯<strong>ç”¨äºé«˜ç²¾åº¦æ•°å€¼é‡‡æ ·çš„æ„é€ æ€§æ–¹æ³•</strong>ï¼Œç‰¹åˆ«é€‚åˆï¼š</p>
<ul>
<li>åˆ†å¸ƒæ²¡æœ‰å°é—­å½¢å¼çš„é€†CDFï¼›</li>
<li>ä½†æˆ‘ä»¬å¯ä»¥è®¡ç®—å…¶ CDF æˆ–åŒºé—´æ¦‚ç‡ï¼›</li>
<li>æƒ³ä»è¯¥åˆ†å¸ƒä¸­ç²¾ç¡®é‡‡æ ·ã€‚</li>
</ul>
<h4 id="-åŸç†æ¦‚è¿°ä»¥-01-åŒºé—´ä¸ºä¾‹">ğŸ” åŸç†æ¦‚è¿°ï¼ˆä»¥ [0,1] åŒºé—´ä¸ºä¾‹ï¼‰</h4>
<p>ç›®æ ‡ï¼šä»æŸä¸ªè¿ç»­æ¦‚ç‡å¯†åº¦å‡½æ•° $f(x)$ å®šä¹‰åœ¨ [0,1] ä¸Šé‡‡æ ·ã€‚</p>
<blockquote>
<p>ğŸ“– å³ä½¿éšæœºå˜é‡æ˜¯å®šä¹‰åœ¨åŒºé—´$[a,b]$ä¸Šçš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡<strong>çº¿æ€§å˜æ¢</strong>å°†å…¶è½¬æ¢åˆ°$[0,1]$ã€‚åˆ«å¿˜äº†æœ€åé‡‡æ ·åï¼Œéœ€è¦å†åšä¸€æ¬¡çº¿æ€§é€†å˜æ¢ã€‚</p></blockquote>
<p><strong>ğŸ§± Step 1: äºŒè¿›åˆ¶åˆ’åˆ†åŒºé—´</strong></p>
<p>æˆ‘ä»¬å°†åŒºé—´ [0, 1] åˆ†æˆ $2^N$ ä¸ªå­åŒºé—´ï¼Œæ¯”å¦‚ $N = 3$ æ—¶ï¼š</p>
<ul>
<li>000 â†’ $[0, \frac{1}{8})$</li>
<li>001 â†’ $[\frac{1}{8}, \frac{2}{8})$</li>
<li>&hellip;</li>
<li>111 â†’ $[\frac{7}{8}, 1)$</li>
</ul>
<p>è¿™äº›å¯ä»¥å¯¹åº”ä¸º <strong>äºŒè¿›åˆ¶ç¼–ç çš„åŒºé—´ç¼–å·</strong>ã€‚</p>
<p><strong>ğŸ§  Step 2: åˆ©ç”¨æ¡ä»¶æ¦‚ç‡æ„å»ºä¸€ä¸ªæ ·æœ¬ç‚¹</strong></p>
<p>æˆ‘ä»¬ä¸ä¸€æ¬¡æ€§è®¡ç®—æ‰€æœ‰ $2^N$ ä¸ªåŒºé—´çš„æ¦‚ç‡ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ª<strong>é€ä½å†³ç­–è¿‡ç¨‹</strong>æ¥â€œèµ°â€è¿›ä¸€ä¸ªåŒºé—´ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬å·²ç»ç”Ÿæˆäº†å‰ $k$ ä½ï¼š $b_1 b_2 \dots b_k$</p>
<p>é‚£ä¹ˆè¿™ä¸€éƒ¨åˆ†æ‰€å¯¹åº”çš„åŒºé—´æ˜¯ï¼š</p>
$$
I_k = \left[\frac{b}{2^k}, \frac{b+1}{2^k}\right), \quad b = \sum_{i=1}^k b_i \cdot 2^{k-i}
$$<p>ä¸‹ä¸€ä½çš„å€¼ $b_{k+1} \in \{0, 1\}$ å°†è¿›ä¸€æ­¥æŠŠ $I_k$ åˆ†æˆå·¦åŠæˆ–å³åŠã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡<strong>è®¡ç®—æ¡ä»¶æ¦‚ç‡</strong>ï¼š</p>
$$
\mathbb{P}(b_{k+1} = 0 \mid b_1 b_2 \dots b_k) = \frac{\mathbb{P}(x \in \text{left half of } I_k)}{\mathbb{P}(x \in I_k)}
$$<p>ç”¨è¿™ä¸ªæ¡ä»¶æ¦‚ç‡æ·ä¸€ä¸ªç¡¬å¸ï¼Œå†³å®šä¸‹ä¸€ä½æ˜¯ 0 è¿˜æ˜¯ 1ã€‚é‡å¤ $N$ æ¬¡ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªè¿‘ä¼¼é‡‡æ ·ç»“æœï¼š</p>
$$
x = \sum_{i=1}^N b_i \cdot 2^{-i} \text{, where } b_i = \{0,1\}
$$<h4 id="-æ€»ç»“æµç¨‹">ğŸ“Œ æ€»ç»“æµç¨‹</h4>
<ol>
<li>
<p><strong>åˆå§‹åŒºé—´</strong>ï¼š[0,1]</p>
</li>
<li>
<p><strong>æ¯ä¸€æ­¥</strong>ï¼š</p>
<ul>
<li>å°†å½“å‰åŒºé—´åˆ†ä¸ºå·¦å³ä¸¤åŠ</li>
<li>è®¡ç®—å·¦åŠåŒºé—´çš„æ¦‚ç‡ $p_L$</li>
<li>ç”¨ $p_L$ è¿›è¡Œä¼¯åŠªåˆ©é‡‡æ ·ï¼Œå†³å®šæ˜¯èµ°å·¦è¾¹ï¼ˆbit=0ï¼‰è¿˜æ˜¯å³è¾¹ï¼ˆbit=1ï¼‰</li>
</ul>
</li>
<li>
<p><strong>è¿­ä»£ N æ¬¡å</strong>ï¼Œä½ å°±å¾—åˆ°äº†ä¸€ä¸ªäºŒè¿›åˆ¶è¡¨è¾¾ $b_1b_2...b_N$</p>
</li>
<li>
<p><strong>æœ€ç»ˆé‡‡æ ·å€¼</strong>ï¼š$x = \sum_{i=1}^N b_i \cdot 2^{-i}$ï¼Œå±äº [0,1] ä¸Šçš„æŸä¸ªå­åŒºé—´ä¸­</p>
</li>
</ol>
<blockquote>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸€æ¬¡æ„é€ æ‰€æœ‰åŒºé—´çš„æ¦‚ç‡ï¼Œå°†å…¶è½¬æ¢ä¸ºç¦»æ•£å‹ï¼Œå†ä½¿ç”¨ç¦»æ•£å‹éšæœºå˜é‡çš„é‡‡æ ·æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œåå‡½æ•°æ³•ï¼‰è¿›è¡Œé‡‡æ ·ã€‚</p></blockquote>
<h4 id="-ä¼˜ç‚¹">âœ… ä¼˜ç‚¹</h4>
<ul>
<li><strong>é€‚ç”¨äºä»»æ„è¿ç»­åˆ†å¸ƒ</strong>ï¼Œåªè¦èƒ½è®¡ç®—åŒºé—´æ¦‚ç‡</li>
<li><strong>æ— éœ€æ±‚é€†CDFæˆ–æ ‡å‡†å˜æ¢</strong></li>
<li>å¯ç”¨äºä¸¥æ ¼é‡‡æ ·ã€æµ‹è¯•ã€æ¨¡æ‹Ÿå¤æ‚åˆ†å¸ƒ</li>
</ul>
<h4 id="-æ³¨æ„äº‹é¡¹-1">âš ï¸ æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>ç²¾åº¦ç”± $N$ æ§åˆ¶ï¼šè¶Šå¤§è¶Šç²¾ç¡®ï¼Œä½†è®¡ç®—ä»£ä»·è¶Šé«˜ï¼›
<ul>
<li>$\epsilon=log_2N$</li>
</ul>
</li>
<li>å¿…é¡»èƒ½è®¡ç®—ä»»æ„åŒºé—´ $[a,b]$ çš„æ¦‚ç‡ï¼šä¾‹å¦‚é€šè¿‡ CDF å‡½æ•°ï¼›</li>
<li>å’Œæ™®é€šâ€œå…ˆé‡‡ uniform å†æ±‚é€†CDFâ€çš„æ–¹å¼ä¸åŒï¼Œè¿™æ˜¯ä¸€ç§æ„é€ æ€§çš„ã€ä½çº§åˆ«çš„é‡‡æ ·æ–¹å¼ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®å‚æ•°</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span> <span style="color:#75715e"># æ ‘çš„æ·±åº¦ï¼ˆä¹Ÿå³å°† [0,1] åˆ’åˆ†ä¸º 2^6 = 64 ä¸ªåŒºé—´ï¼‰</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">draw_path</span>(ax, level, x0, x1, path<span style="color:#f92672">=</span>[]):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> level <span style="color:#f92672">&gt;</span> N:
</span></span><span style="display:flex;"><span>        x_mid <span style="color:#f92672">=</span> (x0 <span style="color:#f92672">+</span> x1) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        y <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>level
</span></span><span style="display:flex;"><span>        ax<span style="color:#f92672">.</span>plot(x_mid, y, <span style="color:#e6db74">&#39;ko&#39;</span>)  <span style="color:#75715e"># ç”»å¶å­èŠ‚ç‚¹</span>
</span></span><span style="display:flex;"><span>        bin_label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(str(b) <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> path)
</span></span><span style="display:flex;"><span>        ax<span style="color:#f92672">.</span>text(x_mid, y <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.2</span>, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>bin_label<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, ha<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;center&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    x_mid <span style="color:#f92672">=</span> (x0 <span style="color:#f92672">+</span> x1) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>level
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>plot(x_mid, y, <span style="color:#e6db74">&#39;ko&#39;</span>)  <span style="color:#75715e"># å½“å‰èŠ‚ç‚¹</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å·¦è¾¹</span>
</span></span><span style="display:flex;"><span>    draw_path(ax, level <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, x0, x_mid, path <span style="color:#f92672">+</span> [<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>plot([x_mid, (x0 <span style="color:#f92672">+</span> x_mid) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>], [y, y <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>], <span style="color:#e6db74">&#39;gray&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å³è¾¹</span>
</span></span><span style="display:flex;"><span>    draw_path(ax, level <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, x_mid, x1, path <span style="color:#f92672">+</span> [<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>plot([x_mid, (x1 <span style="color:#f92672">+</span> x_mid) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>], [y, y <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>], <span style="color:#e6db74">&#39;gray&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”»å›¾</span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>draw_path(ax, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.0</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#f92672">-</span>N <span style="color:#f92672">-</span> <span style="color:#ae81ff">1.5</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.05</span>, <span style="color:#ae81ff">1.05</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_yticks([])
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;Interval on [0,1]&#34;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Grid Sampling: Binary Tree Partition (N=6)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>, axis<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;x&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_132_0.png" alt="png"></p>
<h4 id="-ä¸¾ä¾‹">ğŸ§ª ä¸¾ä¾‹ï¼š$\text{Beta}(2,5)$ï¼‰</h4>
<p><strong>ç›®æ ‡</strong>ï¼šæˆ‘ä»¬å·²çŸ¥ä¸€ä¸ªè¿ç»­åˆ†å¸ƒï¼ˆå¦‚ Beta åˆ†å¸ƒï¼‰çš„ PDFï¼Œå¯ä»¥è®¡ç®—ä»»æ„åŒºé—´çš„æ¦‚ç‡ï¼Œä½†ä¸èƒ½ç›´æ¥åè§£å…¶ CDFã€‚</p>
<h5 id="step-1-å°†åŒºé—´-0-1-ç¦»æ•£åŒ–ä¸º-2â¿-ä¸ªå­åŒºé—´">Step 1: å°†åŒºé—´ [0, 1] ç¦»æ•£åŒ–ä¸º 2â¿ ä¸ªå­åŒºé—´</h5>
<p>æ¯”å¦‚ <code>N = 10</code>ï¼Œå°† <code>[0,1]</code> å‡åˆ†ä¸º 1024 ä¸ªå°åŒºé—´ï¼Œæ¯ä¸ªåŒºé—´å®½åº¦ä¸º $\Delta x = \frac{1}{1024}$ã€‚</p>
<h5 id="step-2-åœ¨æ¯ä¸ªå­åŒºé—´çš„ä¸­ç‚¹å¤„è®¡ç®—-pdfå¹¶ç”¨è¿™äº›è¿‘ä¼¼æ¦‚ç‡æ¥æ„é€ ç¦»æ•£-pmf">Step 2: åœ¨æ¯ä¸ªå­åŒºé—´çš„ä¸­ç‚¹å¤„è®¡ç®— PDFï¼Œå¹¶ç”¨è¿™äº›è¿‘ä¼¼æ¦‚ç‡æ¥æ„é€ ç¦»æ•£ PMF</h5>
<p>æˆ‘ä»¬ç”¨ beta.pdf è®¡ç®—æ¯ä¸ªä¸­ç‚¹çš„æ¦‚ç‡å¯†åº¦ï¼Œå½’ä¸€åŒ–å¾—åˆ°ä¸€ç»„è¿‘ä¼¼çš„æ¦‚ç‡å€¼ $p_i$ï¼Œå½¢æˆä¸€ä¸ªç¦»æ•£åˆ†å¸ƒã€‚</p>
<h5 id="step-3-æ„å»º-cdfç„¶åä½¿ç”¨ä¸€ä¸ª-uniform01-éšæœºå˜é‡-u-æ¥æŸ¥æ‰¾-u-è½å…¥å“ªä¸ªç´¯ç§¯æ¦‚ç‡åŒºé—´">Step 3: æ„å»º CDFï¼Œç„¶åä½¿ç”¨ä¸€ä¸ª Uniform(0,1) éšæœºå˜é‡ <code>u</code> æ¥æŸ¥æ‰¾ <code>u</code> è½å…¥å“ªä¸ªç´¯ç§¯æ¦‚ç‡åŒºé—´</h5>
<p>æˆ‘ä»¬ç”¨ <code>np.searchsorted(cdf, u)</code> æ‰¾åˆ°å¯¹åº”åŒºé—´ï¼Œå†è¿”å›è¯¥åŒºé—´ä¸­ç‚¹ä½œä¸ºé‡‡æ ·å€¼ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> beta
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½® beta åˆ†å¸ƒå‚æ•°</span>
</span></span><span style="display:flex;"><span>a, b <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>  <span style="color:#75715e"># Beta(2,5)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ ·æœ¬æ•°é‡å’Œåˆ†å‰²æ·±åº¦</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>  <span style="color:#75715e"># å°†åŒºé—´ [0,1] åˆ†ä¸º 2^N = 1024 ä¸ªå°åŒºé—´</span>
</span></span><span style="display:flex;"><span>num_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»ºåŒºé—´åˆ’åˆ†</span>
</span></span><span style="display:flex;"><span>intervals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>N <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>midpoints <span style="color:#f92672">=</span> (intervals[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> intervals[<span style="color:#ae81ff">1</span>:]) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#75715e"># åŒºé—´ä¸­ç‚¹</span>
</span></span><span style="display:flex;"><span>probs <span style="color:#f92672">=</span> beta<span style="color:#f92672">.</span>pdf(midpoints, a, b) <span style="color:#75715e"># åŒºé—´ä¸­ç‚¹çš„æ¦‚ç‡å¯†åº¦</span>
</span></span><span style="display:flex;"><span>probs <span style="color:#f92672">/=</span> probs<span style="color:#f92672">.</span>sum()  <span style="color:#75715e"># å½’ä¸€åŒ–æˆæ¦‚ç‡ï¼Œä»è€Œè·å¾—ä¸€ä¸ªæ–°çš„ç¦»æ•£åˆ†å¸ƒ</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCDFï¼‰</span>
</span></span><span style="display:flex;"><span>cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(probs) <span style="color:#75715e"># åŸºäºè¿™ä¸ªæ–°çš„ç¦»æ•£åˆ†å¸ƒæ„å»º CDF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Grid sampling: åœ¨æ¯æ¬¡é‡‡æ ·æ—¶åªç”¨ä¸€ä¸ªå‡åŒ€éšæœºæ•°æŸ¥æ‰¾æ‰€å±åŒºé—´</span>
</span></span><span style="display:flex;"><span>uniform_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(num_samples)
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> u <span style="color:#f92672">in</span> uniform_samples:
</span></span><span style="display:flex;"><span>    idx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>searchsorted(cdf, u)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># é€‰æ‹©è¯¥åŒºé—´çš„ä¸­ç‚¹ä½œä¸ºé‡‡æ ·å€¼</span>
</span></span><span style="display:flex;"><span>    samples<span style="color:#f92672">.</span>append(midpoints[idx])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯è§†åŒ–ç»“æœ</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>pdf <span style="color:#f92672">=</span> beta<span style="color:#f92672">.</span>pdf(x, a, b)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Sampled Histogram&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, pdf, <span style="color:#e6db74">&#39;r-&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Beta PDF a=</span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">, b=</span><span style="color:#e6db74">{</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Sampling Beta(2,5) using Grid Sampler (Îµ=</span><span style="color:#e6db74">{</span><span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>N)<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Density&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_134_0.png" alt="png"></p>
<h4 id="å¦ä¸€ç§å®ç°ä»¥-beta25-åˆ†å¸ƒä¸ºä¾‹">å¦ä¸€ç§å®ç°ï¼šä»¥ Beta(2,5) åˆ†å¸ƒä¸ºä¾‹</h4>
<p>æ­¥éª¤ï¼šæ¯æ¬¡å°†åŒºé—´ä¸€åˆ†ä¸ºäºŒï¼Œè®¡ç®—å·¦è¾¹çš„æ¦‚ç‡ï¼Œç”¨å®ƒè¿›è¡Œä¼¯åŠªåˆ©é‡‡æ ·ï¼Œæœ€ç»ˆæ‹¼å‡ºä¸€ä¸ªäºŒè¿›åˆ¶å°æ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> beta
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">grid_sampler</span>(cdf_func, N):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ä½¿ç”¨ Grid Sampler ä» [0,1] ä¸Šé‡‡æ ·
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param cdf_func: ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆä¾‹å¦‚ scipy.stats.beta(a,b).cdfï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param N: è¿­ä»£æ¬¡æ•°ï¼ˆæ§åˆ¶ç²¾åº¦ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :return: é‡‡æ ·å€¼ x âˆˆ [0,1]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    left, right <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>    x_bits <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(N):
</span></span><span style="display:flex;"><span>        mid <span style="color:#f92672">=</span> (left <span style="color:#f92672">+</span> right) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        p_left <span style="color:#f92672">=</span> (cdf_func(mid) <span style="color:#f92672">-</span> cdf_func(left)) <span style="color:#f92672">/</span> (cdf_func(right) <span style="color:#f92672">-</span> cdf_func(left))  <span style="color:#75715e"># å½’ä¸€åŒ–æ¡ä»¶æ¦‚ç‡</span>
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand() <span style="color:#f92672">&lt;</span> p_left  <span style="color:#75715e"># ä¼¯åŠªåˆ©é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>        x_bits<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">if</span> b <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># æ›´æ–°åŒºé—´</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> b:
</span></span><span style="display:flex;"><span>            right <span style="color:#f92672">=</span> mid
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            left <span style="color:#f92672">=</span> mid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å°†äºŒè¿›åˆ¶ç»“æœè½¬æ¢ä¸º [0,1] ä¸Šçš„å°æ•°å€¼</span>
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> sum(bit <span style="color:#f92672">*</span> (<span style="color:#ae81ff">0.5</span> <span style="color:#f92672">**</span> (i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)) <span style="color:#66d9ef">for</span> i, bit <span style="color:#f92672">in</span> enumerate(x_bits))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®å‚æ•°</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>  <span style="color:#75715e"># ç²¾åº¦æ§åˆ¶</span>
</span></span><span style="display:flex;"><span>samples <span style="color:#f92672">=</span> [grid_sampler(beta(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>)<span style="color:#f92672">.</span>cdf, N) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10000</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯è§†åŒ–</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(samples, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.6</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sampled via Grid Sampler&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, beta<span style="color:#f92672">.</span>pdf(x, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>), label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Beta(2,5) PDF&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Grid Sampling from Beta(2,5)&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Density&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_136_0.png" alt="png"></p>
<h3 id="æ¥å—-æ‹’ç»é‡‡æ ·acceptance-rejection-sampling">æ¥å—-æ‹’ç»é‡‡æ ·ï¼ˆAcceptance-Rejection Samplingï¼‰</h3>
<p>Acceptance-Rejection Samplingï¼ˆæ¥å—-æ‹’ç»é‡‡æ ·ï¼Œç®€ç§° AR é‡‡æ ·ï¼‰æ˜¯ä¸€ç§éå¸¸é‡è¦ä¸”ç›´è§‚çš„ <strong>ä»å¤æ‚åˆ†å¸ƒä¸­é‡‡æ ·çš„æ–¹æ³•</strong>ï¼Œç‰¹åˆ«é€‚åˆå½“ï¼š</p>
<ul>
<li>âœ… ç›®æ ‡åˆ†å¸ƒçš„ <strong>æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆPDFï¼‰å¯è®¡ç®—</strong>ï¼›</li>
<li>ğŸš« ç›®æ ‡åˆ†å¸ƒçš„ <strong>CDF æ— æ³•åè§£</strong>ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨åå‡½æ•°é‡‡æ ·ï¼›</li>
<li>âœ… ä½ æœ‰ä¸€ä¸ª<strong>å®¹æ˜“é‡‡æ ·çš„è¾…åŠ©åˆ†å¸ƒï¼ˆproposal distributionï¼‰</strong>ã€‚</li>
</ul>
<p><strong>ğŸ§  åŸºæœ¬æ€æƒ³</strong></p>
<p>å¦‚æœä½ ä¸èƒ½ç›´æ¥ä»å¤æ‚åˆ†å¸ƒ $p(x)$ é‡‡æ ·ï¼Œé‚£å°±ï¼š</p>
<ol>
<li>ä»ä¸€ä¸ªå®¹æ˜“é‡‡æ ·çš„åˆ†å¸ƒ $q(x)$ é‡‡æ ·ï¼›</li>
<li>ç„¶åâ€œç­›é€‰â€å‡ºè½åœ¨ç›®æ ‡åˆ†å¸ƒ $p(x)$ ä¸‹çš„ç‚¹ï¼</li>
</ol>
<h4 id="-ç†è®ºåŸºç¡€">ğŸ“Œ ç†è®ºåŸºç¡€</h4>
<p>ä»æ˜“é‡‡æ ·çš„åˆ†å¸ƒä¸­<strong>ç­›é€‰å‡º</strong>æœä» $p(x)$ çš„æ ·æœ¬</p>
<p>æˆ‘ä»¬å¼•å…¥ä¸€ä¸ª proposal distribution $q(x)$ï¼Œå¹¶è¦æ±‚å­˜åœ¨å¸¸æ•° $M \geq 1$ï¼Œä½¿å¾—ï¼š</p>
$$
p(x) \leq M q(x),\quad \text{å¯¹æ‰€æœ‰ } x
$$<p>è¿™æ ·ï¼Œ$Mq(x)$ å°±æ˜¯ $p(x)$ çš„â€œä¸Šç•Œâ€ã€‚</p>
<h5 id="-ç†è®ºåŸºç¡€ä¸€è”åˆåˆ†å¸ƒä¸è¾¹ç¼˜åˆ†å¸ƒ">âœ… ç†è®ºåŸºç¡€ä¸€ï¼š<strong>è”åˆåˆ†å¸ƒä¸è¾¹ç¼˜åˆ†å¸ƒ</strong></h5>
<p>æˆ‘ä»¬æ„é€ ä¸€ä¸ªäºŒç»´è”åˆåˆ†å¸ƒï¼š</p>
$$
(x, u) \sim \text{joint distribution}, \quad x \sim q(x),\quad u \sim \text{Uniform}(0, 1)
$$<p>ç„¶åå®šä¹‰ä¸€ä¸ªäºŒç»´åŒºåŸŸï¼š</p>
$$
\mathcal{A} = \left\{ (x, u) : u \leq \frac{p(x)}{Mq(x)} \right\}
$$<p>é‚£ä¹ˆæˆ‘ä»¬åœ¨ $(x, u) \in \mathcal{A}$ ä¸­ä¿ç•™çš„ $x$ï¼Œå…¶<strong>è¾¹ç¼˜åˆ†å¸ƒ</strong>å°±æ˜¯ $p(x)$ï¼</p>
<p>è¿™ç‚¹å¯ä»è”åˆå¯†åº¦æ¨å¯¼ï¼š</p>
<p>è®¾è”åˆå¯†åº¦ä¸ºï¼š</p>
$$
f(x, u) = q(x) \cdot \mathbb{1}\left( 0 \leq u \leq \frac{p(x)}{Mq(x)} \right)
$$<p>é‚£ä¹ˆå¯¹ $x$ çš„è¾¹ç¼˜å¯†åº¦ï¼š</p>
$$
f_{\text{accepted}}(x) = \int_0^{\frac{p(x)}{Mq(x)}} q(x) \, du = q(x)\cdot \frac{p(x)}{Mq(x)} = \frac{p(x)}{M}
$$<p>å³æ¯ä¸ªä¿ç•™ä¸‹æ¥çš„ $x$ï¼Œåˆ†å¸ƒæ¯”ä¾‹ä¸º $\propto p(x)$ã€‚è¯´æ˜æ¥å—çš„æ ·æœ¬æ­£æ¯”äº $p(x)$ï¼Œå³æˆ‘ä»¬ä» $p(x)$ ä¸­é‡‡æ ·äº†ï¼</p>
<h5 id="-ç†è®ºåŸºç¡€äºŒæŠ½æ ·ä¸€è‡´æ€§">âœ… ç†è®ºåŸºç¡€äºŒï¼š<strong>æŠ½æ ·ä¸€è‡´æ€§</strong></h5>
<p>è™½ç„¶æˆ‘ä»¬ä½¿ç”¨äº†â€œæ‹’ç»â€çš„æœºåˆ¶ï¼Œä½†è¿™å…¶å®å°±ç­‰ä»·äº<strong>å¯¹ä¸€ä¸ªæ›´å¤§çš„åˆ†å¸ƒè¿›è¡Œæ¡ä»¶é‡‡æ ·</strong>ï¼š</p>
<p>æˆ‘ä»¬ä»è”åˆåˆ†å¸ƒ $f(x, u) = q(x) \cdot \text{Unif}[0, Mq(x)]$ ä¸­é‡‡æ ·ï¼Œç„¶åä¿ç•™ç¬¦åˆæ¡ä»¶çš„ç‚¹ã€‚</p>
<p><strong>ä¿ç•™ä¸‹æ¥çš„ $x$</strong> çš„åˆ†å¸ƒæ˜¯ï¼š</p>
$$
p_{\text{accept}}(x) = \frac{p(x)}{M}
\Rightarrow \text{Normalizeåä»æ˜¯ } p(x)
$$<h4 id="-ç®—æ³•æ­¥éª¤">ğŸ² ç®—æ³•æ­¥éª¤</h4>
<p>å¯¹äºæ¯ä¸ªæ ·æœ¬ï¼š</p>
<ol>
<li>ä» proposal åˆ†å¸ƒ $q(x)$ ä¸­é‡‡æ ·ä¸€ä¸ªå€™é€‰ç‚¹ $x \sim q(x)$</li>
<li>ä»å‡åŒ€åˆ†å¸ƒ $u \sim \text{Uniform}(0,1)$ é‡‡ä¸€ä¸ªè¾…åŠ©å˜é‡</li>
<li>æ¥å— $x$ å½“ä¸”ä»…å½“ï¼š</li>
</ol>
$$
u \leq \frac{f(x)}{M \cdot q(x)}
$$<p>å¦åˆ™æ‹’ç»ï¼Œé‡æ–°é‡‡æ ·ã€‚</p>
<h4 id="-æ¥å—ç‡å’Œæ•ˆç‡">ğŸ“ˆ æ¥å—ç‡å’Œæ•ˆç‡</h4>
<p>æ¥å—ç‡ï¼ˆacceptance rateï¼‰ä¸ºï¼š</p>
$$
\text{Accept Rate} = \frac{1}{M}
$$<p>å› æ­¤ï¼Œ<strong>é€‰æ‹©å°½å¯èƒ½æ¥è¿‘ $f(x)$ çš„ $M \cdot q(x)$</strong> å¾ˆé‡è¦ï¼Œè¿™æ ·å¯ä»¥å‡å°‘æµªè´¹ã€‚</p>
<h4 id="-ä¼˜ç‚¹-1">âœ… ä¼˜ç‚¹</h4>
<ul>
<li>ä¸éœ€è¦å½’ä¸€åŒ–å¸¸æ•° $Z$ï¼Œå¯ç”¨äºå¤æ‚åˆ†å¸ƒï¼ˆå¦‚æœªå½’ä¸€åŒ–çš„ posteriorï¼‰</li>
<li>ç†è®ºç®€å•ï¼Œç›´è§‚</li>
</ul>
<h4 id="-ç¼ºç‚¹">âš ï¸ ç¼ºç‚¹</h4>
<ul>
<li>æ¥å—ç‡å¯èƒ½éå¸¸ä½ï¼ˆå°¤å…¶æ˜¯é«˜ç»´æƒ…å†µä¸‹ï¼‰</li>
<li>å¿…é¡»æ‰¾åˆ°åˆé€‚çš„ proposal åˆ†å¸ƒå’Œåˆç†çš„ M</li>
</ul>
<p><strong>ğŸ§  æ€»ç»“ä¸€å¥è¯</strong></p>
<blockquote>
<p><strong>æ¥å—-æ‹’ç»é‡‡æ ·å°±æ˜¯ç”¨ä¸€ä¸ªå®¹æ˜“é‡‡æ ·çš„â€œå¤–å£³â€åŒ…ä½ç›®æ ‡åˆ†å¸ƒï¼Œç„¶åéšæœºæ’’ç‚¹ï¼Œç•™ä¸‹è½åœ¨ç›®æ ‡åŒºåŸŸçš„é‚£äº›ç‚¹ã€‚</strong></p></blockquote>
<h4 id="åˆè§">åˆè§</h4>
<ul>
<li><a href="https://bocaiwen.github.io/accept-reject-sampling.html">æ¥å—/æ‹’ç»é‡‡æ · (Accept-Reject Sampling)</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> plotly.graph_objects <span style="color:#66d9ef">as</span> go
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> beta
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾ç½®ç›®æ ‡åˆ†å¸ƒå’Œ proposal</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> beta<span style="color:#f92672">.</span>pdf(x, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">g</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1.0</span>  <span style="color:#75715e"># Uniform(0,1) ä¸Šçš„å¯†åº¦</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®¾å®šå¸¸æ•° M</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>fx_vals <span style="color:#f92672">=</span> f(x_vals)
</span></span><span style="display:flex;"><span>gx_vals <span style="color:#f92672">=</span> g(x_vals)
</span></span><span style="display:flex;"><span>M <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>max(fx_vals)  <span style="color:#75715e"># M &gt;= max(f(x)/g(x))ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ g(x)=1ï¼Œæ‰€ä»¥M=max(f(x))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¼€å§‹é‡‡æ ·</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>x_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, N)
</span></span><span style="display:flex;"><span>u_samples <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, N)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>accepted_x <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>accepted_y <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>rejected_x <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>rejected_y <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> x, u <span style="color:#f92672">in</span> zip(x_samples, u_samples):
</span></span><span style="display:flex;"><span>    threshold <span style="color:#f92672">=</span> f(x) <span style="color:#f92672">/</span> M
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> u <span style="color:#f92672">&lt;</span> threshold:
</span></span><span style="display:flex;"><span>        accepted_x<span style="color:#f92672">.</span>append(x)
</span></span><span style="display:flex;"><span>        accepted_y<span style="color:#f92672">.</span>append(u <span style="color:#f92672">*</span> M)  <span style="color:#75715e"># æ˜ å°„å› f(x) çš„é«˜åº¦ç©ºé—´</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        rejected_x<span style="color:#f92672">.</span>append(x)
</span></span><span style="display:flex;"><span>        rejected_y<span style="color:#f92672">.</span>append(u <span style="color:#f92672">*</span> M)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºäº¤äº’å›¾</span>
</span></span><span style="display:flex;"><span>fig <span style="color:#f92672">=</span> go<span style="color:#f92672">.</span>Figure()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç›®æ ‡åˆ†å¸ƒ f(x)</span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>x_vals, y<span style="color:#f92672">=</span>fx_vals, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lines&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Target f(x)&#39;</span>, line<span style="color:#f92672">=</span>dict(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Proposal åˆ†å¸ƒ M * g(x)</span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>x_vals, y<span style="color:#f92672">=</span>[M <span style="color:#f92672">*</span> g(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> x_vals], mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lines&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Mg(x)&#39;</span>, line<span style="color:#f92672">=</span>dict(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>, dash<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;dash&#39;</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Accepted samples</span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>accepted_x, y<span style="color:#f92672">=</span>accepted_y, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;markers&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Accepted&#39;</span>, marker<span style="color:#f92672">=</span>dict(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;green&#39;</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Rejected samples</span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>add_trace(go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>rejected_x, y<span style="color:#f92672">=</span>rejected_y, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;markers&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Rejected&#39;</span>, marker<span style="color:#f92672">=</span>dict(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>, opacity<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>update_layout(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Acceptance-Rejection Sampling with Joint Distribution View&#39;</span>,
</span></span><span style="display:flex;"><span>                  xaxis_title<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;x&#39;</span>, yaxis_title<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;y&#39;</span>,
</span></span><span style="display:flex;"><span>                  height<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>, width<span style="color:#f92672">=</span><span style="color:#ae81ff">800</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.animation <span style="color:#66d9ef">as</span> animation
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Target distribution: p(x) âˆ exp(-x^2 / 2) (standard normal, unnormalized)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">p</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Proposal distribution: uniform over [-3, 3]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">q</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>full_like(x, <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># M such that p(x) &lt;= M * q(x)</span>
</span></span><span style="display:flex;"><span>M <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi) <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">6</span>)  <span style="color:#75715e"># since max(p) = 1 when x=0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate samples</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>n_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>x_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>, n_samples)
</span></span><span style="display:flex;"><span>u_vals <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0</span>, M <span style="color:#f92672">*</span> q(x_vals), n_samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create acceptance mask</span>
</span></span><span style="display:flex;"><span>accept <span style="color:#f92672">=</span> u_vals <span style="color:#f92672">&lt;=</span> p(x_vals)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Prepare animation frames</span>
</span></span><span style="display:flex;"><span>x_range <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>frames <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, n_samples, <span style="color:#ae81ff">20</span>):
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>clear()
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>plot(x_range, p(x_range), label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Target p(x)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>plot(x_range, M <span style="color:#f92672">*</span> q(x_range), label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;M * q(x)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>scatter(x_vals[:i], u_vals[:i], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, s<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Rejected&#39;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>scatter(x_vals[:i][accept[:i]], u_vals[:i][accept[:i]], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;green&#39;</span>, s<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Accepted&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#ae81ff">0</span>, M <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.1</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>max(q(x_range)))
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Acceptance-Rejection Sampling&#34;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;upper right&#39;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Capture the current frame</span>
</span></span><span style="display:flex;"><span>    frame <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>gcf()<span style="color:#f92672">.</span>canvas<span style="color:#f92672">.</span>copy_from_bbox(ax<span style="color:#f92672">.</span>bbox)
</span></span><span style="display:flex;"><span>    frames<span style="color:#f92672">.</span>append([plt<span style="color:#f92672">.</span>scatter([], [])])  <span style="color:#75715e"># dummy to hold frames</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Re-render using FuncAnimation</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update</span>(i):
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>clear()
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>plot(x_range, p(x_range), label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Target p(x)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>plot(x_range, M <span style="color:#f92672">*</span> q(x_range), label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;M * q(x) (M=</span><span style="color:#e6db74">{</span>M<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">)&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>scatter(x_vals[:i], u_vals[:i], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, s<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Rejected&#39;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>scatter(x_vals[:i][accept[:i]], u_vals[:i][accept[:i]], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;green&#39;</span>, s<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Accepted&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#ae81ff">0</span>, M <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.1</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>max(q(x_range)))
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Acceptance-Rejection Sampling (Step </span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;upper right&#39;</span>)
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ani <span style="color:#f92672">=</span> animation<span style="color:#f92672">.</span>FuncAnimation(fig, update, frames<span style="color:#f92672">=</span>range(<span style="color:#ae81ff">0</span>, n_samples, <span style="color:#ae81ff">20</span>), interval<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Save as GIF</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib.animation <span style="color:#f92672">import</span> PillowWriter
</span></span><span style="display:flex;"><span>ani<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#34;acceptance_rejection_sampling.gif&#34;</span>, writer<span style="color:#f92672">=</span>PillowWriter(fps<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>close(fig)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span>Image(filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;acceptance_rejection_sampling.gif&#34;</span>)
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/acceptance_rejection_sampling.gif" alt="png"></p>
<h1 id="é™„å½•">é™„å½•</h1>
<h2 id="ä»å·²çŸ¥äºŒç»´éšæœºå˜é‡-x-y-ä¸­é‡‡æ ·å…¶æåæ ‡å˜æ¢åçš„éšæœºå˜é‡">ä»å·²çŸ¥äºŒç»´éšæœºå˜é‡ (X, Y) ä¸­é‡‡æ ·å…¶æåæ ‡å˜æ¢åçš„éšæœºå˜é‡</h2>
<p>ä»å·²çŸ¥äºŒç»´éšæœºå˜é‡ $(X, Y)$ ä¸­é‡‡æ ·å…¶æåæ ‡å˜æ¢åçš„éšæœºå˜é‡ $(R^2, \alpha)$ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li>$r^2 = x^2 + y^2$ï¼ŒèŒƒå›´ä¸º $(0, \infty)$</li>
<li>$\alpha = \arctan(y/x)$ï¼ŒèŒƒå›´ä¸º $(0, 2\pi)$</li>
</ul>
<h3 id="-1-å˜é‡å˜æ¢å’Œé›…å¯æ¯”jacobianæ¨å¯¼">ğŸ§® 1. å˜é‡å˜æ¢å’Œé›…å¯æ¯”ï¼ˆJacobianï¼‰æ¨å¯¼</h3>
<p>æˆ‘ä»¬å®šä¹‰æ–°çš„å˜é‡ï¼š</p>
$$
\begin{cases}
u(x,y) = r^2 = x^2 + y^2 \\
v(x,y) = \alpha = \arctan\left(\frac{y}{x}\right)
\end{cases}
\Rightarrow
\begin{cases}
x = \sqrt{u} \cos v \\
y = \sqrt{u} \sin v
\end{cases}
$$<p>è®¡ç®— <a href="https://zh.wikipedia.org/wiki/%E9%9B%85%E5%8F%AF%E6%AF%94%E7%9F%A9%E9%98%B5">Jacobian</a>ï¼š</p>
<p>æˆ‘ä»¬è®¡ç®—ä» $(u, v)$ åˆ° $(x, y)$ çš„é›…å¯æ¯”è¡Œåˆ—å¼ï¼š</p>
$$
J = 
\begin{vmatrix}
\frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} \\
\frac{\partial y}{\partial u} & \frac{\partial y}{\partial v}
\end{vmatrix}
$$<p>å…ˆæ±‚å¯¼ï¼š</p>
<ul>
<li>$\frac{\partial x}{\partial u} = \frac{1}{2\sqrt{u}} \cos v$</li>
<li>$\frac{\partial x}{\partial v} = -\sqrt{u} \sin v$</li>
<li>$\frac{\partial y}{\partial u} = \frac{1}{2\sqrt{u}} \sin v$</li>
<li>$\frac{\partial y}{\partial v} = \sqrt{u} \cos v$</li>
</ul>
<p>ä»£å…¥ Jacobianï¼š</p>
$$
J = 
\left| 
\begin{matrix}
\frac{1}{2\sqrt{u}} \cos v & -\sqrt{u} \sin v \\
\frac{1}{2\sqrt{u}} \sin v & \sqrt{u} \cos v
\end{matrix}
\right|
= \frac{1}{2\sqrt{u}} \cos v \cdot \sqrt{u} \cos v + \sqrt{u} \sin v \cdot \frac{1}{2\sqrt{u}} \sin v
= \frac{1}{2}(\cos^2 v + \sin^2 v) = \frac{1}{2}
$$<p>æ‰€ä»¥é›…å¯æ¯”è¡Œåˆ—å¼ä¸ºï¼š</p>
$$
|J| = \frac{1}{2}
$$<h3 id="-2-å¯†åº¦å‡½æ•°å˜æ¢å…¬å¼">ğŸ§ª 2. å¯†åº¦å‡½æ•°å˜æ¢å…¬å¼</h3>
<p>è‹¥ $(X, Y)$ çš„è”åˆå¯†åº¦ä¸º $f_{X,Y}(x,y)$ï¼Œåˆ™å˜æ¢åï¼š</p>
$$
f_{R^2, \alpha}(u, v) = f_{X,Y}(x(u,v), y(u,v)) \cdot \left|J\right|^{-1} = 2 f_{X,Y}(\sqrt{u} \cos v, \sqrt{u} \sin v)
$$<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»º (x, y) ç½‘æ ¼</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">400</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">400</span>)
</span></span><span style="display:flex;"><span>X, Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(x, y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŸå§‹åæ ‡ç³»ä¸‹çš„å‡½æ•°ï¼šr^2 = x^2 + y^2, alpha = arctan2(y, x)</span>
</span></span><span style="display:flex;"><span>R2 <span style="color:#f92672">=</span> X<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> Y<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Alpha <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arctan2(Y, X)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç»˜åˆ¶ r^2 ç­‰é«˜çº¿</span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r2_levels <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">1.0</span>, <span style="color:#ae81ff">2.0</span>, <span style="color:#ae81ff">3.0</span>]
</span></span><span style="display:flex;"><span>alpha_levels <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span>np<span style="color:#f92672">.</span>pi, <span style="color:#f92672">-</span>np<span style="color:#f92672">.</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, np<span style="color:#f92672">.</span>pi<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>, np<span style="color:#f92672">.</span>pi]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cont1 <span style="color:#f92672">=</span> ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>contour(X, Y, R2, levels<span style="color:#f92672">=</span>r2_levels, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Blues&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>clabel(cont1, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;rÂ²=</span><span style="color:#e6db74">%.1f</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Contours of $r^2 = x^2 + y^2$&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;y&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;equal&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç»˜åˆ¶ alpha ç­‰é«˜çº¿</span>
</span></span><span style="display:flex;"><span>cont2 <span style="color:#f92672">=</span> ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>contour(X, Y, Alpha, levels<span style="color:#f92672">=</span>alpha_levels, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;coolwarm&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>clabel(cont2, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Î±=</span><span style="color:#e6db74">%.2f</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;Contours of $\alpha = \arctan2(y, x)$&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#34;x&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#34;y&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;equal&#34;</span>)
</span></span><span style="display:flex;"><span>ax[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/1_mcmc_basics_142_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib.animation <span style="color:#f92672">import</span> FuncAnimation
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> HTML
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºç½‘æ ¼</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">20</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">20</span>)
</span></span><span style="display:flex;"><span>X, Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(x, y)
</span></span><span style="display:flex;"><span>points <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>stack([X<span style="color:#f92672">.</span>ravel(), Y<span style="color:#f92672">.</span>ravel()], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># éçº¿æ€§å˜æ¢ï¼ˆæ¨¡æ‹Ÿ Jacobian æ‹‰ä¼¸æ•ˆæœï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">transform</span>(points, alpha):
</span></span><span style="display:flex;"><span>    x, y <span style="color:#f92672">=</span> points[:, <span style="color:#ae81ff">0</span>], points[:, <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(x<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> y<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    theta <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arctan2(y, x)
</span></span><span style="display:flex;"><span>    r_new <span style="color:#f92672">=</span> r <span style="color:#f92672">+</span> alpha <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sin(<span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> theta)  <span style="color:#75715e"># æ·»åŠ æ‰°åŠ¨æ¨¡æ‹Ÿå½¢å˜</span>
</span></span><span style="display:flex;"><span>    x_new <span style="color:#f92672">=</span> r_new <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>cos(theta)
</span></span><span style="display:flex;"><span>    y_new <span style="color:#f92672">=</span> r_new <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sin(theta)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>stack([x_new, y_new], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆå§‹åŒ–ç”»å¸ƒ</span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>scat <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>scatter(points[:, <span style="color:#ae81ff">0</span>], points[:, <span style="color:#ae81ff">1</span>], s<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_xlim(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>)
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34;Jacobian Deformation Demo&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¸§æ›´æ–°å‡½æ•°</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update</span>(frame):
</span></span><span style="display:flex;"><span>    alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sin(frame <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>    new_points <span style="color:#f92672">=</span> transform(points, alpha)
</span></span><span style="display:flex;"><span>    scat<span style="color:#f92672">.</span>set_offsets(new_points)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> scat,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ¨ç”»</span>
</span></span><span style="display:flex;"><span>ani <span style="color:#f92672">=</span> FuncAnimation(fig, update, frames<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, interval<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, blit<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¿å­˜ä¸º GIFï¼ˆå¯é€‰ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib.animation <span style="color:#f92672">import</span> PillowWriter
</span></span><span style="display:flex;"><span>ani<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#34;jacobian_area_deformation.gif&#34;</span>, writer<span style="color:#f92672">=</span>PillowWriter(fps<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>close(fig)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span>Image(filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;jacobian_area_deformation.gif&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#HTML(ani.to_jshtml())</span>
</span></span></code></pre></div><p><img src="/img/contents/post/mcmc-statics/2_random-variables/jacobian_area_deformation.gif" alt="png"></p>
<h3 id="-3-é‡‡æ ·æ–¹æ¡ˆè®¾è®¡">ğŸ¯ 3. é‡‡æ ·æ–¹æ¡ˆè®¾è®¡</h3>
<h4 id="-ä¸€èˆ¬æ­¥éª¤">âœ… ä¸€èˆ¬æ­¥éª¤ï¼š</h4>
<ol>
<li>
<p>ä»å·²çŸ¥è”åˆåˆ†å¸ƒ $f_{X,Y}(x,y)$ ä¸­é‡‡æ ·ä¸€ç»„ $(x,y)$</p>
</li>
<li>
<p>å°†å…¶è½¬æ¢ä¸ºæåæ ‡å½¢å¼ï¼š</p>
$$
   r^2 = x^2 + y^2, \quad \alpha = \arctan2(y, x)
   $$</li>
<li>
<p>å¾—åˆ°æ ·æœ¬ $(r^2, \alpha)$</p>
</li>
</ol>
<h4 id="-åè¿‡æ¥è‹¥ä½ æœ‰-å¦‚ä½•é‡‡æ ·">âœ… åè¿‡æ¥ï¼šè‹¥ä½ æœ‰ $f_{R^2, \alpha}(r^2, \alpha)$ï¼Œå¦‚ä½•é‡‡æ ·ï¼Ÿ</h4>
<ul>
<li>
<p>æ–¹æ³•ä¸€ï¼ˆ<strong>åå‡½æ•°é‡‡æ ·</strong>ï¼‰ï¼šè‹¥ $r^2$ å’Œ $\alpha$ å¯ç‹¬ç«‹åˆ†å¸ƒè¡¨ç¤ºï¼Œç›´æ¥åˆ†åˆ«é‡‡æ ·å†ç»„åˆã€‚</p>
</li>
<li>
<p>æ–¹æ³•äºŒï¼ˆ<strong>æ¥å—-æ‹’ç»é‡‡æ ·</strong>ï¼‰ï¼šè®¾è®¡ proposal distributionï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>$r^2 \sim \text{Gamma}(k, \theta)$</li>
<li>$\alpha \sim \text{Uniform}(0, 2\pi)$</li>
</ul>
<p>ç„¶ååˆ©ç”¨ç›®æ ‡å¯†åº¦ $f_{R^2, \alpha}$ ä¸ proposal åšæ¯”å€¼ï¼Œä½¿ç”¨ rejection rule æ¥å—æˆ–æ‹’ç»ã€‚</p>
</li>
</ul>


        
          <div class="blog-tags">
            
              
              <a href="http://localhost:1313/zh-cn/tags/%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F/">éšæœºå˜é‡</a>&nbsp;
            
              
              <a href="http://localhost:1313/zh-cn/tags/%E9%87%87%E6%A0%B7/">é‡‡æ ·</a>&nbsp;
            
              
              <a href="http://localhost:1313/zh-cn/tags/%E9%9A%8F%E6%9C%BA%E8%AF%95%E9%AA%8C/">éšæœºè¯•éªŒ</a>&nbsp;
            
              
              <a href="http://localhost:1313/zh-cn/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">è¯¾ç¨‹ç¬”è®°</a>&nbsp;
            
              
              <a href="http://localhost:1313/zh-cn/tags/%E6%95%B0%E5%AD%A6/">æ•°å­¦</a>&nbsp;
            
              
              <a href="http://localhost:1313/zh-cn/tags/python/">python</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=http%3a%2f%2flocalhost%3a1313%2fzh-cn%2fpost%2fmcmc-statics%2frandom-variables%2f&amp;text=%e9%9a%8f%e6%9c%ba%e5%8f%98%e9%87%8f%e5%92%8c%e9%87%87%e6%a0%b7&amp;via=" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fzh-cn%2fpost%2fmcmc-statics%2frandom-variables%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fzh-cn%2fpost%2fmcmc-statics%2frandom-variables%2f&amp;title=%e9%9a%8f%e6%9c%ba%e5%8f%98%e9%87%8f%e5%92%8c%e9%87%87%e6%a0%b7" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=http%3a%2f%2flocalhost%3a1313%2fzh-cn%2fpost%2fmcmc-statics%2frandom-variables%2f&amp;title=%e9%9a%8f%e6%9c%ba%e5%8f%98%e9%87%8f%e5%92%8c%e9%87%87%e6%a0%b7" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fzh-cn%2fpost%2fmcmc-statics%2frandom-variables%2f&amp;title=%e9%9a%8f%e6%9c%ba%e5%8f%98%e9%87%8f%e5%92%8c%e9%87%87%e6%a0%b7" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=http%3a%2f%2flocalhost%3a1313%2fzh-cn%2fpost%2fmcmc-statics%2frandom-variables%2f&amp;description=%e9%9a%8f%e6%9c%ba%e5%8f%98%e9%87%8f%e5%92%8c%e9%87%87%e6%a0%b7" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          
            
          

          
                  <h4 class="see-also">ä¹Ÿå¯ä»¥çœ‹çœ‹</h4>
                  <ul>
                
                
                    <li><a href="/zh-cn/post/mcmc-statics/probability/">ä»€ä¹ˆæ˜¯æ¦‚ç‡ï¼Ÿ</a></li>
                
                    <li><a href="/zh-cn/post/python-geodata/01-intro/">ç¬¬ 1 è¯¾ï¼šé¥æ„Ÿæ•°æ®ä¸ Python ç¯å¢ƒå…¥é—¨</a></li>
                
                    <li><a href="/zh-cn/notes/%E6%A6%82%E7%8E%87%E8%AE%BA%E4%B8%8E%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_%E9%9A%8F%E6%9C%BA%E4%BA%8B%E4%BB%B6%E5%8F%8A%E5%85%B6%E6%A6%82%E7%8E%87/">ã€è¯¾ç¨‹ç¬”è®°ã€‘æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ï½œéšæœºäº‹ä»¶åŠå…¶æ¦‚ç‡</a></li>
                
                    <li><a href="/zh-cn/notes/%E6%A6%82%E7%8E%87%E8%AE%BA%E4%B8%8E%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1_%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/">ã€è¯¾ç¨‹ç¬”è®°ã€‘æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ï½œé¢„å¤‡çŸ¥è¯†</a></li>
                
              </ul>

          
        
      </article>

      
        <ul class="pager blog-pager">
          
          
            <li class="next">
              <a href="http://localhost:1313/zh-cn/post/mcmc-statics/probability/" data-toggle="tooltip" data-placement="top" title="ä»€ä¹ˆæ˜¯æ¦‚ç‡ï¼Ÿ">åä¸€ç¯‡ &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
  </div>
</div>

      <footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
		
		  <a href="mailto:ele.qiong@gmail.com" title="Email me">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://github.com/ictar" title="GitHub">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://linkedin.com/in/qiongjie-xu" title="LinkedIn">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://www.xuqiongjie.com">Qiongjie.X</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2025
          

          
            &nbsp;&bull;&nbsp;
            <a href="http://localhost:1313/zh-cn/">ç¼å‘€</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          ç”± <a href="https://gohugo.io">Hugo v0.147.4</a> å¼ºåŠ›é©±åŠ¨ &nbsp;&bull;&nbsp; ä¸»é¢˜ <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> ç§»æ¤è‡ª <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="http://localhost:1313/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="http://localhost:1313/js/load-photoswipe.js"></script>










    
  </body>
</html>

