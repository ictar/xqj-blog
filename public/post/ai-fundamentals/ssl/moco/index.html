

<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>MoCo: Momentum Contrast for Unsupervised Visual Representation Learning - </title>

  <meta name="description" content="It stabilizes and scales contrastive learning by maintaining a dynamic dictionary with momentum-based updates, becoming a cornerstone for modern SSL methods.">
  <meta name="author" content="Qiongjie.X"/>


<link rel="canonical" href="http://localhost:1313/post/ai-fundamentals/ssl/moco/" />


<meta name="keywords" content="SSL, Vision, Representation Learning, Joint Embedding, Contrastive Methods" /><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Qiongjie\u0027s Notes",
    
    "url": "http:\/\/localhost:1313\/"
}
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "http:\/\/localhost:1313\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "http:\/\/localhost:1313\/post\/ai-fundamentals\/ssl\/moco\/",
          "name": "Mo co momentum contrast for unsupervised visual representation learning"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Qiongjie.X"
  },
  "headline": "MoCo: Momentum Contrast for Unsupervised Visual Representation Learning",
  "description" : "It stabilizes and scales contrastive learning by maintaining a dynamic dictionary with momentum-based updates, becoming a cornerstone for modern SSL methods.",
  "inLanguage" : "en",
  "wordCount":  1055 ,
  "datePublished" : "2025-10-07T00:00:00\u002b00:00",
  "dateModified" : "2025-10-07T00:00:00\u002b00:00",
  "image" : "http:\/\/localhost:1313\/img\/avatar-icon.png",
  "keywords" : [ "SSL, Vision, Representation Learning, Joint Embedding, Contrastive Methods" ],
  "mainEntityOfPage" : "http:\/\/localhost:1313\/post\/ai-fundamentals\/ssl\/moco\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "http:\/\/localhost:1313\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "http:\/\/localhost:1313\/img\/avatar-icon.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>



<meta property="og:title" content="MoCo: Momentum Contrast for Unsupervised Visual Representation Learning" />
<meta property="og:description" content="It stabilizes and scales contrastive learning by maintaining a dynamic dictionary with momentum-based updates, becoming a cornerstone for modern SSL methods.">
<meta property="og:image" content="http://localhost:1313/img/avatar-icon.png" />
<meta property="og:url" content="http://localhost:1313/post/ai-fundamentals/ssl/moco/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Qiongjie&#39;s Notes" />

  <meta name="twitter:title" content="MoCo: Momentum Contrast for Unsupervised Visual Representation â€¦" />
  <meta name="twitter:description" content="It stabilizes and scales contrastive learning by maintaining a dynamic dictionary with momentum-based updates, becoming a cornerstone for modern SSL methods.">
  <meta name="twitter:image" content="http://localhost:1313/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <link href='http://localhost:1313/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.147.4">
  <link rel="alternate" href="http://localhost:1313/index.xml" type="application/rss+xml" title="Qiongjie&#39;s Notes"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css" integrity="sha384-h/hnnw1Bi4nbpD6kE7nYfCXzovi622sY5WBxww8ARKwpdLj5kUWjRuyiXaD1U2JT" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="http://localhost:1313/css/main.css" /><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="http://localhost:1313/css/syntax.css" /><link rel="stylesheet" href="http://localhost:1313/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  crossorigin="anonymous"
/>
<link rel="stylesheet" href="http://localhost:1313/css/custom.css"><link rel="stylesheet" href="http://localhost:1313/css/toc.css">

<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  crossorigin="anonymous"
></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
  onload="renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false}
    ]
  });"></script>


<link rel="icon" type="image/png" href="http://localhost:1313/img/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="http://localhost:1313/img/favicon.svg" />
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/img/apple-touch-icon.png" />
<link rel="manifest" href="http://localhost:1313/img/site.webmanifest" />

  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://localhost:1313/">Qiongjie&#39;s Notes</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" role="button" tabindex="0" href="/post">BLOG</a>
              <div class="navlinks-children">
                
                  <a href="/post/python-geodata">Remote Sensing with Python</a>
                
                  <a href="/post/mcmc-statics">Monte Carloâ€“Markov Chains Statistical Methods</a>
                
                  <a href="/post/ai-fundamentals">AI Fundamentals</a>
                
              </div>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" role="button" tabindex="0" href="/projects">PROJECT</a>
              <div class="navlinks-children">
                
                  <a href="https://ictar.github.io/TerraFlow/">TerraFlow</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="NOTE" href="/notes">NOTE</a>
            </li>
          
        
          
            <li>
              <a title="TAG" href="/tags">TAG</a>
            </li>
          
        
          
            <li>
              <a title="ABOUT ME" href="/page/about/">ABOUT ME</a>
            </li>
          
        

        
          
            <li>
              
            </li>
          
        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Qiongjie&#39;s Notes" href="http://localhost:1313/">
            <img class="avatar-img" src="http://localhost:1313/img/avatar-icon.png" alt="Qiongjie&#39;s Notes" />
           
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>MoCo: Momentum Contrast for Unsupervised Visual Representation Learning</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on October 7, 2025
  
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1055&nbsp;words
  
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row" style="display: flex; flex-wrap: wrap;">
    
    
    <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <div class="model-card">
<h2 id="-model-name">ğŸ·ï¸ Model Name</h2>
<p><strong>MoCo â€“ Momentum Contrast for Unsupervised Visual Representation Learning</strong></p>
<h2 id="-core-idea">ğŸ§  Core Idea</h2>
<blockquote>
<p><text style="color:red">MoCo = SimCLR + Momentum Encoder + Queue</text></p>
<p>It stabilizes and scales contrastive learning by maintaining a dynamic dictionary with momentum-based updates, becoming a cornerstone for modern SSL methods.</p></blockquote>
<p><img src="https://user-images.githubusercontent.com/11435359/71603927-0ca98d00-2b14-11ea-9fd8-10d984a2de45.png" alt="MoCo architecture"></p>
<h2 id="-architecture">ğŸ–¼ï¸ Architecture</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>                      â”‚      Original Image x       â”‚
</span></span><span style="display:flex;"><span>                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                                     â”‚
</span></span><span style="display:flex;"><span>                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>                           â”‚                   â”‚
</span></span><span style="display:flex;"><span>                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>                 â”‚  Augmentation 1 â”‚  â”‚  Augmentation 2 â”‚
</span></span><span style="display:flex;"><span>                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                           â”‚                   â”‚
</span></span><span style="display:flex;"><span>                           â–¼                   â–¼
</span></span><span style="display:flex;"><span>                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>                    â”‚ Encoder f_qâ”‚       â”‚ Encoder f_kâ”‚
</span></span><span style="display:flex;"><span>                    â”‚ (query net)â”‚       â”‚ (key net)  â”‚
</span></span><span style="display:flex;"><span>                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                           â”‚                   â”‚
</span></span><span style="display:flex;"><span>                           â–¼                   â–¼
</span></span><span style="display:flex;"><span>                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>                     â”‚   q (NxC)  â”‚       â”‚   k (NxC)  â”‚
</span></span><span style="display:flex;"><span>                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                           â”‚                   â”‚
</span></span><span style="display:flex;"><span>                           â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                           â”‚        â”‚
</span></span><span style="display:flex;"><span>                           â–¼        â–¼
</span></span><span style="display:flex;"><span>              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>              â”‚    Positive &amp; Negative Logits      â”‚
</span></span><span style="display:flex;"><span>              â”‚------------------------------------â”‚
</span></span><span style="display:flex;"><span>              â”‚  l_pos = qÂ·kâº       (positive)     â”‚
</span></span><span style="display:flex;"><span>              â”‚  l_neg = qÂ·Queue(kâ») (negatives)   â”‚
</span></span><span style="display:flex;"><span>              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                           â”‚
</span></span><span style="display:flex;"><span>                           â–¼
</span></span><span style="display:flex;"><span>              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>              â”‚      Contrastive Loss (InfoNCE)    â”‚
</span></span><span style="display:flex;"><span>              â”‚   L = CrossEntropy(logits / Ï„)     â”‚
</span></span><span style="display:flex;"><span>              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                           â”‚
</span></span><span style="display:flex;"><span>                           â–¼
</span></span><span style="display:flex;"><span>              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>              â”‚     Backprop on f_q (SGD update)   â”‚
</span></span><span style="display:flex;"><span>              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                           â”‚
</span></span><span style="display:flex;"><span>                           â–¼
</span></span><span style="display:flex;"><span>              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>              â”‚  Momentum Update of f_k Parameters â”‚
</span></span><span style="display:flex;"><span>              â”‚  f_k = mÂ·f_k + (1âˆ’m)Â·f_q           â”‚
</span></span><span style="display:flex;"><span>              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span style="display:flex;"><span>                           â”‚
</span></span><span style="display:flex;"><span>                           â–¼
</span></span><span style="display:flex;"><span>              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span style="display:flex;"><span>              â”‚    Update Dynamic Queue (Dictionary)â”‚
</span></span><span style="display:flex;"><span>              â”‚  enqueue(k_new), dequeue(k_oldest)  â”‚
</span></span><span style="display:flex;"><span>              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span></code></pre></div><p>And the pseudocode of MoCo in a PyTorch-like style (from the paper):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e"># f_q, f_k: encoder networks for query and key</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># queue: dictionary as a queue of K keys (CxK)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># m: momentum</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># t: temperature</span>
</span></span><span style="display:flex;"><span>f_k<span style="color:#f92672">.</span>params <span style="color:#f92672">=</span> f_q<span style="color:#f92672">.</span>params <span style="color:#75715e"># initialize</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> loader: <span style="color:#75715e"># load a minibatch x with N samples</span>
</span></span><span style="display:flex;"><span>    x_q <span style="color:#f92672">=</span> aug(x) <span style="color:#75715e"># a randomly augmented version</span>
</span></span><span style="display:flex;"><span>    x_k <span style="color:#f92672">=</span> aug(x) <span style="color:#75715e"># another randomly augmented version</span>
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> f_q<span style="color:#f92672">.</span>forward(x_q) <span style="color:#75715e"># queries: NxC</span>
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> f_k<span style="color:#f92672">.</span>forward(x_k) <span style="color:#75715e"># keys: NxC</span>
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> k<span style="color:#f92672">.</span>detach() <span style="color:#75715e"># no gradient to keys</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># positive logits: Nx1</span>
</span></span><span style="display:flex;"><span>    l_pos <span style="color:#f92672">=</span> bmm(q<span style="color:#f92672">.</span>view(N,<span style="color:#ae81ff">1</span>,C), k<span style="color:#f92672">.</span>view(N,C,<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># negative logits: NxK</span>
</span></span><span style="display:flex;"><span>    l_neg <span style="color:#f92672">=</span> mm(q<span style="color:#f92672">.</span>view(N,C), queue<span style="color:#f92672">.</span>view(C,K))
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># logits: Nx(1+K)</span>
</span></span><span style="display:flex;"><span>    logits <span style="color:#f92672">=</span> cat([l_pos, l_neg], dim<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># contrastive loss, Eqn.(1)</span>
</span></span><span style="display:flex;"><span>    labels <span style="color:#f92672">=</span> zeros(N) <span style="color:#75715e"># positives are the 0-th</span>
</span></span><span style="display:flex;"><span>    loss <span style="color:#f92672">=</span> CrossEntropyLoss(logits<span style="color:#f92672">/</span>t, labels)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># SGD update: query network</span>
</span></span><span style="display:flex;"><span>    loss<span style="color:#f92672">.</span>backward()
</span></span><span style="display:flex;"><span>    update(f_q<span style="color:#f92672">.</span>params)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># momentum update: key network</span>
</span></span><span style="display:flex;"><span>    f_k<span style="color:#f92672">.</span>params <span style="color:#f92672">=</span> m<span style="color:#f92672">*</span>f_k<span style="color:#f92672">.</span>params<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>m)<span style="color:#f92672">*</span>f_q<span style="color:#f92672">.</span>params
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># update dictionary</span>
</span></span><span style="display:flex;"><span>    enqueue(queue, k) <span style="color:#75715e"># enqueue the current minibatch</span>
</span></span><span style="display:flex;"><span>    dequeue(queue) <span style="color:#75715e"># dequeue the earliest minibatch</span>
</span></span></code></pre></div><p><strong>Pretext Task</strong>: MoCo utilizes a simple instance discrimination task: a query ($q$) and a key ($k$) form a positive pair if they are encoded views (different crops/augmentations) of the same image. The data augmentation involves random cropping, color distortions, and horizontal flipping.</p>
<h3 id="1-dual-encoder-structure--and-">1ï¸âƒ£ Dual Encoder Structure ($f_q$ and $f_k$)</h3>
<p>MoCo utilizes two main networks to encode the input data:</p>
<ul>
<li><strong>Query Encoder</strong> ($f_q$): Encodes the input query sample ($x_q$) into the query representation $q = f_q(x_q)$.</li>
<li><strong>Momentum Key Encoder</strong> ($f_k$): Encodes the key sample ($x_k$) into the key representation $k = f_k(x_k)$.</li>
</ul>
<p>Both encoders are typically standard convolutional networks, such as <text style="color: purple">ResNet</text>, and their output feature vectors (e.g., 128-D) are $\ell_2$-normalized before calculating the loss.</p>
<h4 id="-shuffling-batch-normalization-bn">ğŸ”¥ Shuffling Batch Normalization (BN)</h4>
<p>To prevent the model from &ldquo;cheating&rdquo; the pretext task by exploiting information leakage between the query and key within a mini-batch (which can occur due to Batch Normalization statistics in distributed training), MoCo implements <text style="color: purple">Shuffling BN</text>.</p>
<ul>
<li>For the key encoder ($f_k$), the sample order of the mini-batch is <strong>shuffled</strong> before being distributed among GPUs for BN calculation, ensuring the batch statistics used for the query and its positive key come from different subsets.</li>
</ul>
<h3 id="2-contrastive-loss-">2ï¸âƒ£ Contrastive Loss ($L_q$)</h3>
<p><strong>Loss Function</strong>: The learning objective is formulated using the <text style="color: purple">InfoNCE loss</text> (a form of contrastive loss): </p>
$$L_q = âˆ’ \log \frac{\exp(q \cdot k^+/\tau)}{\sum_{i=0}^K \exp(q \cdot k_i/\tau)}$$<p> where $k^+$ is the positive key, ${k_i}$ includes $k^+$ and $K$ negative samples from the queue, and $\tau$ is a temperature hyper-parameter.</p>
<h3 id="3-momentum-update-for-consistency">3ï¸âƒ£ Momentum Update for Consistency</h3>
<p>To ensure the large dictionary remains <strong>consistent</strong> despite its contents being encoded by different versions of the key encoder across multiple mini-batches, MoCo employs a momentum update mechanism:</p>
<ul>
<li><strong>Gradient Flow</strong>: Only the query encoder ($f_q$) is updated by standard back-propagation from the contrastive loss.</li>
<li><strong>Smooth Key Update</strong>: The key encoder parameters ($\theta_k$) are updated as a moving average of the query encoder parameters ($\theta_q$) using a momentum coefficient $m \in [0, 1)$: $$\theta_k \leftarrow m\theta_k + (1âˆ’m)\theta_q.$$</li>
<li><strong>Consistency</strong>: A relatively large momentum (e.g., $m=0.999$) is used, which ensures that the key encoder evolves slowly and smoothly. This slow progression is crucial for building a consistent dictionary, improving performance significantly over a key encoder that is copied or updated rapidly.</li>
</ul>
<h3 id="4-the-dynamic-dictionary-queue">4ï¸âƒ£ The Dynamic Dictionary (Queue)</h3>
<p>MoCo maintains the dictionary as a <strong>queue of encoded key representations</strong>.</p>
<ul>
<li><strong>Decoupling Size</strong>: The queue mechanism decouples the dictionary size ($K$) from the mini-batch size ($N$), enabling the dictionary to be much larger than what GPU memory would typically allow for an end-to-end backpropagation setup.</li>
<li><strong>Update Process</strong>: With every training iteration, the encoded representations of the current mini-batch are <em>enqueued</em> into the dictionary, and the oldest mini-batch is <em>dequeued</em> (removed). This progressive replacement ensures the dictionary samples are progressively updated.</li>
<li><strong>Negative Samples</strong>: The key representations {k0, k1, k2, &hellip;} stored in this queue serve as the <text style="color:green">negative samples</text> for the contrastive loss.</li>
</ul>
<h2 id="-downstream-tasks">ğŸ¯ Downstream Tasks</h2>
<ul>
<li>Image Classification (Linear Evaluation Protocol)</li>
<li>Transfer Learning to Detection and Segmentation Tasks
<ul>
<li>Object Detection</li>
<li>Instance Segmentation</li>
<li>Keypoint Detection and Dense Pose Estimation</li>
<li>Semantic Segmentation</li>
</ul>
</li>
<li>Fine-Grained Classification</li>
</ul>
<h2 id="-strengths">ğŸ’¡ Strengths</h2>
<ul>
<li>Memory-efficient, works with smaller batches</li>
<li>Large and Consistent Dictionary: MoCo is designed to build dictionaries that are both large and consistent as they evolve during training.</li>
<li><strong>Architectural Flexibility</strong>: MoCo uses a standard ResNet-50 and requires no specific architecture designs (such as patchified inputs or tailored receptive fields). This non-customized architecture makes it <strong>easier to transfer</strong> the features to a variety of visual tasks.</li>
<li><strong>Scalability to Uncurated Data</strong>: MoCo can work well in large-scale, relatively uncurated scenarios, such as when pre-trained on the billion-image Instagram-1B (IG-1B) dataset.</li>
</ul>
<h2 id="-limitations">âš ï¸ Limitations</h2>
<ul>
<li>Contrastive pairs still need careful design</li>
<li><text style="background-color: yellow">Sensitivity to Momentum Hyperparameter</text>: The smooth evolution of the key encoder is essential. If the momentum coefficient ($m$) is too small (e.g., 0.9) or is set to zero (no momentum), the accuracy drops considerably or the training fails to converge, indicating a sensitivity to this core hyperparameter.</li>
<li><text style="background-color: yellow">Computational Overhead for Dictionary Maintenance</text>: Compared to end-to-end methods which only use the current mini-batch, MoCo requires <strong>extra computation</strong> to maintain the dynamic dictionary (queue).</li>
</ul>
<h2 id="-reference">ğŸ“š Reference</h2>
<ul>
<li><em>He et al., 2019</em>  <em>[Momentum Contrast for Unsupervised Visual Representation Learning]</em>  ğŸ”— <a href="https://arxiv.org/abs/1911.05722">arXiv:1911.05722</a></li>
<li>-<em>Chen et al., 2020</em>  <em>[Improved Baselines with Momentum Contrastive Learning]</em>  ğŸ”— <a href="https://arxiv.org/abs/2003.04297">arXiv:2003.04297</a></li>
<li><a href="https://github.com/facebookresearch/moco">Github: moco</a></li>
</ul>
</div>

        
          <div class="blog-tags">
            
              <a href="http://localhost:1313/tags/ssl/">SSL</a>&nbsp;
            
              <a href="http://localhost:1313/tags/vision/">Vision</a>&nbsp;
            
              <a href="http://localhost:1313/tags/representation-learning/">Representation Learning</a>&nbsp;
            
              <a href="http://localhost:1313/tags/joint-embedding/">Joint Embedding</a>&nbsp;
            
              <a href="http://localhost:1313/tags/contrastive-methods/">Contrastive Methods</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=http%3a%2f%2flocalhost%3a1313%2fpost%2fai-fundamentals%2fssl%2fmoco%2f&amp;text=MoCo%3a%20Momentum%20Contrast%20for%20Unsupervised%20Visual%20Representation%20Learning&amp;via=" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fpost%2fai-fundamentals%2fssl%2fmoco%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fpost%2fai-fundamentals%2fssl%2fmoco%2f&amp;title=MoCo%3a%20Momentum%20Contrast%20for%20Unsupervised%20Visual%20Representation%20Learning" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=http%3a%2f%2flocalhost%3a1313%2fpost%2fai-fundamentals%2fssl%2fmoco%2f&amp;title=MoCo%3a%20Momentum%20Contrast%20for%20Unsupervised%20Visual%20Representation%20Learning" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fpost%2fai-fundamentals%2fssl%2fmoco%2f&amp;title=MoCo%3a%20Momentum%20Contrast%20for%20Unsupervised%20Visual%20Representation%20Learning" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=http%3a%2f%2flocalhost%3a1313%2fpost%2fai-fundamentals%2fssl%2fmoco%2f&amp;description=MoCo%3a%20Momentum%20Contrast%20for%20Unsupervised%20Visual%20Representation%20Learning" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          
            
          

          
                  <h4 class="see-also">See also</h4>
                  <ul>
                
                
                    <li><a href="/post/ai-fundamentals/ssl/i-jepa/">I-JEPA: Image-based Joint Embedding Predictive Architecture</a></li>
                
                    <li><a href="/post/ai-fundamentals/ssl/maskfeat/">MaskFeat: Masked Feature Prediction for Self-Supervised Visual Pre-Training</a></li>
                
                    <li><a href="/post/ai-fundamentals/ssl/dino/">DINO: Self-Distillation with No Labels</a></li>
                
                    <li><a href="/post/ai-fundamentals/ssl/mae/">MAE: Masked Autoencoders Are Scalable Vision Learners</a></li>
                
                    <li><a href="/post/ai-fundamentals/ssl/swav/">SwAV: Swapping Assignments between Views</a></li>
                
              </ul>

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="http://localhost:1313/post/ai-fundamentals/ssl/byol/" data-toggle="tooltip" data-placement="top" title="">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="http://localhost:1313/post/ai-fundamentals/ssl/swav/" data-toggle="tooltip" data-placement="top" title="SwAV: Swapping Assignments between Views">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
    
    
    <div class="col-lg-3 visible-lg-block">
      
      
      <div class="sidebar-toc">
        <h2 class="sidebar-toc-title">ç›®å½•</h2>
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#-model-name">ğŸ·ï¸ Model Name</a></li>
        <li><a href="#-core-idea">ğŸ§  Core Idea</a></li>
        <li><a href="#-architecture">ğŸ–¼ï¸ Architecture</a></li>
        <li><a href="#-downstream-tasks">ğŸ¯ Downstream Tasks</a></li>
        <li><a href="#-strengths">ğŸ’¡ Strengths</a></li>
        <li><a href="#-limitations">âš ï¸ Limitations</a></li>
        <li><a href="#-reference">ğŸ“š Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
      
    </div>
    
  </div>
</div>

      <footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
		
		  <a href="mailto:ele.qiong@gmail.com" title="Email me">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://github.com/ictar" title="GitHub">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://linkedin.com/in/qiongjie-xu" title="LinkedIn">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://www.xuqiongjie.com">Qiongjie.X</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2025
          

          
            &nbsp;&bull;&nbsp;
            <a href="http://localhost:1313/">Qiongjie&#39;s Notes</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.147.4</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="http://localhost:1313/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="http://localhost:1313/js/load-photoswipe.js"></script>









<script src="http://localhost:1313/js/toc-enhancements.js"></script>


    
  </body>
</html>

