---
title: "ç©è½¬ TerraMindï¼šä»ç†è§£åˆ°å¾®è°ƒ"
description: "TerraMind æ˜¯é¦–ä¸ªé’ˆå¯¹åœ°çƒè§‚æµ‹ (EO) é¢†åŸŸæå‡ºçš„å¤§è§„æ¨¡ã€ä»»æ„åˆ°ä»»æ„ï¼ˆany-to-anyï¼‰ç”Ÿæˆå¼å¤šæ¨¡æ€åŸºç¡€æ¨¡å‹ï¼Œå®ƒé€šè¿‡ç»“åˆä»¤ç‰Œçº§åˆ«å’Œåƒç´ çº§åˆ«çš„åŒå°ºåº¦è¡¨ç¤ºè¿›è¡Œé¢„è®­ç»ƒï¼Œä»¥å­¦ä¹ é«˜å±‚ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œç²¾ç»†çš„ç©ºé—´ç»†èŠ‚ã€‚è¯¥æ¨¡å‹æ—¨åœ¨ä¿ƒè¿›å¤šæ¨¡æ€æ•°æ®æ•´åˆã€æä¾›å¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›å¹¶æ”¯æŒé›¶æ ·æœ¬å’Œå°‘æ ·æœ¬åº”ç”¨ï¼ŒåŒæ—¶åœ¨åœ°çƒè§‚æµ‹åŸºå‡†æµ‹è¯•ä¸­è¶…è¶Šç°æœ‰æ¨¡å‹ï¼Œå¹¶é€šè¿‡å¼•å…¥â€œæ¨¡æ€æ€ç»´â€ï¼ˆTiMï¼‰è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚"
summary: "TerraMind æ˜¯é¦–ä¸ªé’ˆå¯¹åœ°çƒè§‚æµ‹ (EO) é¢†åŸŸæå‡ºçš„å¤§è§„æ¨¡ã€ä»»æ„åˆ°ä»»æ„ï¼ˆany-to-anyï¼‰ç”Ÿæˆå¼å¤šæ¨¡æ€åŸºç¡€æ¨¡å‹ï¼Œå®ƒé€šè¿‡ç»“åˆä»¤ç‰Œçº§åˆ«å’Œåƒç´ çº§åˆ«çš„åŒå°ºåº¦è¡¨ç¤ºè¿›è¡Œé¢„è®­ç»ƒï¼Œä»¥å­¦ä¹ é«˜å±‚ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œç²¾ç»†çš„ç©ºé—´ç»†èŠ‚ã€‚è¯¥æ¨¡å‹æ—¨åœ¨ä¿ƒè¿›å¤šæ¨¡æ€æ•°æ®æ•´åˆã€æä¾›å¼ºå¤§çš„ç”Ÿæˆèƒ½åŠ›å¹¶æ”¯æŒé›¶æ ·æœ¬å’Œå°‘æ ·æœ¬åº”ç”¨ï¼ŒåŒæ—¶åœ¨åœ°çƒè§‚æµ‹åŸºå‡†æµ‹è¯•ä¸­è¶…è¶Šç°æœ‰æ¨¡å‹ï¼Œå¹¶é€šè¿‡å¼•å…¥â€œæ¨¡æ€æ€ç»´â€ï¼ˆTiMï¼‰è¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚"
date: 2025-09-10
toc: true
draft: false
tags: ["GeoFM", "terramind", "é¥æ„Ÿ", "AI", "å¤§æ¨¡å‹", "EO"]
---

{{< toc >}}


è¿‡å»å‡ å¹´ï¼Œåœ°çƒè§‚æµ‹ï¼ˆEarth Observation, EOï¼‰æ­£åœ¨è¿›å…¥ä¸€ä¸ªâ€œæ¨¡å‹ä¸ºç‹â€çš„æ—¶ä»£ã€‚å«æ˜Ÿå½±åƒçš„æ•°æ®é‡è¶Šæ¥è¶Šå¤§ï¼Œæ¨¡æ€è¶Šæ¥è¶Šå¤šï¼ˆå…‰å­¦ã€é›·è¾¾ã€æ°”å€™æŒ‡æ•°ã€åœ°ç†æ–‡æœ¬æè¿°â€¦â€¦ï¼‰ï¼Œä½†å¦‚ä½•çœŸæ­£æŠŠè¿™äº›ä¿¡æ¯ç”¨èµ·æ¥ï¼Œå´å§‹ç»ˆæ˜¯ä¸ªæŒ‘æˆ˜ã€‚

è¿™æ—¶ï¼Œ**TerraMind** å‡ºç°äº†ã€‚å®ƒæ˜¯**ç¬¬ä¸€ä¸ªç«¯åˆ°ç«¯ç”Ÿæˆå¼ã€å¤šæ¨¡æ€åœ°çƒè§‚æµ‹åŸºç¡€æ¨¡å‹**ï¼Œç”± IBM Researchã€ETH Zurichã€Forschungszentrum JÃ¼lich å’Œ ESA Î¦-Lab è”åˆå¼€å‘ã€‚å®ƒä¸ä»…èƒ½æ•´åˆä¸åŒæ¨¡æ€çš„æ•°æ®ï¼Œè¿˜å…·å¤‡ç”Ÿæˆèƒ½åŠ›å’Œå‡ºè‰²çš„æ³›åŒ–èƒ½åŠ›ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒè¯•å›¾æ‰®æ¼”â€œå¤§ä¸€ç»Ÿæ¨¡å‹â€çš„è§’è‰²ï¼Œä¸ºå„ç§ä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¦‚åœŸåœ°è¦†ç›–åˆ†ç±»ã€ç¾å®³ç›‘æµ‹ã€æ°”å€™ç ”ç©¶ç­‰ï¼‰æä¾›ä¸€ä¸ªå¼ºå¤§çš„â€œèµ·ç‚¹â€ã€‚


# ä¸ºä»€ä¹ˆè¦æœ‰ TerraMindï¼Ÿ

TerraMind çš„æå‡ºä¸»è¦æ˜¯ä¸ºäº†**è§£å†³ EO é¢†åŸŸä¸­å¤šæ¨¡æ€æ•°æ®é›†æˆã€ç”Ÿæˆä»¥åŠç°æœ‰æ¨¡å‹æ³›åŒ–èƒ½åŠ›ä¸è¶³ç­‰é—®é¢˜**ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œå®ƒé’ˆå¯¹ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹ï¼š

* **å¤šæ¨¡æ€æ•°æ®åˆ©ç”¨ä¸è¶³**
  ä¼ ç»Ÿæ¨¡å‹å¾€å¾€åªé’ˆå¯¹æŸäº›ç‰¹å®šæ¨¡æ€ï¼ˆæ¯”å¦‚åªç”¨å…‰å­¦å½±åƒï¼‰ï¼Œæˆ–åªæœåŠ¡äºæŸä¸ªä»»åŠ¡ï¼ˆæ¯”å¦‚åˆ†å‰²ï¼‰ã€‚TerraMind åˆ™é€šè¿‡æ•´åˆé›·è¾¾ã€å…‰å­¦ã€åœŸåœ°è¦†ç›–å›¾ã€NDVIã€DEMã€åæ ‡å…ƒæ•°æ®ç”šè‡³è‡ªç„¶è¯­è¨€æè¿°ï¼Œæ‰“é€šäº†â€œæ¨¡æ€å£å’â€ã€‚

* **ç¼ºä¹ç”Ÿæˆå¼å¤šæ¨¡æ€èƒ½åŠ›**
  è¿™æ˜¯ TerraMind çš„æ€æ‰‹é”ã€‚å®ƒæ˜¯é¦–ä¸ªâ€œå¤§è§„æ¨¡ã€ä»»æ„åˆ°ä»»æ„ï¼ˆany-to-anyï¼‰â€çš„ç”Ÿæˆå¼å¤šæ¨¡æ€ EO æ¨¡å‹ã€‚å®ƒä¸ä»…èƒ½å®Œæˆä¼ ç»Ÿåˆ†æä»»åŠ¡ï¼Œè¿˜èƒ½ç”Ÿæˆæ–°çš„æ•°æ®ï¼Œæ”¯æŒé›¶æ ·æœ¬ã€å°‘æ ·æœ¬å­¦ä¹ ï¼Œé™ä½æ ‡æ³¨æˆæœ¬ã€‚

* **æ³›åŒ–ä¸æ•°æ®æ•ˆç‡æŒ‘æˆ˜**
  è¿‡å»çš„ EO æ¨¡å‹å¾ˆå®¹æ˜“â€œè¿‡æ‹Ÿåˆâ€åˆ°æŸä¸ªåŒºåŸŸæˆ–æŸä¸ªä»»åŠ¡ï¼Œéš¾ä»¥è¿ç§»ã€‚TerraMind é€šè¿‡åœ¨æµ·é‡æ— æ ‡æ³¨æ•°æ®ä¸Šçš„è‡ªç›‘ç£é¢„è®­ç»ƒï¼ŒåŠ ä¸Šå°è§„æ¨¡çš„æœ‰æ ‡æ³¨å¾®è°ƒï¼Œå®ç°äº†æ›´å¼ºçš„ç©ºé—´ã€æ—¶é—´æ³›åŒ–ã€‚

* **ç°æœ‰åœ°ç†ç©ºé—´åŸºç¡€æ¨¡å‹çš„å±€é™**
  å¾ˆå¤š GFMï¼ˆGeo-Foundation Modelï¼‰å…¶å®æ˜¯æŠŠè®¡ç®—æœºè§†è§‰çš„å¥—è·¯ç¡¬å¥—è¿‡æ¥ï¼Œæ²¡è€ƒè™‘é¥æ„Ÿæ•°æ®çš„ç‰¹æ®Šæ€§ã€‚TerraMind åœ¨æ¶æ„ä¸Šä¸“é—¨åšäº†ä¼˜åŒ–ï¼Œä¾‹å¦‚ **åŒå°ºåº¦é¢„è®­ç»ƒ**ï¼ˆtoken-level + pixel-level è¡¨ç¤ºï¼‰ï¼Œæ—¢èƒ½æŠ“å…¨å±€è¯­ä¹‰ï¼Œåˆä¿ç•™å±€éƒ¨ç©ºé—´ç»†èŠ‚ã€‚

* **åŠ é€Ÿæ°”å€™ä¸å¯æŒç»­æ€§åº”ç”¨**
  å®ƒä¸ä»…æ˜¯ä¸ªæ¨¡å‹ï¼Œè¿˜é…å¥—äº†åˆ†å¸ƒå¼æ•°æ®å¤„ç†å’Œé‡‡æ ·æ¡†æ¶ï¼Œèƒ½ç›´æ¥è¿æ¥å«æ˜Ÿæ•°æ®æºï¼Œè®©å¼€å‘è€…åœ¨æ°”å€™å’Œå¯æŒç»­æ€§åœºæ™¯ä¸­æ›´å¿«è½åœ°åº”ç”¨ã€‚

ç®€è€Œè¨€ä¹‹ï¼ŒTerraMind çš„ç›®æ ‡æ˜¯ï¼š**åšä¸€ä¸ªé€šç”¨ã€å¼ºå¤§ã€èƒ½æ•´åˆå¤šæ¨¡æ€çš„åŸºç¡€æ¨¡å‹ï¼Œä¸º EO ç ”ç©¶å’Œåº”ç”¨æä¾›æ›´é«˜æ•ˆçš„â€œèµ·ç‚¹â€ã€‚**

# TerraMind ä»ä½•è€Œæ¥ï¼Ÿ
![](https://huggingface.co/ibm-esa-geospatial/TerraMind-1.0-base/resolve/main/assets%2Fterramind_architecture.png)

## è¾“å…¥ï¼šTerraMesh æ•°æ®é›†

TerraMind åœ¨å®šåˆ¶çš„å…¨çƒå¤§è§„æ¨¡åœ°ç†ç©ºé—´æ•°æ®é›† **TerraMesh** ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼ŒåŒ…å« **900 ä¸‡ä¸ªæ ·æœ¬å’Œä¹ç§åœ°ç†ç©ºé—´æ¨¡æ€**ï¼š
  * å…‰å­¦å«æ˜Ÿå›¾åƒï¼šCopernicus Sentinel-2 L1C å’Œ L2A (RGB)ã€‚
  * é›·è¾¾å«æ˜Ÿå›¾åƒï¼šCopernicus Sentinel-1 GRD å’Œ RTCã€‚
  * ä»»åŠ¡ç‰¹å®šæ¨¡æ€ï¼šåœŸåœ°åˆ©ç”¨/åœŸåœ°è¦†ç›– (LULC) å’Œå½’ä¸€åŒ–æ¤è¢«æŒ‡æ•° (NDVI) å›¾ã€‚
  * å…ƒæ•°æ®ï¼šæ•°å­—é«˜ç¨‹æ¨¡å‹ (DEM) å’Œåœ°ç†åæ ‡ï¼ˆç¦»æ•£åŒ–ä¸ºå­—ç¬¦ä¸²ï¼‰ã€‚
  * è‡ªç„¶è¯­è¨€ï¼šé€šè¿‡ LLaVA-Next ä» Sentinel-2 RGB å›¾åƒåˆæˆçš„å›¾åƒæè¿° (captions)ã€‚
  
## åŒå°ºåº¦é¢„è®­ç»ƒï¼ˆDual-Scale Pretrainingï¼‰

TerraMind åœ¨åƒç´ çº§åˆ«å’Œ token çº§åˆ«ä¸Šç»“åˆæ•°æ®ï¼Œæ˜¯å…¶æ ¸å¿ƒåˆ›æ–°ã€‚
  * **Token çº§åˆ«**ï¼šç¼–ç é«˜å±‚ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå­¦ä¹ è·¨æ¨¡æ€å…³ç³»ï¼Œå¹¶å®ç°æ‰©å±•æ€§ã€‚
  * **åƒç´ çº§åˆ«**ï¼šåˆ©ç”¨ç»†ç²’åº¦è¡¨ç¤ºï¼Œæ•æ‰å…³é”®çš„ç©ºé—´ç»†å¾®ä¹‹å¤„ã€‚

è¿™ç§åŒå°ºåº¦æ—©æœŸèåˆæ–¹æ³•ä¼˜äºå…¶ä»–èåˆæ–¹æ³•ï¼Œèƒ½å¤Ÿå®ç°äººå·¥æ•°æ®ç”Ÿæˆã€é›¶æ ·æœ¬å’Œå°‘æ ·æœ¬åº”ç”¨ã€‚

## ä¸¤é˜¶æ®µé¢„è®­ç»ƒ
1. **å•æ¨¡æ€åˆ†è¯å™¨ï¼ˆTokenizerï¼‰é¢„è®­ç»ƒ**ï¼šä¸ºæ¯ç§æ¨¡æ€å¼€å‘ç‰¹å®šçš„åˆ†è¯å™¨ï¼Œå°†æ•°æ®ç¼–ç ä¸ºç¦»æ•£ token åºåˆ—ï¼Œæˆ–ä» token åºåˆ—è§£ç å›åŸå§‹å½¢å¼ã€‚å›¾åƒç±»æ¨¡æ€ï¼ˆS-1, S-2, LULC, NDVI, DEMï¼‰ä½¿ç”¨**åŸºäºè‡ªç¼–ç å™¨å’Œæœ‰é™æ ‡é‡é‡åŒ– (FSQ) çš„æ¶æ„**ã€‚åºåˆ—ç±»æ¨¡æ€ï¼ˆæè¿°ã€åœ°ç†ä½ç½®ï¼‰ä½¿ç”¨åŸºäº WordPiece çš„æ–‡æœ¬åˆ†è¯å™¨ã€‚
2. **TerraMind ç¼–ç å™¨-è§£ç å™¨é¢„è®­ç»ƒ**ï¼šä½¿ç”¨å¯¹ç§° Transformer æ¶æ„å¤„ç†å¤šæ¨¡æ€ token åºåˆ—ï¼Œå¹¶æ¥å—åƒç´ çº§åˆ«çš„è·¨æ¨¡æ€è¾“å…¥ã€‚é¢„è®­ç»ƒç›®æ ‡æ˜¯è·¨æ¨¡æ€è¡¥ä¸åˆ†ç±»é—®é¢˜ï¼Œé€šè¿‡äº¤å‰ç†µæŸå¤±æ¥é‡å»ºè¢«é®è”½çš„ç›®æ ‡ tokenã€‚


# TerraMind èƒ½åšä»€ä¹ˆï¼Ÿ

å®ƒçš„å¼ºé¡¹å¯ä»¥å½’ç»“ä¸ºä¸‰ç‚¹ï¼š

1. **æ•´åˆï¼ˆIntegrationï¼‰**ï¼šæŠŠé›·è¾¾ã€å…‰å­¦ã€DEMã€LULC ç­‰å¤šæ¨¡æ€æ”¾åˆ°ä¸€ä¸ªç»Ÿä¸€è¡¨ç¤ºé‡Œã€‚
2. **ç”Ÿæˆï¼ˆGenerationï¼‰**ï¼šä»»æ„æ¨¡æ€ä¹‹é—´çš„ç”Ÿæˆä»»åŠ¡ï¼ˆä¾‹å¦‚ä»é›·è¾¾åˆæˆå…‰å­¦å½±åƒï¼Œæˆ–ä» DEM é¢„æµ‹ NDVIï¼‰ã€‚
   * ä» Sentinel-2 L2A å…‰å­¦æ•°æ®å¼€å§‹ï¼ŒTerraMind èƒ½é«˜è´¨é‡åœ°ç”Ÿæˆé›·è¾¾æ•°æ®ã€åœŸåœ°åˆ©ç”¨å›¾å’Œæ•°å­—é«˜ç¨‹å›¾ã€‚
   * å³ä½¿ä»ä½ä¿¡æ¯é‡çš„åœ°ç†ä½ç½®ä¿¡æ¯å¼€å§‹ï¼Œæ¨¡å‹ä¹Ÿèƒ½ç”Ÿæˆä¸ä¸Šä¸‹æ–‡ç›¸å…³çš„å…‰å­¦å›¾åƒï¼ˆä¾‹å¦‚ï¼Œä»ä¸­ä¸œçš„åœ°ç†ä½ç½®ç”Ÿæˆæ²™æ¼ å›¾åƒï¼‰ï¼Œå°½ç®¡ç»“æ„ä¸Šå¯èƒ½ä¸çœŸå®å€¼ä¸åŒã€‚
3. **æ³›åŒ–ï¼ˆGeneralizationï¼‰**ï¼šä¸‹æ¸¸ä»»åŠ¡åªéœ€å°‘é‡æ ‡æ³¨ï¼Œå°±èƒ½å¿«é€Ÿé€‚é…ï¼Œæ¯”å¦‚åœŸåœ°è¦†ç›–åˆ†ç±»ã€ç¾å®³ç›‘æµ‹ç­‰ã€‚
   * **é›¶æ ·æœ¬å­¦ä¹ **
        * **æ°´ä½“æµ‹ç»˜**ï¼šTerraMindv1-B åœ¨é›¶æ ·æœ¬è®¾ç½®ä¸‹ IoU è¾¾åˆ° 45.4%ï¼Œè‹¥ä½¿ç”¨ DynamicWorld LULC æ•°æ®è¿›è¡Œ ablation å®éªŒï¼Œå¯æå‡è‡³ 69.8%ï¼Œæ¥è¿‘å¾®è°ƒ SOTA æ€§èƒ½ï¼ˆ84.4%ï¼‰ã€‚
        * åœ°ç†å®šä½ï¼šèƒ½å¤Ÿå‡†ç¡®é¢„æµ‹ç‰¹å®šæ•°æ®å®ä¾‹çš„åœ°ç†ä½ç½®ï¼Œä¾‹å¦‚é¢„æµ‹â€œè£¸åœ°â€ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå¹¶è¯†åˆ«å‡ºæ’’å“ˆæ‹‰ã€ä¸­ä¸œç­‰åŒºåŸŸã€‚
   * **å°‘æ ·æœ¬å­¦ä¹ **ï¼šåœ¨ EuroSAT å’Œ METER-ML æ•°æ®é›†ä¸Šçš„ 1-shot 5-way åˆ†ç±»ä»»åŠ¡ä¸­ï¼ŒTerraMind çš„å¹³å‡å‡†ç¡®åº¦è‡³å°‘æ¯”å…¶ä»–åŸºå‡†é«˜å‡º 10ppï¼Œè¡¨æ˜å…¶æ½œåœ¨ç©ºé—´ç»“æ„è‰¯å¥½ã€‚

æ­¤å¤–ï¼ŒTerraMind è¿˜å¼•å…¥äº† **â€œå¤šæ¨¡æ€æ€ç»´â€ (Thinking in Modalities, TiM)** çš„åˆ›æ–°æ¦‚å¿µï¼Œç±»ä¼¼äºå¤§å‹è¯­è¨€æ¨¡å‹ä¸­çš„â€œæ€ç»´é“¾ (chain-of-thought)â€ã€‚é€šè¿‡åœ¨å¾®è°ƒå’Œæ¨ç†è¿‡ç¨‹ä¸­æ³¨å…¥ç”Ÿæˆçš„äººå·¥æ•°æ®ï¼Œæ¨¡å‹è¾“å‡ºæ€§èƒ½å¾—ä»¥æå‡ã€‚ä¾‹å¦‚ï¼Œåœ¨æ°´ä½“æµ‹ç»˜ä»»åŠ¡ä¸­ï¼Œé€šè¿‡ç”Ÿæˆé¢å¤–çš„ LULC æ•°æ®ï¼ŒTiM å¾®è°ƒæ¯”æ ‡å‡†å¾®è°ƒçš„ mIoU æå‡äº† 2ppã€‚

![](https://research.ibm.com/_next/image?url=https%3A%2F%2Fresearch-website-prod-cms-uploads.s3.us.cloud-object-storage.appdomain.cloud%2FScreenshot_2025_10_20_at_3_49_35_PM_9f03a58e80.png&w=1920&q=85)

# ç¼–ç ä¸é‡å»ºï¼ˆTokenizerï¼‰

é¦–å…ˆè¦ç†è§£ TerraMind çš„ **Tokenizer**ã€‚å®ƒçš„å·¥ä½œåŸç†ç±»ä¼¼â€œå‹ç¼©â€”è§£å‹â€ï¼š

* è¾“å…¥å½±åƒ â†’ è½¬æ¢æˆ token è¡¨ç¤º
* token æ•æ‰ç©ºé—´ç»†èŠ‚å’Œä¸Šä¸‹æ–‡ä¿¡æ¯
* å†é€šè¿‡è§£ç å™¨é‡å»ºå½±åƒ â†’ æ£€éªŒæ¨¡å‹æ˜¯å¦â€œç†è§£â€äº†è¾“å…¥

è¿™éƒ¨åˆ†ä¸»è¦æ˜¯ **éªŒè¯æ¨¡å‹çš„ä¿¡æ¯ä¿ç•™èƒ½åŠ›**ã€‚

ä¸‹é¢æ˜¯ä¸€æ®µå®é™…çš„ Python è„šæœ¬ï¼ˆåŸºäº Sentinel-2 L2A æ•°æ®ï¼‰ï¼Œå‚è€ƒ[IBM/terramind/notebooks/terramind_tokenizer_reconstruction.ipynb](https://github.com/IBM/terramind/blob/main/notebooks/terramind_tokenizer_reconstruction.ipynb)ï¼š

```python
# æ„å»º tokenizer æ¨¡å‹
model = FULL_MODEL_REGISTRY.build('terramind_v1_tokenizer_s2l2a', pretrained=True)

# åŠ è½½ç¤ºä¾‹å½±åƒå¹¶æ„é€ æˆå¼ é‡
# Load an example Sentinel-2 image
examples = [
    '../examples/S2L2A/38D_378R_2_3.tif',
    '../examples/S2L2A/282D_485L_3_3.tif',
    '../examples/S2L2A/433D_629L_3_1.tif',
]
data = rxr.open_rasterio(examples[1])
# Convert to [B, C, 224, 224]
data = torch.Tensor(data.values, device='cpu').unsqueeze(0)

# å½’ä¸€åŒ–ï¼ˆæ ‡å‡†åŒ–ï¼‰
mean = torch.Tensor(v1_pretraining_mean['untok_sen2l2a@224'])
std = torch.Tensor(v1_pretraining_std['untok_sen2l2a@224'])
input = (data - mean[None, :, None, None]) / std[None, :, None, None]

# è¿è¡Œæ¨¡å‹ï¼ˆç¼–ç â†’è§£ç ï¼‰
with torch.no_grad():
    reconstruction = model(input, timesteps=10)

# åæ ‡å‡†åŒ–ï¼ˆæ¢å¤åˆ°åŸå§‹æ•°é‡çº§ï¼‰
reconstruction = reconstruction.cpu()
reconstruction = (reconstruction * std[None, :, None, None]) + mean[None, :, None, None]
# è§£ç å‡ºæ¥çš„ reconstruction è¦ä¹˜ä»¥ std åŠ ä¸Š mean æŠŠæ•°å€¼å¸¦å›â€œçœŸå®â€é‡çº²ï¼ˆä¸åŸå§‹æ•°æ®åŒä¸€å–å€¼èŒƒå›´ï¼‰ï¼Œå¦åˆ™çœ‹èµ·æ¥ä¼šåƒâ€œå‡å€¼ä¸º 0 çš„å°æ•°â€ã€‚
```

åœ¨å¯è§†åŒ–æ—¶ï¼Œå¯ä»¥å¯¹æ¯”è¾“å…¥å½±åƒä¸é‡å»ºå½±åƒçš„ RGB è¡¨è¾¾ï¼š

```python
fig, ax = plt.subplots(1, 2, figsize=(10, 5))

# Input RGB
rgb_input = data[0, [3,2,1]].permute(1,2,0).cpu().numpy()
ax[0].imshow((rgb_input/2000).clip(0,1))
ax[0].set_title("Input"); ax[0].axis("off")

# Reconstructed RGB
rgb_recon = reconstruction[0, [3,2,1]].permute(1,2,0).cpu().numpy()
ax[1].imshow((rgb_recon/2000).clip(0,1))
ax[1].set_title("Reconstruction"); ax[1].axis("off")

plt.show()
```

æ•ˆæœï¼šå·¦è¾¹æ˜¯åŸå§‹ Sentinel-2 è¾“å…¥ï¼Œå³è¾¹æ˜¯ Tokenizer è§£ç åçš„é‡å»ºç»“æœã€‚

ğŸ‘‰ è¿™è¯æ˜ **TerraMind èƒ½ç”¨ token è¡¨ç¤ºå½±åƒï¼Œå¹¶ä¸”å¾ˆå¥½åœ°ä¿ç•™ä¿¡æ¯**ã€‚


# è·¨æ¨¡æ€ç”Ÿæˆï¼ˆGenerationï¼‰
ä»¤äººå…´å¥‹çš„æ˜¯ TerraMind çš„ **ç”Ÿæˆèƒ½åŠ›**ã€‚
å®ƒä¸ä»…èƒ½â€œé‡å»ºâ€è¾“å…¥ï¼Œè¿˜èƒ½å®ç° **è·¨æ¨¡æ€ç”Ÿæˆ (Any-to-Any)**ï¼š

* å…‰å­¦å½±åƒ â†’ ç”Ÿæˆé›·è¾¾å½±åƒ
* DEM â†’ ç”Ÿæˆå…‰å­¦æˆ– NDVI
* å½±åƒ â†’ ç”Ÿæˆ LULC åœ°å›¾
* ç”šè‡³è¿˜èƒ½åš å›¾åƒ â†” æ–‡æœ¬

è¿™ç§ **ä»»æ„æ¨¡æ€åˆ°ä»»æ„æ¨¡æ€çš„ç”Ÿæˆèƒ½åŠ›**ï¼Œæ˜¯ TerraMind ç›¸æ¯”ä¼ ç»Ÿæ¨¡å‹çš„æœ€å¤§çªç ´ã€‚
å®ƒæ„å‘³ç€ï¼šå³ä¾¿æŸäº›æ•°æ®ç¼ºå¤±ï¼Œä¹Ÿèƒ½é€šè¿‡ç”Ÿæˆè¡¥é½ï¼›å³ä¾¿æ ‡æ³¨æœ‰é™ï¼Œä¹Ÿèƒ½é€šè¿‡ç”Ÿæˆå¢å¼ºè®­ç»ƒã€‚

## å• patch ç¤ºä¾‹

* è¾“å…¥ï¼šå•ä¸ª patchï¼Œå¯ä»¥æ˜¯S2-L2Açš„æ•°æ® (224Ã—224)
* è¾“å‡ºï¼šå¤šä¸ªç›®æ ‡æ¨¡æ€ï¼Œå¦‚ S1GRDã€DEMã€LULC ç­‰ã€‚
* ç‰¹ç‚¹ï¼š
    * æ¯ä¸ªè¾“å‡ºæ¨¡æ€å¯¹åº”è‡ªå·±çš„ tokenizerï¼ˆå¢åŠ äº†å†…å­˜æ¶ˆè€—ï¼‰ã€‚
    * ä½¿ç”¨ diffusion stepsï¼ˆå¦‚ 10 æ­¥ï¼‰ç”Ÿæˆç»“æœ â†’ ä¿è¯è¾“å‡ºçš„å¤šæ ·æ€§ä¸è´¨é‡ã€‚
    * å¯ä»¥ç›´æ¥å¯¹è¾“å…¥åšæ ‡å‡†åŒ–ï¼ˆstandardize=Trueï¼‰ã€‚
* æ­¥éª¤ï¼š
  1. æ„å»ºæ¨¡å‹
    * ä» `FULL_MODEL_REGISTRY` ä¸­å®ä¾‹åŒ– TerraMind æ¨¡å‹ã€‚
    * æŒ‡å®š **è¾“å…¥æ¨¡æ€**ï¼ˆä¾‹å¦‚ `S2L2A`ï¼‰å’Œ **è¾“å‡ºæ¨¡æ€**ï¼ˆä¾‹å¦‚ `S1GRD, DEM, LULC`ï¼‰ã€‚
    * é€‰æ‹©æ˜¯å¦åŠ è½½é¢„è®­ç»ƒæƒé‡ï¼ˆ`pretrained=True`ï¼‰ã€‚
    * é…ç½®æ ‡å‡†åŒ–ï¼ˆ`standardize=True`ï¼Œä¼šè‡ªåŠ¨åº”ç”¨é¢„è®­ç»ƒæ—¶çš„å‡å€¼/æ–¹å·®ï¼‰ã€‚
  2. å‡†å¤‡æ•°æ®
    * åŠ è½½rasteræ•°æ®
    * ä½¿ç”¨ `rioxarray.open_rasterio` è¯»å–ä¸ºæ•°ç»„ã€‚
    * è½¬æ¢æˆæ¨¡å‹è¦æ±‚çš„è¾“å…¥å½¢çŠ¶ [Batch, Channels, Height, Width]ï¼Œä¾‹å¦‚ [1, C, 224, 224]ã€‚
  3. åŠ è½½è¾“å…¥æ•°æ®ï¼šå°†è¾“å…¥æ•°æ®ç»˜åˆ¶æˆ RGB å›¾åƒï¼ˆå¸®åŠ©ç†è§£è¾“å…¥å†…å®¹ï¼‰ã€‚
  4. æ‰§è¡Œæ‰©æ•£ç”Ÿæˆ
    * æŠŠè¾“å…¥é€å…¥ GPU/CPUï¼ˆ`input.to(device)`ï¼‰ã€‚
    * åœ¨ `torch.no_grad()` ä¸‹è¿è¡Œ æ‰©æ•£ç”Ÿæˆï¼ˆ`model(input, timesteps=10)`ï¼‰
    * `timesteps` æ§åˆ¶æ‰©æ•£è¿‡ç¨‹çš„è¿­ä»£æ¬¡æ•°ï¼ˆæ­¥æ•°è¶Šå¤šï¼Œç”Ÿæˆç»“æœè¶Šç²¾ç»†ä½†è€—æ—¶æ›´é•¿ï¼‰ã€‚
  5. å¾—åˆ°å¤šæ¨¡æ€è¾“å‡º
    * æ¨¡å‹ä¼šè¿”å›ä¸€ä¸ªå­—å…¸ï¼ˆ`{æ¨¡æ€å: ç”Ÿæˆç»“æœ}`ï¼‰
    * æ¯ä¸ªè¾“å‡ºæ¨¡æ€æœ‰å¯¹åº”çš„ **ç”Ÿæˆå¼ é‡**ã€‚
  6. å¯è§†åŒ–ç»“æœã€‚
    * éå†è¾“å‡ºæ¨¡æ€ï¼Œè°ƒç”¨ `plot_modality()` ç»˜åˆ¶æ¯ä¸ªç»“æœã€‚
    * ä¸è¾“å…¥å›¾åƒå¹¶æ’æ˜¾ç¤ºï¼Œæ–¹ä¾¿æ¯”è¾ƒã€‚

ä¸‹é¢pythonç‰‡æ®µå®ç°äº†ç”¨ S-2 è¾“å…¥å»ç”Ÿæˆå…¶ä»–æ¨¡æ€ï¼ˆS-1ã€DEMã€LULCâ€¦â€¦ï¼‰ï¼Œå‚è€ƒ [IBM/terramind/notebooks/terramind_generation.ipynb](https://github.com/IBM/terramind/blob/main/notebooks/terramind_generation.ipynb)ï¼š

```py
# è½½å…¥ç¤ºä¾‹ S-2 L2A å¹¶æ„æˆæ¨¡å‹è¾“å…¥
data = rxr.open_rasterio(examples[example_id])          # rioxarray DataArray
data = torch.Tensor(data.values, device='cpu').unsqueeze(0)  # -> [B, C, H, W]

# æ„å»ºæ¨¡å‹
model = FULL_MODEL_REGISTRY.build(
    'terramind_v1_base_generate',
    modalities=['S2L2A'],
    output_modalities=['S1GRD', 'DEM', 'LULC'],
    pretrained=True,
    standardize=True,
)
# ç§»åˆ°è®¾å¤‡
_ = model.to(device)

# è¿è¡Œç”Ÿæˆï¼ˆdiffusion stepsï¼‰
with torch.no_grad():
  generated = model(input, verbose=True, timesteps=10)
```

æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ è·¨æ¨¡æ€ç¿»è¯‘ï¼š**ç»™ä½ ä¸€ä¸ª Sentinel-2 çš„ patchï¼Œæˆ‘å¯ä»¥â€œæƒ³è±¡â€å‡º SARã€DEMã€NDVI ç­‰å…¶ä»–æ¨¡æ€ã€‚**

## åˆ†å—æ¨ç†ï¼ˆTiled Inferenceï¼‰

**ä¸ºä»€ä¹ˆè¦ç”¨ tiled_inferenceï¼Ÿ**

å¤§ç“¦ç‰‡ï¼ˆfull tileï¼‰é€šå¸¸è¶…å‡º GPU å†…å­˜ï¼Œæ•…æŠŠå¤§å›¾åˆ‡æˆè®¸å¤šå° tileï¼ˆpatchï¼‰åˆ†åˆ«åœ¨ GPU ä¸Šæ¨ç†ï¼Œç„¶ååˆå¹¶å›æ•´å›¾ã€‚tiled_inference æ˜¯ä¸€ä¸ªå·¥å…·å‡½æ•°ï¼ˆTerraTorch/ç”¨æˆ·åº“æä¾›ï¼‰ï¼Œè´Ÿè´£åˆ‡ patchã€æŒ‰ batch è°ƒç”¨æ¨¡å‹ã€å¹¶æŠŠ patch è¾“å‡ºåˆå¹¶æˆæ•´å¹…è¾“å‡ºã€‚

æ€»è€Œè¨€ä¹‹ï¼š
* è¾“å…¥ï¼šæ•´å— tileï¼ˆæ¯”å¦‚ Singapore, Santiagoï¼Œå¯èƒ½æ˜¯ 1000Ã—1000 æˆ–æ›´å¤§ï¼‰ã€‚
* é—®é¢˜ï¼šGPU å†…å­˜ä¸å¤Ÿæ”¾ä¸‹æ•´å¼ å›¾ã€‚
* æ­¥éª¤ï¼š
  1. è½½å…¥å¹¶ï¼ˆå¯é€‰ï¼‰è£å‰ªå¤§ç“¦ç‰‡
  2. è½¬æ¢ä¸º [B,C,H,W] 
  3. æ„å»ºç”Ÿæˆæ¨¡å‹ï¼ˆæŒ‡å®šè¾“å‡ºæ¨¡æ€ã€timestepsï¼‰
  4. ç”¨ tiled_inference åˆ‡ patch å¹¶æ‰¹é‡è°ƒç”¨ model_forward 
  5. åˆå¹¶å›æ•´å›¾å¾—åˆ° [C_total,H,W]
  6. åˆ‡åˆ†å„æ¨¡æ€é€šé“
  7. å¯¹è¿ç»­æ¨¡æ€åæ ‡å‡†åŒ–ã€å¯¹åˆ†ç±»æ¨¡æ€ argmax
  8. ä¿å­˜ GeoTIFF / å¯è§†åŒ– / æŒ‡æ ‡è¯„ä¼°ã€‚

ä¸‹é¢æ˜¯ä¸€æ®µå®é™…çš„ Python è„šæœ¬ï¼Œå‚è€ƒ [IBM/terramind/notebooks/large_tile_generation.ipynb](https://github.com/IBM/terramind/blob/main/notebooks/large_tile_generation.ipynb)

```py
# è¾“å…¥å‡†å¤‡ï¼ˆcrop / batch dimï¼‰
data = rxr.open_rasterio('examples/S2L2A/Santiago.tif').values
data = data[:, 500:1500]           # å¯é€‰è£å‰ªä»¥åŠ é€Ÿ
input = torch.tensor(data, dtype=torch.float, device=device).unsqueeze(0)

# æ„å»ºå¹¶å‡†å¤‡ç”Ÿæˆæ¨¡å‹ï¼šä»¥ S2L2A ä¸ºæ¡ä»¶è¾“å…¥ï¼Œç”Ÿæˆ S1GRD å’Œ LULC
output_modalities = ['S1GRD', 'LULC']
model = FULL_MODEL_REGISTRY.build(
    'terramind_v1_base_generate',
    modalities=['S2L2A'],
    output_modalities=output_modalities,
    pretrained=True,
    standardize=True,
    timesteps=10,
)
model = model.to(device)

# ä» dict â†’ tensor
def model_forward(x):
    generated = model(x)                       # dict: {modality: tensor}
    out = torch.concat([generated[m] for m in output_modalities], dim=1)
    return out

# tiled_inference çš„è¾“å‡ºä¸å»æ‰¹æ¬¡ç»´
pred = tiled_inference(model_forward, input, crop=256, stride=192, batch_size=16, verbose=True)
pred = pred.squeeze(0)   # ä» [1, C, H, W] -> [C, H, W]

# æŠŠæ‹¼æ¥çš„é€šé“åˆ‡å›å„æ¨¡æ€
num_channels = {'S2L2A':12, 'S1GRD':2, 'S1RTC':2, 'DEM':1, 'LULC':10, 'NDVI':1}
num_channels = {m: num_channels[m] for m in output_modalities}
start_idx = np.cumsum([0] + list(num_channels.values()))
generated = {m: pred[i:i+c].cpu() for m, i, c in zip(output_modalities, start_idx, num_channels.values())}

# LULC çš„åå¤„ç†ï¼ˆä»æ¦‚ç‡ -> ç¦»æ•£ç±»åˆ«ï¼‰
if 'LULC' in generated.keys():
    generated['LULC'] = generated['LULC'].argmax(dim=0)

```

æ•…è€Œï¼Œè®© TerraMind ä¸åªæ˜¯å° patch demoï¼Œè€Œæ˜¯èƒ½å¤Ÿè¢«åº”ç”¨åˆ°çœŸå®åœ°çƒå¤§èŒƒå›´åœºæ™¯ã€‚

# å¾®è°ƒä»»åŠ¡ï¼ˆFine-tuning with TerraTorchï¼‰

TerraMind çš„å¦ä¸€å¤§äº®ç‚¹ï¼Œå°±æ˜¯èƒ½å¾ˆæ–¹ä¾¿åœ°åœ¨ä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¦‚è¯­ä¹‰åˆ†å‰²ï¼‰ä¸Šå¾®è°ƒã€‚æˆ‘ä»¬ä»¥[IBM/terramind/notebooks/terramind_v1_base_sen1floods11.ipynb](https://github.com/IBM/terramind/blob/main/notebooks/terramind_v1_base_sen1floods11.ipynb)ä¸ºä¾‹ï¼Œè®²è®²å¾®è°ƒçš„ä¸»è¦æµç¨‹ï¼š

1. **æ•°æ®å‡†å¤‡ï¼ˆDataModuleï¼‰**
   ä½¿ç”¨ `GenericMultiModalDataModule` æ¥å®šä¹‰æ¨¡æ€ã€è·¯å¾„ã€split æ–‡ä»¶ã€æ ‡å‡†åŒ–å‚æ•°ã€‚ä¾‹å¦‚ï¼š

   * æ¨¡æ€ï¼š`["S2L1C", "S1GRD"]`
   * æ ‡ç­¾ï¼š`*_LabelHand.tif`
   * è®­ç»ƒ/éªŒè¯/æµ‹è¯•åˆ’åˆ†ï¼š`flood_train_data.txt` ç­‰

   è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä¸ç®¡ä½ ç”¨çš„æ˜¯å…‰å­¦+é›·è¾¾ï¼Œè¿˜æ˜¯åŠ  DEMã€LULCï¼Œéƒ½èƒ½å¿«é€Ÿé…ç½®ã€‚

2. **åŠ è½½é¢„è®­ç»ƒ Backbone**

   ```python
   model = BACKBONE_REGISTRY.build(
       "terramind_v1_base",
       modalities=["S2L1C", "S1GRD"],
       pretrained=True,
   )
   ```

3. **å®šä¹‰ä¸‹æ¸¸ä»»åŠ¡ï¼ˆSemanticSegmentationTaskï¼‰**

   * Backboneï¼šTerraMind
   * Neckï¼šç‰¹å¾æå–å’Œ reshape
   * Decoderï¼šUNetDecoder
   * Lossï¼šDice æˆ– CE

   åŒæ—¶æ”¯æŒå†»ç»“/è§£å†» backboneï¼Œè°ƒèŠ‚å­¦ä¹ ç‡ï¼ˆ1e-5 \~ 1e-4ï¼‰ã€‚

4. **è®­ç»ƒä¸æµ‹è¯•**
   é€šè¿‡ PyTorch Lightning çš„ `Trainer.fit()` å¯åŠ¨è®­ç»ƒï¼Œä¿å­˜æœ€ä½³ checkpointã€‚
   ç„¶ååœ¨ `Trainer.test()` ä¸Šè¯„ä¼°ï¼Œæœ€åå°±èƒ½è¿›è¡Œé¢„æµ‹å’Œå¯è§†åŒ–ã€‚

æ•´ä¸ªå¾®è°ƒè„šæœ¬è·‘ä¸‹æ¥ï¼Œå°±å¯ä»¥ä»â€œé¢„è®­ç»ƒåŸºç¡€æ¨¡å‹â€å¾—åˆ°ä¸€ä¸ªâ€œé€‚é…ä»»åŠ¡çš„æ¨¡å‹â€ï¼Œå“ªæ€•åªè®­ç»ƒäº†å‡ ä¸ª epochï¼Œå°±èƒ½çœ‹åˆ°æ•ˆæœã€‚

## åœ¨å¾®è°ƒä¸­ä½¿ç”¨TiM

è¦åœ¨å¾®è°ƒä¸­ä½¿ç”¨ TiMï¼Œåªéœ€è¦ä½¿ç”¨ä»¥ `_tim` ç»“å°¾çš„ backboneï¼Œå¹¶ä¸”é€šè¿‡ `backbone_tim_modalities` æŒ‡æ˜è¦ä½¿ç”¨çš„æ¨¡æ€ã€‚ä¾‹å¦‚ï¼š
```yaml
backbone: terramind_v1_base_tim      # è€Œä¸æ˜¯terramind_v1_base
backbone_tim_modalities: [LULC]      # æˆ– S1GRD / NDVI / DEM / â€¦
```

# æ€»ç»“

* **TerraMind æ˜¯ä»€ä¹ˆï¼Ÿ** ä¸€ä¸ªé¢å‘åœ°çƒè§‚æµ‹çš„å¤šæ¨¡æ€åŸºç¡€æ¨¡å‹ã€‚
* **å®ƒèƒ½å¹²ä»€ä¹ˆï¼Ÿ** å¤šæ¨¡æ€æ•´åˆã€ç”Ÿæˆä»»åŠ¡ã€ä¸‹æ¸¸æ³›åŒ–ã€‚
* **æ€ä¹ˆç©ï¼Ÿ**

  * å…ˆä½“éªŒç”Ÿæˆèƒ½åŠ›ï¼šè¾“å…¥å½±åƒ â†’ tokens â†’ é‡å»ºå½±åƒã€‚
  * å†åšä¸‹æ¸¸å¾®è°ƒï¼šé…ç½® DataModuleï¼ŒåŠ è½½é¢„è®­ç»ƒæ¨¡å‹ï¼Œå®šä¹‰ä»»åŠ¡ï¼Œè®­ç»ƒ/æµ‹è¯•ã€‚

å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ¨¡å‹ï¼Œæ›´åƒæ˜¯ä¸€ä¸ª **é¢å‘ EO çš„é€šç”¨ AI å¹³å°**ã€‚æœªæ¥ä¸è®ºæ˜¯æ°”å€™ç ”ç©¶ã€ç¾å®³å“åº”ï¼Œè¿˜æ˜¯åœŸåœ°è¦†ç›–ç›‘æµ‹ï¼Œéƒ½èƒ½å€ŸåŠ©å®ƒå¿«é€Ÿè½åœ°ã€‚


# äº†è§£æ›´å¤š
- [Github: IBM/terramind](https://github.com/IBM/terramind/tree/main)
- [Hugging Face: ibm-esa-geospatial/TerraMind-1.0-base](https://huggingface.co/ibm-esa-geospatial/TerraMind-1.0-base)
- [Paper (arxiv): TerraMind: Large-Scale Generative Multimodality for Earth Observation](https://doi.org/10.48550/arXiv.2504.11171)
- [Introducing Thinking-in-Modalities with TerraMind](https://research.ibm.com/blog/thinking-in-modalities-terramind)